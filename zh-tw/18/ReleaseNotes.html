<!DOCTYPE html>

<html lang="zh-TW" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Clang Release Notes &#8212; Clang  說明文件</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="_static/haiku.css?v=fce32b03" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    <script src="_static/documentation_options.js?v=0d9984b1"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/translations.js?v=cbf116e0"></script>
    <link rel="canonical" href="https://projects.localizethedocs.org/clang-docs-l10n/ReleaseNotes.html" />
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜尋" href="search.html" />
    <link rel="next" title="Clang Compiler User&#39;s Manual" href="UsersManual.html" />
    <link rel="prev" title="Using Clang as a Compiler" href="index.html" />
<script type="text/javascript" src="ltd-provenance.js"></script>
<script type="text/javascript" src="ltd-current.js"></script>
<script type="text/javascript" src="../../ltd-config.js"></script>
<script type="text/javascript" src="../../ltd-flyout.js"></script>

  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>Clang  說明文件</span></a></h1>
        <h2 class="heading"><span>Clang Release Notes</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="Top">
      
        <p>
        «&#160;&#160;<a href="index.html">Using Clang as a Compiler</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">內容</a>
        &#160;&#160;::&#160;&#160;
        <a href="UsersManual.html">Clang Compiler User's Manual</a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <section id="clang-release-releasenotestitle">
<h1>Clang  Release Notes<a class="headerlink" href="#clang-release-releasenotestitle" title="連結到這個標頭">¶</a></h1>
<nav class="contents local" id="id1">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id203">Introduction</a></p></li>
<li><p><a class="reference internal" href="#potentially-breaking-changes" id="id204">Potentially Breaking Changes</a></p>
<ul>
<li><p><a class="reference internal" href="#c-c-language-potentially-breaking-changes" id="id205">C/C++ Language Potentially Breaking Changes</a></p></li>
<li><p><a class="reference internal" href="#c-specific-potentially-breaking-changes" id="id206">C++ Specific Potentially Breaking Changes</a></p></li>
<li><p><a class="reference internal" href="#abi-changes-in-this-version" id="id207">ABI Changes in This Version</a></p></li>
<li><p><a class="reference internal" href="#ast-dumping-potentially-breaking-changes" id="id208">AST Dumping Potentially Breaking Changes</a></p></li>
<li><p><a class="reference internal" href="#clang-frontend-potentially-breaking-changes" id="id209">Clang Frontend Potentially Breaking Changes</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#what-s-new-in-clang-release" id="id210">What's New in Clang ?</a></p>
<ul>
<li><p><a class="reference internal" href="#c-language-changes" id="id211">C++ Language Changes</a></p></li>
<li><p><a class="reference internal" href="#id12" id="id212">C Language Changes</a></p></li>
<li><p><a class="reference internal" href="#non-comprehensive-list-of-changes-in-this-release" id="id213">Non-comprehensive list of changes in this release</a></p></li>
<li><p><a class="reference internal" href="#new-compiler-flags" id="id214">New Compiler Flags</a></p></li>
<li><p><a class="reference internal" href="#deprecated-compiler-flags" id="id215">Deprecated Compiler Flags</a></p></li>
<li><p><a class="reference internal" href="#modified-compiler-flags" id="id216">Modified Compiler Flags</a></p></li>
<li><p><a class="reference internal" href="#removed-compiler-flags" id="id217">Removed Compiler Flags</a></p></li>
<li><p><a class="reference internal" href="#attribute-changes-in-clang" id="id218">Attribute Changes in Clang</a></p></li>
<li><p><a class="reference internal" href="#improvements-to-clang-s-diagnostics" id="id219">Improvements to Clang's diagnostics</a></p></li>
<li><p><a class="reference internal" href="#improvements-to-clang-s-time-trace" id="id220">Improvements to Clang's time-trace</a></p></li>
<li><p><a class="reference internal" href="#bug-fixes-in-this-version" id="id221">Bug Fixes in This Version</a></p></li>
<li><p><a class="reference internal" href="#openacc-specific-changes" id="id222">OpenACC Specific Changes</a></p></li>
<li><p><a class="reference internal" href="#target-specific-changes" id="id223">Target Specific Changes</a></p></li>
<li><p><a class="reference internal" href="#dwarf-support-in-clang" id="id224">DWARF Support in Clang</a></p></li>
<li><p><a class="reference internal" href="#floating-point-support-in-clang" id="id225">Floating Point Support in Clang</a></p></li>
<li><p><a class="reference internal" href="#ast-matchers" id="id226">AST Matchers</a></p></li>
<li><p><a class="reference internal" href="#clang-format" id="id227">clang-format</a></p></li>
<li><p><a class="reference internal" href="#libclang" id="id228">libclang</a></p></li>
<li><p><a class="reference internal" href="#static-analyzer" id="id229">Static Analyzer</a></p></li>
<li><p><a class="reference internal" href="#sanitizers" id="id230">Sanitizers</a></p></li>
<li><p><a class="reference internal" href="#python-binding-changes" id="id231">Python Binding Changes</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#additional-information" id="id232">Additional Information</a></p></li>
</ul>
</nav>
<p>Written by the <a class="reference external" href="https://llvm.org/">LLVM Team</a></p>
<section id="introduction">
<h2><a class="toc-backref" href="#id203" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="連結到這個標頭">¶</a></h2>
<p>This document contains the release notes for the Clang C/C++/Objective-C
frontend, part of the LLVM Compiler Infrastructure, release . Here we
describe the status of Clang in some detail, including major
improvements from the previous release and new feature work. For the
general LLVM release notes, see <a class="reference external" href="https://llvm.org/docs/ReleaseNotes.html">the LLVM
documentation</a>. For the libc++ release notes,
see <a class="reference external" href="https://libcxx.llvm.org/ReleaseNotes.html">this page</a>. All LLVM releases
may be downloaded from the <a class="reference external" href="https://llvm.org/releases/">LLVM releases web site</a>.</p>
<p>For more information about Clang or LLVM, including information about the
latest release, please see the <a class="reference external" href="https://clang.llvm.org">Clang Web Site</a> or the
<a class="reference external" href="https://llvm.org">LLVM Web Site</a>.</p>
</section>
<section id="potentially-breaking-changes">
<h2><a class="toc-backref" href="#id204" role="doc-backlink">Potentially Breaking Changes</a><a class="headerlink" href="#potentially-breaking-changes" title="連結到這個標頭">¶</a></h2>
<p>These changes are ones which we think may surprise users when upgrading to
Clang  because of the opportunity they pose for disruption to existing
code bases.</p>
<ul>
<li><p>Fix a bug in reversed argument for templated operators.
This breaks code in C++20 which was previously accepted in C++17.
Clang did not properly diagnose such casese in C++20 before this change. Eg:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">P</span><span class="w"> </span><span class="p">{};</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="nc">S</span><span class="o">&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">P</span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">S</span><span class="o">&amp;</span><span class="p">);</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="p">{};</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">B</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="p">{};</span>

<span class="c1">// This equality is now ambiguous in C++20.</span>
<span class="kt">bool</span><span class="w"> </span><span class="nf">ambiguous</span><span class="p">(</span><span class="n">A</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="nc">S</span><span class="o">&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="k">operator</span><span class="o">!=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">P</span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">S</span><span class="o">&amp;</span><span class="p">);</span>
<span class="c1">// Ok. Found a matching operator!=.</span>
<span class="kt">bool</span><span class="w"> </span><span class="nf">fine</span><span class="p">(</span><span class="n">A</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>To reduce such widespread breakages, as an extension, Clang accepts this code
with an existing warning <code class="docutils literal notranslate"><span class="pre">-Wambiguous-reversed-operator</span></code> warning.
Fixes <a class="reference external" href="https://github.com/llvm/llvm-project/issues/53954">#53954</a>.</p>
</li>
<li><p>The CMake variable <code class="docutils literal notranslate"><span class="pre">GCC_INSTALL_PREFIX</span></code> (which sets the default
<code class="docutils literal notranslate"><span class="pre">--gcc-toolchain=</span></code>) is deprecated and will be removed. Specify
<code class="docutils literal notranslate"><span class="pre">--gcc-install-dir=</span></code> or <code class="docutils literal notranslate"><span class="pre">--gcc-triple=</span></code> in a <a class="reference external" href="https://clang.llvm.org/docs/UsersManual.html#configuration-files">configuration file</a> as a
replacement.
(<a class="reference external" href="https://github.com/llvm/llvm-project/pull/77537">#77537</a>)</p></li>
</ul>
<section id="c-c-language-potentially-breaking-changes">
<h3><a class="toc-backref" href="#id205" role="doc-backlink">C/C++ Language Potentially Breaking Changes</a><a class="headerlink" href="#c-c-language-potentially-breaking-changes" title="連結到這個標頭">¶</a></h3>
<ul>
<li><p>The default extension name for PCH generation (<code class="docutils literal notranslate"><span class="pre">-c</span> <span class="pre">-xc-header</span></code> and <code class="docutils literal notranslate"><span class="pre">-c</span>
<span class="pre">-xc++-header</span></code>) is now <code class="docutils literal notranslate"><span class="pre">.pch</span></code> instead of <code class="docutils literal notranslate"><span class="pre">.gch</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-include</span> <span class="pre">a.h</span></code> probing <code class="docutils literal notranslate"><span class="pre">a.h.gch</span></code> will now ignore <code class="docutils literal notranslate"><span class="pre">a.h.gch</span></code> if it is not
a clang pch file or a directory containing any clang pch file.</p></li>
<li><p>Fixed a bug that caused <code class="docutils literal notranslate"><span class="pre">__has_cpp_attribute</span></code> and <code class="docutils literal notranslate"><span class="pre">__has_c_attribute</span></code>
return incorrect values for some C++-11-style attributes. Below is a complete
list of behavior changes.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Test</p></th>
<th class="head"><p>Old value</p></th>
<th class="head"><p>New value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__has_cpp_attribute(unused)</span></code></p></td>
<td><p>201603</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">__has_cpp_attribute(gnu::unused)</span></code></p></td>
<td><p>201603</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__has_c_attribute(unused)</span></code></p></td>
<td><p>202106</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">__has_cpp_attribute(clang::fallthrough)</span></code></p></td>
<td><p>201603</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__has_cpp_attribute(gnu::fallthrough)</span></code></p></td>
<td><p>201603</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">__has_c_attribute(gnu::fallthrough)</span></code></p></td>
<td><p>201910</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__has_cpp_attribute(warn_unused_result)</span></code></p></td>
<td><p>201907</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">__has_cpp_attribute(clang::warn_unused_result)</span></code></p></td>
<td><p>201907</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__has_cpp_attribute(gnu::warn_unused_result)</span></code></p></td>
<td><p>201907</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">__has_c_attribute(warn_unused_result)</span></code></p></td>
<td><p>202003</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__has_c_attribute(gnu::warn_unused_result)</span></code></p></td>
<td><p>202003</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
</li>
<li><p>Fixed a bug in finding matching <cite>operator!=</cite> while adding reversed <cite>operator==</cite> as
outlined in &quot;The Equality Operator You Are Looking For&quot; (<a class="reference external" href="http://wg21.link/p2468r2">P2468</a>).
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/68901">#68901</a>).</p></li>
</ul>
</section>
<section id="c-specific-potentially-breaking-changes">
<h3><a class="toc-backref" href="#id206" role="doc-backlink">C++ Specific Potentially Breaking Changes</a><a class="headerlink" href="#c-specific-potentially-breaking-changes" title="連結到這個標頭">¶</a></h3>
<ul>
<li><p>The name mangling rules for function templates has been changed to take into
account the possibility that functions could be overloaded on their template
parameter lists or requires-clauses. This causes mangled names to change for
function templates in the following cases:</p>
<ul class="simple">
<li><p>When a template parameter in a function template depends on a previous
template parameter, such as <code class="docutils literal notranslate"><span class="pre">template&lt;typename</span> <span class="pre">T,</span> <span class="pre">T</span> <span class="pre">V&gt;</span> <span class="pre">void</span> <span class="pre">f()</span></code>.</p></li>
<li><dl class="simple">
<dt>When the function has any constraints, whether from constrained template</dt><dd><p>parameters or requires-clauses.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>When the template parameter list includes a deduced type -- either</dt><dd><p><code class="docutils literal notranslate"><span class="pre">auto</span></code>, <code class="docutils literal notranslate"><span class="pre">decltype(auto)</span></code>, or a deduced class template specialization
type.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>When a template template parameter is given a template template argument</dt><dd><p>that has a different template parameter list.</p>
</dd>
</dl>
</li>
</ul>
<p>This fixes a number of issues where valid programs would be rejected due to
mangling collisions, or would in some cases be silently miscompiled. Clang
will use the old manglings if <code class="docutils literal notranslate"><span class="pre">-fclang-abi-compat=17</span></code> or lower is
specified.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/48216">#48216</a>),
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/49884">#49884</a>), and
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/61273">#61273</a>)</p>
</li>
<li><p>The <cite>ClassScopeFunctionSpecializationDecl</cite> AST node has been removed.
Dependent class scope explicit function template specializations now use
<cite>DependentFunctionTemplateSpecializationInfo</cite> to store candidate primary
templates and explicit template arguments. This should not impact users of
Clang as a compiler, but it may break assumptions in Clang-based tools
iterating over the AST.</p></li>
<li><p>The warning <cite>-Wenum-constexpr-conversion</cite> is now also enabled by default on
system headers and macros. It will be turned into a hard (non-downgradable)
error in the next Clang release.</p></li>
<li><p>The flag <cite>-fdelayed-template-parsing</cite> won't be enabled by default with C++20
when targetting MSVC to match the behavior of MSVC.
(<a class="reference external" href="https://learn.microsoft.com/en-us/cpp/build/reference/permissive-standards-conformance?view=msvc-170">MSVC Docs</a>)</p></li>
<li><p>Remove the hardcoded path to the imported modules for C++20 named modules. Now we
require all the dependent modules to specified from the command line.
See (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/62707">#62707</a>).</p></li>
<li><p>Forbid <cite>import XXX;</cite> in C++ to find module <cite>XXX</cite> comes from explicit clang modules.
See (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64755">#64755</a>).</p></li>
</ul>
</section>
<section id="abi-changes-in-this-version">
<h3><a class="toc-backref" href="#id207" role="doc-backlink">ABI Changes in This Version</a><a class="headerlink" href="#abi-changes-in-this-version" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>Following the SystemV ABI for x86-64, <code class="docutils literal notranslate"><span class="pre">__int128</span></code> arguments will no longer
be split between a register and a stack slot.</p></li>
<li><p>Fixed Microsoft calling convention for returning certain classes with a
templated constructor. If a class has a templated constructor, it should
be returned indirectly even if it meets all the other requirements for
returning a class in a register. This affects some uses of std::pair.
(#GH86384).</p></li>
</ul>
</section>
<section id="ast-dumping-potentially-breaking-changes">
<h3><a class="toc-backref" href="#id208" role="doc-backlink">AST Dumping Potentially Breaking Changes</a><a class="headerlink" href="#ast-dumping-potentially-breaking-changes" title="連結到這個標頭">¶</a></h3>
<ul>
<li><p>When dumping a sugared type, Clang will no longer print the desugared type if
its textual representation is the same as the sugared one. This applies to
both text dumps of the form <code class="docutils literal notranslate"><span class="pre">'foo':'foo'</span></code> which will now be dumped as just
<code class="docutils literal notranslate"><span class="pre">'foo'</span></code>, and JSON dumps of the form:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;qualType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;foo&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;desugaredQualType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;foo&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>which will now be dumped as just:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;qualType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;foo&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="clang-frontend-potentially-breaking-changes">
<h3><a class="toc-backref" href="#id209" role="doc-backlink">Clang Frontend Potentially Breaking Changes</a><a class="headerlink" href="#clang-frontend-potentially-breaking-changes" title="連結到這個標頭">¶</a></h3>
<ul>
<li><p>Target OS macros extension
A new Clang extension (see <a class="reference internal" href="#target-os-detail"><span class="std std-ref">here</span></a>) is enabled for
Darwin (Apple platform) targets. Clang now defines <code class="docutils literal notranslate"><span class="pre">TARGET_OS_*</span></code> macros for
these targets, which could break existing code bases with improper checks for
the <code class="docutils literal notranslate"><span class="pre">TARGET_OS_</span></code> macros. For example, existing checks might fail to include
the <code class="docutils literal notranslate"><span class="pre">TargetConditionals.h</span></code> header from Apple SDKs and therefore leaving the
macros undefined and guarded code unexercised.</p>
<p>Affected code should be checked to see if it's still intended for the specific
target and fixed accordingly.</p>
<p>The extension can be turned off by the option <code class="docutils literal notranslate"><span class="pre">-fno-define-target-os-macros</span></code>
as a workaround.</p>
</li>
</ul>
</section>
</section>
<section id="what-s-new-in-clang-release">
<h2><a class="toc-backref" href="#id210" role="doc-backlink">What's New in Clang ?</a><a class="headerlink" href="#what-s-new-in-clang-release" title="連結到這個標頭">¶</a></h2>
<p>Some of the major new features and improvements to Clang are listed
here. Generic improvements to Clang as a whole or to its underlying
infrastructure are described first, followed by language-specific
sections with improvements to Clang's support for those languages.</p>
<section id="c-language-changes">
<h3><a class="toc-backref" href="#id211" role="doc-backlink">C++ Language Changes</a><a class="headerlink" href="#c-language-changes" title="連結到這個標頭">¶</a></h3>
<section id="c-20-feature-support">
<h4>C++20 Feature Support<a class="headerlink" href="#c-20-feature-support" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Implemented <a class="reference external" href="https://wg21.link/P1907R1">P1907R1</a> which extends allowed non-type template argument
kinds with e.g. floating point values and pointers and references to subobjects.
This feature is still experimental. Accordingly, <code class="docutils literal notranslate"><span class="pre">__cpp_nontype_template_args</span></code> was not updated.
However, its support can be tested with <code class="docutils literal notranslate"><span class="pre">__has_extension(cxx_generalized_nttp)</span></code>.</p></li>
<li><p>Clang won't perform ODR checks for decls in the global module fragment any
more to ease the implementation and improve the user's using experience.
This follows the MSVC's behavior. Users interested in testing the more strict
behavior can use the flag '-Xclang -fno-skip-odr-check-in-gmf'.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/79240">#79240</a>).</p></li>
</ul>
</section>
<section id="c-23-feature-support">
<h4>C++23 Feature Support<a class="headerlink" href="#c-23-feature-support" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Implemented <a class="reference external" href="https://wg21.link/P0847R7">P0847R7: Deducing this</a>. Some related core issues were also
implemented (<a class="reference external" href="https://wg21.link/CWG2553">CWG2553</a>, <a class="reference external" href="https://wg21.link/CWG2554">CWG2554</a>,
<a class="reference external" href="https://wg21.link/CWG2653">CWG2653</a>, <a class="reference external" href="https://wg21.link/CWG2687">CWG2687</a>). Because the
support for this feature is still experimental, the feature test macro <code class="docutils literal notranslate"><span class="pre">__cpp_explicit_this_parameter</span></code>
was not set in this version.
However, its support can be tested with <code class="docutils literal notranslate"><span class="pre">__has_extension(cxx_explicit_this_parameter)</span></code>.</p></li>
<li><p>Added a separate warning to warn the use of attributes on lambdas as a C++23 extension
in previous language versions: <code class="docutils literal notranslate"><span class="pre">-Wc++23-lambda-attributes</span></code>.</p></li>
</ul>
</section>
<section id="c-2c-feature-support">
<h4>C++2c Feature Support<a class="headerlink" href="#c-2c-feature-support" title="連結到這個標頭">¶</a></h4>
<ul>
<li><p>Implemented <a class="reference external" href="https://wg21.link/P2169R4">P2169R4: A nice placeholder with no name</a>. This allows using <code class="docutils literal notranslate"><span class="pre">_</span></code>
as a variable name multiple times in the same scope and is supported in all C++ language modes as an extension.
An extension warning is produced when multiple variables are introduced by <code class="docutils literal notranslate"><span class="pre">_</span></code> in the same scope.
Unused warnings are no longer produced for variables named <code class="docutils literal notranslate"><span class="pre">_</span></code>.
Currently, inspecting placeholders variables in a debugger when more than one are declared in the same scope
is not supported.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">S</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="p">;</span><span class="w"> </span><span class="c1">// Was invalid, now OK</span>
<span class="p">};</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="p">;</span><span class="w"> </span><span class="c1">// Was invalid, now OK</span>
<span class="p">}</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">other</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">_</span><span class="p">;</span><span class="w"> </span><span class="c1">// Previously diagnosed under -Wunused, no longer diagnosed</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>Attributes now expect unevaluated strings in attributes parameters that are string literals.
This is applied to both C++ standard attributes, and other attributes supported by Clang.
This completes the implementation of <a class="reference external" href="https://wg21.link/P2361R6">P2361R6 Unevaluated Strings</a></p></li>
<li><p>Implemented <a class="reference external" href="https://wg21.link/P2864R2">P2864R2 Remove Deprecated Arithmetic Conversion on Enumerations From C++26</a>.</p></li>
<li><p>Implemented <a class="reference external" href="https://wg21.link/P2308R1">P2361R6 Template parameter initialization</a>.
This change is applied as a DR in all language modes.</p></li>
</ul>
</section>
<section id="resolutions-to-c-defect-reports">
<h4>Resolutions to C++ Defect Reports<a class="headerlink" href="#resolutions-to-c-defect-reports" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Implemented <a class="reference external" href="https://wg21.link/CWG2598">CWG2598</a> and <a class="reference external" href="https://wg21.link/CWG2096">CWG2096</a>,
making unions (that have either no members or at least one literal member) literal types.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/77924">#77924</a>).</p></li>
</ul>
</section>
</section>
<section id="id12">
<h3><a class="toc-backref" href="#id212" role="doc-backlink">C Language Changes</a><a class="headerlink" href="#id12" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">structs</span></code>, <code class="docutils literal notranslate"><span class="pre">unions</span></code>, and <code class="docutils literal notranslate"><span class="pre">arrays</span></code> that are const may now be used as
constant expressions.  This change is more consistent with the behavior of
GCC.</p></li>
<li><p>Enums will now be represented in TBAA metadata using their actual underlying
integer type. Previously they were treated as chars, which meant they could
alias with all other types.</p></li>
<li><p>Clang now supports the C-only attribute <code class="docutils literal notranslate"><span class="pre">counted_by</span></code>. When applied to a
struct's flexible array member, it points to the struct field that holds the
number of elements in the flexible array member. This information can improve
the results of the array bound sanitizer and the
<code class="docutils literal notranslate"><span class="pre">__builtin_dynamic_object_size</span></code> builtin.</p></li>
</ul>
<section id="c23-feature-support">
<h4>C23 Feature Support<a class="headerlink" href="#c23-feature-support" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Clang now accepts <code class="docutils literal notranslate"><span class="pre">-std=c23</span></code> and <code class="docutils literal notranslate"><span class="pre">-std=gnu23</span></code> as language standard modes,
and the <code class="docutils literal notranslate"><span class="pre">__STDC_VERSION__</span></code> macro now expands to <code class="docutils literal notranslate"><span class="pre">202311L</span></code> instead of its
previous placeholder value. Clang continues to accept <code class="docutils literal notranslate"><span class="pre">-std=c2x</span></code> and
<code class="docutils literal notranslate"><span class="pre">-std=gnu2x</span></code> as aliases for C23 and GNU C23, respectively.</p></li>
<li><p>Clang now supports <cite>requires c23</cite> for module maps.</p></li>
<li><p>Clang now supports <code class="docutils literal notranslate"><span class="pre">N3007</span> <span class="pre">Type</span> <span class="pre">inference</span> <span class="pre">for</span> <span class="pre">object</span> <span class="pre">definitions</span></code>.</p></li>
<li><p>Clang now supports <code class="docutils literal notranslate"><span class="pre">&lt;stdckdint.h&gt;</span></code> which defines several macros for performing
checked integer arithmetic. It is also exposed in pre-C23 modes.</p></li>
<li><p>Completed the implementation of
<a class="reference external" href="https://www.open-std.org/jtc1/sc22/wg14/www/docs/n2508.pdf">N2508</a>. We
previously implemented allowing a label at the end of a compound statement,
and now we've implemented allowing a label to be followed by a declaration
instead of a statement.</p></li>
<li><p>Implemented
<a class="reference external" href="https://www.open-std.org/jtc1/sc22/wg14/www/docs/n2940.pdf">N2940</a> which
removes support for trigraphs in C23 and later. In earlier language modes,
trigraphs remain enabled by default in conforming modes (e.g. <code class="docutils literal notranslate"><span class="pre">-std=c17</span></code>)
and disabled by default in GNU and Microsoft modes (e.g., <code class="docutils literal notranslate"><span class="pre">-std=gnu17</span></code> or
<code class="docutils literal notranslate"><span class="pre">-fms-compatibility</span></code>). If needed, you can enable trigraphs by passing
<code class="docutils literal notranslate"><span class="pre">-ftrigraphs</span></code>.</p></li>
</ul>
</section>
</section>
<section id="non-comprehensive-list-of-changes-in-this-release">
<h3><a class="toc-backref" href="#id213" role="doc-backlink">Non-comprehensive list of changes in this release</a><a class="headerlink" href="#non-comprehensive-list-of-changes-in-this-release" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>Clang now has a <code class="docutils literal notranslate"><span class="pre">__builtin_vectorelements()</span></code> function that determines the number of elements in a vector.
For fixed-sized vectors, e.g., defined via <code class="docutils literal notranslate"><span class="pre">__attribute__((vector_size(N)))</span></code> or ARM NEON's vector types
(e.g., <code class="docutils literal notranslate"><span class="pre">uint16x8_t</span></code>), this returns the constant number of elements at compile-time.
For scalable vectors, e.g., SVE or RISC-V V, the number of elements is not known at compile-time and is
determined at runtime.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">__datasizeof</span></code> keyword has been added. It is similar to <code class="docutils literal notranslate"><span class="pre">sizeof</span></code>
except that it returns the size of a type ignoring tail padding.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__builtin_classify_type()</span></code> now classifies <code class="docutils literal notranslate"><span class="pre">_BitInt</span></code> values as the return value <code class="docutils literal notranslate"><span class="pre">18</span></code>
and vector types as return value <code class="docutils literal notranslate"><span class="pre">19</span></code>, to match GCC 14's behavior.</p></li>
<li><p>The default value of <cite>_MSC_VER</cite> was raised from 1920 to 1933.</p></li>
<li><p>Since MSVC 19.33 added undocumented attribute <code class="docutils literal notranslate"><span class="pre">[[msvc::constexpr]]</span></code>, this release adds the attribute as well.</p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">fp</span> <span class="pre">reciprocal</span></code>.</p></li>
<li><p>The version of Unicode used by Clang (primarily to parse identifiers) has been updated to 15.1.</p></li>
<li><p>Clang now defines macro <code class="docutils literal notranslate"><span class="pre">__LLVM_INSTR_PROFILE_GENERATE</span></code> when compiling with
PGO instrumentation profile generation, and <code class="docutils literal notranslate"><span class="pre">__LLVM_INSTR_PROFILE_USE</span></code> when
compiling with PGO profile use.</p></li>
</ul>
</section>
<section id="new-compiler-flags">
<h3><a class="toc-backref" href="#id214" role="doc-backlink">New Compiler Flags</a><a class="headerlink" href="#new-compiler-flags" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-fverify-intermediate-code</span></code> and its complement <code class="docutils literal notranslate"><span class="pre">-fno-verify-intermediate-code</span></code>.
Enables or disables verification of the generated LLVM IR.
Users can pass this to turn on extra verification to catch certain types of
compiler bugs at the cost of extra compile time.
Since enabling the verifier adds a non-trivial cost of a few percent impact on
build times, it's disabled by default, unless your LLVM distribution itself is
compiled with runtime checks enabled.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-fkeep-system-includes</span></code> modifies the behavior of the <code class="docutils literal notranslate"><span class="pre">-E</span></code> option,
preserving <code class="docutils literal notranslate"><span class="pre">#include</span></code> directives for &quot;system&quot; headers instead of copying
the preprocessed text to the output. This can greatly reduce the size of the
preprocessed output, which can be helpful when trying to reduce a test case.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-fassume-nothrow-exception-dtor</span></code> is added to assume that the destructor of
a thrown exception object will not throw. The generated code for catch
handlers will be smaller. A throw expression of a type with a
potentially-throwing destructor will lead to an error.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-fopenacc</span></code> was added as a part of the effort to support OpenACC in Clang.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-fcx-limited-range</span></code> enables the naive mathematical formulas for complex
division and multiplication with no NaN checking of results. The default is
<code class="docutils literal notranslate"><span class="pre">-fno-cx-limited-range</span></code>, but this option is enabled by <code class="docutils literal notranslate"><span class="pre">-ffast-math</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-fcx-fortran-rules</span></code> enables the naive mathematical formulas for complex
multiplication and enables application of Smith's algorithm for complex
division. See SMITH, R. L. Algorithm 116: Complex division. Commun. ACM 5, 8
(1962). The default is <code class="docutils literal notranslate"><span class="pre">-fno-cx-fortran-rules</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-fvisibility-global-new-delete=&lt;value&gt;</span></code> gives more freedom to users to
control how and if Clang forces a visibility for the replaceable new and
delete declarations. The option takes 4 values: <code class="docutils literal notranslate"><span class="pre">force-hidden</span></code>,
<code class="docutils literal notranslate"><span class="pre">force-protected</span></code>, <code class="docutils literal notranslate"><span class="pre">force-default</span></code> and <code class="docutils literal notranslate"><span class="pre">source</span></code>; <code class="docutils literal notranslate"><span class="pre">force-default</span></code> is
the default. Option values with prefix <code class="docutils literal notranslate"><span class="pre">force-</span></code> assign such declarations
an implicit visibility attribute with the corresponding visibility. An option
value of <code class="docutils literal notranslate"><span class="pre">source</span></code> implies that no implicit attribute is added. Without the
attribute the replaceable global new and delete operators behave normally
(like other functions) with respect to visibility attributes, pragmas and
options (e.g <code class="docutils literal notranslate"><span class="pre">--fvisibility=</span></code>).</p></li>
<li><p>Full register names can be used when printing assembly via <code class="docutils literal notranslate"><span class="pre">-mregnames</span></code>.
This option now matches the one used by GCC.</p></li>
</ul>
<ul id="target-os-detail">
<li><p><code class="docutils literal notranslate"><span class="pre">-fdefine-target-os-macros</span></code> and its complement
<code class="docutils literal notranslate"><span class="pre">-fno-define-target-os-macros</span></code>. Enables or disables the Clang extension to
provide built-in definitions of a list of <code class="docutils literal notranslate"><span class="pre">TARGET_OS_*</span></code> macros based on the
target triple.</p>
<p>The extension is enabled by default for Darwin (Apple platform) targets.</p>
</li>
</ul>
</section>
<section id="deprecated-compiler-flags">
<h3><a class="toc-backref" href="#id215" role="doc-backlink">Deprecated Compiler Flags</a><a class="headerlink" href="#deprecated-compiler-flags" title="連結到這個標頭">¶</a></h3>
</section>
<section id="modified-compiler-flags">
<h3><a class="toc-backref" href="#id216" role="doc-backlink">Modified Compiler Flags</a><a class="headerlink" href="#modified-compiler-flags" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-Woverriding-t-option</span></code> is renamed to <code class="docutils literal notranslate"><span class="pre">-Woverriding-option</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-Winterrupt-service-routine</span></code> is renamed to <code class="docutils literal notranslate"><span class="pre">-Wexcessive-regsave</span></code> as a generalization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-frewrite-includes</span></code> now guards the original #include directives with
<code class="docutils literal notranslate"><span class="pre">__CLANG_REWRITTEN_INCLUDES</span></code>, and <code class="docutils literal notranslate"><span class="pre">__CLANG_REWRITTEN_SYSTEM_INCLUDES</span></code> as
appropriate.</p></li>
<li><p>Introducing a new default calling convention for <code class="docutils literal notranslate"><span class="pre">-fdefault-calling-conv</span></code>:
<code class="docutils literal notranslate"><span class="pre">rtdcall</span></code>. This new default CC only works for M68k and will use the new
<code class="docutils literal notranslate"><span class="pre">m68k_rtdcc</span></code> CC on every functions that are not variadic. The <code class="docutils literal notranslate"><span class="pre">-mrtd</span></code>
driver/frontend flag has the same effect when targeting M68k.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-fvisibility-global-new-delete-hidden</span></code> is now a deprecated spelling of
<code class="docutils literal notranslate"><span class="pre">-fvisibility-global-new-delete=force-hidden</span></code> (<code class="docutils literal notranslate"><span class="pre">-fvisibility-global-new-delete=</span></code>
is new in this release).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-fprofile-update</span></code> is enabled for <code class="docutils literal notranslate"><span class="pre">-fprofile-generate</span></code>.</p></li>
</ul>
</section>
<section id="removed-compiler-flags">
<h3><a class="toc-backref" href="#id217" role="doc-backlink">Removed Compiler Flags</a><a class="headerlink" href="#removed-compiler-flags" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-enable-trivial-auto-var-init-zero-knowing-it-will-be-removed-from-clang</span></code> has been removed.
It has not been needed to enable <code class="docutils literal notranslate"><span class="pre">-ftrivial-auto-var-init=zero</span></code> since Clang 16.</p></li>
</ul>
</section>
<section id="attribute-changes-in-clang">
<h3><a class="toc-backref" href="#id218" role="doc-backlink">Attribute Changes in Clang</a><a class="headerlink" href="#attribute-changes-in-clang" title="連結到這個標頭">¶</a></h3>
<ul>
<li><p>On X86, a warning is now emitted if a function with <code class="docutils literal notranslate"><span class="pre">__attribute__((no_caller_saved_registers))</span></code>
calls a function without <code class="docutils literal notranslate"><span class="pre">__attribute__((no_caller_saved_registers))</span></code>, and is not compiled with
<code class="docutils literal notranslate"><span class="pre">-mgeneral-regs-only</span></code></p></li>
<li><p>On X86, a function with <code class="docutils literal notranslate"><span class="pre">__attribute__((interrupt))</span></code> can now call a function without
<code class="docutils literal notranslate"><span class="pre">__attribute__((no_caller_saved_registers))</span></code> provided that it is compiled with <code class="docutils literal notranslate"><span class="pre">-mgeneral-regs-only</span></code></p></li>
<li><p>When a non-variadic function is decorated with the <code class="docutils literal notranslate"><span class="pre">format</span></code> attribute,
Clang now checks that the format string would match the function's parameters'
types after default argument promotion. As a result, it's no longer an
automatic diagnostic to use parameters of types that the format style
supports but that are never the result of default argument promotion, such as
<code class="docutils literal notranslate"><span class="pre">float</span></code>. (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/59824">#59824</a>)</p></li>
<li><p>Clang now supports <code class="docutils literal notranslate"><span class="pre">[[clang::preferred_type(type-name)]]</span></code> as an attribute
which can be applied to a bit-field. This attribute helps to map a bit-field
back to a particular type that may be better-suited to representing the bit-
field but cannot be used for other reasons and will impact the debug
information generated for the bit-field. This is most useful when mapping a
bit-field of basic integer type back to a <code class="docutils literal notranslate"><span class="pre">bool</span></code> or an enumeration type,
e.g.,</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="nc">E</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Apple</span><span class="p">,</span><span class="w"> </span><span class="n">Orange</span><span class="p">,</span><span class="w"> </span><span class="n">Pear</span><span class="w"> </span><span class="p">};</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">S</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[[</span><span class="n">clang</span><span class="o">::</span><span class="n">preferred_type</span><span class="p">(</span><span class="n">E</span><span class="p">)]]</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">FruitKind</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>When viewing <code class="docutils literal notranslate"><span class="pre">S::FruitKind</span></code> in a debugger, it will behave as if the member
was declared as type <code class="docutils literal notranslate"><span class="pre">E</span></code> rather than <code class="docutils literal notranslate"><span class="pre">unsigned</span></code>.</p>
</li>
<li><p>Clang now warns you that the <code class="docutils literal notranslate"><span class="pre">_Alignas</span></code> attribute on declaration specifiers
is ignored, changed from the former incorrect suggestion to move it past
declaration specifiers. (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/58637">#58637</a>)</p></li>
<li><p>Clang now introduced <code class="docutils literal notranslate"><span class="pre">[[clang::coro_only_destroy_when_complete]]</span></code> attribute
to reduce the size of the destroy functions for coroutines which are known to
be destroyed after having reached the final suspend point.</p></li>
<li><p>Clang now introduced <code class="docutils literal notranslate"><span class="pre">[[clang::coro_return_type]]</span></code> and <code class="docutils literal notranslate"><span class="pre">[[clang::coro_wrapper]]</span></code>
attributes. A function returning a type marked with <code class="docutils literal notranslate"><span class="pre">[[clang::coro_return_type]]</span></code>
should be a coroutine. A non-coroutine function marked with <code class="docutils literal notranslate"><span class="pre">[[clang::coro_wrapper]]</span></code>
is still allowed to return the such a type. This is helpful for analyzers to recognize coroutines from the function signatures.</p></li>
<li><p>Clang now supports <code class="docutils literal notranslate"><span class="pre">[[clang::code_align(N)]]</span></code> as an attribute which can be
applied to a loop and specifies the byte alignment for a loop. This attribute
accepts a positive integer constant initialization expression indicating the
number of bytes for the minimum alignment boundary. Its value must be a power
of 2, between 1 and 4096(inclusive).</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">Array</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[[</span><span class="n">clang</span><span class="o">::</span><span class="n">code_align</span><span class="p">(</span><span class="mi">64</span><span class="p">)]]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">template</span><span class="o">&lt;</span><span class="kt">int</span><span class="w"> </span><span class="n">A</span><span class="o">&gt;</span>
<span class="kt">void</span><span class="w"> </span><span class="n">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[[</span><span class="n">clang</span><span class="o">::</span><span class="n">code_align</span><span class="p">(</span><span class="n">A</span><span class="p">)]]</span><span class="w"> </span><span class="k">for</span><span class="p">(;;)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>Clang now introduced <code class="docutils literal notranslate"><span class="pre">[[clang::coro_lifetimebound]]</span></code> attribute.
All parameters of a function are considered to be lifetime bound if the function
returns a type annotated with <code class="docutils literal notranslate"><span class="pre">[[clang::coro_lifetimebound]]</span></code> and <code class="docutils literal notranslate"><span class="pre">[[clang::coro_return_type]]</span></code>.
This analysis can be disabled for a function by annotating the function with <code class="docutils literal notranslate"><span class="pre">[[clang::coro_disable_lifetimebound]]</span></code>.</p></li>
</ul>
</section>
<section id="improvements-to-clang-s-diagnostics">
<h3><a class="toc-backref" href="#id219" role="doc-backlink">Improvements to Clang's diagnostics</a><a class="headerlink" href="#improvements-to-clang-s-diagnostics" title="連結到這個標頭">¶</a></h3>
<ul>
<li><p>Clang constexpr evaluator now prints template arguments when displaying
template-specialization function calls.</p></li>
<li><p>Clang contexpr evaluator now displays notes as well as an error when a constructor
of a base class is not called in the constructor of its derived class.</p></li>
<li><p>Clang no longer emits <code class="docutils literal notranslate"><span class="pre">-Wmissing-variable-declarations</span></code> for variables declared
with the <code class="docutils literal notranslate"><span class="pre">register</span></code> storage class.</p></li>
<li><p>Clang's <code class="docutils literal notranslate"><span class="pre">-Wswitch-default</span></code> flag now diagnoses whenever a <code class="docutils literal notranslate"><span class="pre">switch</span></code> statement
does not have a <code class="docutils literal notranslate"><span class="pre">default</span></code> label.</p></li>
<li><p>Clang's <code class="docutils literal notranslate"><span class="pre">-Wtautological-negation-compare</span></code> flag now diagnoses logical
tautologies like <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">&amp;&amp;</span> <span class="pre">!x</span></code> and <code class="docutils literal notranslate"><span class="pre">!x</span> <span class="pre">||</span> <span class="pre">x</span></code> in expressions. This also
makes <code class="docutils literal notranslate"><span class="pre">-Winfinite-recursion</span></code> diagnose more cases.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/56035">#56035</a>).</p></li>
<li><p>Clang constexpr evaluator now diagnoses compound assignment operators against
uninitialized variables as a read of uninitialized object.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/51536">#51536</a>)</p></li>
<li><p>Clang's <code class="docutils literal notranslate"><span class="pre">-Wformat-truncation</span></code> now diagnoses <code class="docutils literal notranslate"><span class="pre">snprintf</span></code> call that is known to
result in string truncation.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64871">#64871</a>).
Existing warnings that similarly warn about the overflow in <code class="docutils literal notranslate"><span class="pre">sprintf</span></code>
now falls under its own warning group <code class="docutils literal notranslate"><span class="pre">`-Wformat-overflow</span></code> so that it can
be disabled separately from <code class="docutils literal notranslate"><span class="pre">Wfortify-source</span></code>.
These two new warning groups have subgroups <code class="docutils literal notranslate"><span class="pre">-Wformat-truncation-non-kprintf</span></code>
and <code class="docutils literal notranslate"><span class="pre">-Wformat-overflow-non-kprintf</span></code>, respectively. These subgroups are used when
the format string contains <code class="docutils literal notranslate"><span class="pre">%p</span></code> format specifier.
Because Linux kernel's codebase has format extensions for <code class="docutils literal notranslate"><span class="pre">%p</span></code>, kernel developers
are encouraged to disable these two subgroups by setting <code class="docutils literal notranslate"><span class="pre">-Wno-format-truncation-non-kprintf</span></code>
and <code class="docutils literal notranslate"><span class="pre">-Wno-format-overflow-non-kprintf</span></code> in order to avoid false positives on
the kernel codebase.
Also clang no longer emits false positive warnings about the output length of
<code class="docutils literal notranslate"><span class="pre">%g</span></code> format specifier and about <code class="docutils literal notranslate"><span class="pre">%o,</span> <span class="pre">%x,</span> <span class="pre">%X</span></code> with <code class="docutils literal notranslate"><span class="pre">#</span></code> flag.</p></li>
<li><p>Clang now emits <code class="docutils literal notranslate"><span class="pre">-Wcast-qual</span></code> for functional-style cast expressions.</p></li>
<li><p>Clang no longer emits irrelevant notes about unsatisfied constraint expressions
on the left-hand side of <code class="docutils literal notranslate"><span class="pre">||</span></code> when the right-hand side constraint is satisfied.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/54678">#54678</a>).</p></li>
<li><p>Clang now prints its 'note' diagnostic in cyan instead of black, to be more compatible
with terminals with dark background colors. This is also more consistent with GCC.</p></li>
<li><p>Clang now displays an improved diagnostic and a note when a defaulted special
member is marked <code class="docutils literal notranslate"><span class="pre">constexpr</span></code> in a class with a virtual base class
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64843">#64843</a>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-Wfixed-enum-extension</span></code> and <code class="docutils literal notranslate"><span class="pre">-Wmicrosoft-fixed-enum</span></code> diagnostics are no longer
emitted when building as C23, since C23 standardizes support for enums with a
fixed underlying type.</p></li>
<li><p>When describing the failure of static assertion of <cite>==</cite> expression, clang prints the integer
representation of the value as well as its character representation when
the user-provided expression is of character type. If the character is
non-printable, clang now shows the escpaed character.
Clang also prints multi-byte characters if the user-provided expression
is of multi-byte character type.</p>
<p><em>Example Code</em>:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">static_assert</span><span class="p">(</span><span class="s">&quot;A</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sa">U</span><span class="sc">&#39;🌍&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p><em>BEFORE</em>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>source:1:15: error: static assertion failed due to requirement &#39;&quot;A\n&quot;[1] == U&#39;\U0001f30d&#39;&#39;
1 | static_assert(&quot;A\n&quot;[1] == U&#39;🌍&#39;);
  |               ^~~~~~~~~~~~~~~~~
source:1:24: note: expression evaluates to &#39;&#39;
&#39; == 127757&#39;
1 | static_assert(&quot;A\n&quot;[1] == U&#39;🌍&#39;);
  |               ~~~~~~~~~^~~~~~~~
</pre></div>
</div>
<p><em>AFTER</em>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>source:1:15: error: static assertion failed due to requirement &#39;&quot;A\n&quot;[1] == U&#39;\U0001f30d&#39;&#39;
1 | static_assert(&quot;A\n&quot;[1] == U&#39;🌍&#39;);
  |               ^~~~~~~~~~~~~~~~~
source:1:24: note: expression evaluates to &#39;&#39;\n&#39; (0x0A, 10) == U&#39;🌍&#39; (0x1F30D, 127757)&#39;
1 | static_assert(&quot;A\n&quot;[1] == U&#39;🌍&#39;);
  |               ~~~~~~~~~^~~~~~~~
</pre></div>
</div>
</li>
<li><p>Clang now always diagnoses when using non-standard layout types in <code class="docutils literal notranslate"><span class="pre">offsetof</span></code> .
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64619">#64619</a>)</p></li>
<li><p>Clang now diagnoses redefined defaulted constructor when redefined
defaulted constructor with different exception specs.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/69094">#69094</a>)</p></li>
<li><p>Clang now diagnoses use of variable-length arrays in C++ by default (and
under <code class="docutils literal notranslate"><span class="pre">-Wall</span></code> in GNU++ mode). This is an extension supported by Clang and
GCC, but is very easy to accidentally use without realizing it's a
nonportable construct that has different semantics from a constant-sized
array. (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/62836">#62836</a>)</p></li>
<li><p>Clang changed the order in which it displays candidate functions on overloading failures.
Previously, Clang used definition of ordering from the C++ Standard. The order defined in
the Standard is partial and is not suited for sorting. Instead, Clang now uses a strict
order that still attempts to push more relevant functions to the top by comparing their
corresponding conversions. In some cases, this results in better order. E.g., for the
following code</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">operator</span><span class="w"> </span><span class="kt">int</span><span class="p">();</span>
<span class="w">  </span><span class="k">operator</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="p">();</span>
<span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Foo</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Foo</span><span class="p">();</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>Clang now produces a list with two most relevant builtin operators at the top,
i.e. <code class="docutils literal notranslate"><span class="pre">operator-(int,</span> <span class="pre">int)</span></code> and <code class="docutils literal notranslate"><span class="pre">operator-(const</span> <span class="pre">char*,</span> <span class="pre">const</span> <span class="pre">char*)</span></code>.
Previously <code class="docutils literal notranslate"><span class="pre">operator-(const</span> <span class="pre">char*,</span> <span class="pre">const</span> <span class="pre">char*)</span></code> was the first element,
but <code class="docutils literal notranslate"><span class="pre">operator-(int,</span> <span class="pre">int)</span></code> was only the 13th element in the output.
However, new implementation does not take into account some aspects of
C++ semantics, e.g. which function template is more specialized. This
can sometimes lead to worse ordering.</p>
</li>
<li><p>When describing a warning/error in a function-style type conversion Clang underlines only until
the end of the expression we convert from. Now Clang underlines until the closing parenthesis.</p>
<p>Before:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>warning: cast from &#39;long (*)(const int &amp;)&#39; to &#39;decltype(fun_ptr)&#39; (aka &#39;long (*)(int &amp;)&#39;) converts to incompatible function type [-Wcast-function-type-strict]
24 | return decltype(fun_ptr)( f_ptr /*comment*/);
   |        ^~~~~~~~~~~~~~~~~~~~~~~~
</pre></div>
</div>
<p>After:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>warning: cast from &#39;long (*)(const int &amp;)&#39; to &#39;decltype(fun_ptr)&#39; (aka &#39;long (*)(int &amp;)&#39;) converts to incompatible function type [-Wcast-function-type-strict]
24 | return decltype(fun_ptr)( f_ptr /*comment*/);
   |        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">-Wzero-as-null-pointer-constant</span></code> diagnostic is no longer emitted when using <code class="docutils literal notranslate"><span class="pre">__null</span></code>
(or, more commonly, <code class="docutils literal notranslate"><span class="pre">NULL</span></code> when the platform defines it as <code class="docutils literal notranslate"><span class="pre">__null</span></code>) to be more consistent
with GCC.</p></li>
<li><p>Clang will warn on deprecated specializations used in system headers when their instantiation
is caused by user code.</p></li>
<li><p>Clang will now print <code class="docutils literal notranslate"><span class="pre">static_assert</span></code> failure details for arithmetic binary operators.
Example:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">static_assert</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">15</span><span class="p">);</span>
</pre></div>
</div>
<p>will now print:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>error: static assertion failed due to requirement &#39;1 &lt;&lt; 4 == 15&#39;
   48 | static_assert(1 &lt;&lt; 4 == 15);
      |               ^~~~~~~~~~~~
note: expression evaluates to &#39;16 == 15&#39;
   48 | static_assert(1 &lt;&lt; 4 == 15);
      |               ~~~~~~~^~~~~
</pre></div>
</div>
</li>
<li><p>Clang now diagnoses definitions of friend function specializations, e.g. <code class="docutils literal notranslate"><span class="pre">friend</span> <span class="pre">void</span> <span class="pre">f&lt;&gt;(int)</span> <span class="pre">{}</span></code>.</p></li>
<li><p>Clang now diagnoses narrowing conversions involving const references.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/63151">#63151</a>).</p></li>
<li><p>Clang now diagnoses unexpanded packs within the template argument lists of function template specializations.</p></li>
<li><p>The warning <cite>-Wnan-infinity-disabled</cite> is now emitted when <code class="docutils literal notranslate"><span class="pre">INFINITY</span></code>
or <code class="docutils literal notranslate"><span class="pre">NAN</span></code> are used in arithmetic operations or function arguments in
floating-point mode where <code class="docutils literal notranslate"><span class="pre">INFINITY</span></code> or <code class="docutils literal notranslate"><span class="pre">NAN</span></code> don't have the expected
values.</p></li>
<li><p>Clang now diagnoses attempts to bind a bitfield to an NTTP of a reference type as erroneous
converted constant expression and not as a reference to subobject.</p></li>
<li><p>Clang now diagnoses <code class="docutils literal notranslate"><span class="pre">auto</span></code> and <code class="docutils literal notranslate"><span class="pre">decltype(auto)</span></code> in declarations of conversion function template
(<a class="reference external" href="https://cplusplus.github.io/CWG/issues/1878.html">CWG1878</a>)</p></li>
<li><p>Clang now diagnoses the requirement that non-template friend declarations with requires clauses
and template friend declarations with a constraint that depends on a template parameter from an
enclosing template must be a definition.</p></li>
<li><p>Clang now diagnoses incorrect usage of <code class="docutils literal notranslate"><span class="pre">const</span></code> and <code class="docutils literal notranslate"><span class="pre">pure</span></code> attributes, so <code class="docutils literal notranslate"><span class="pre">-Wignored-attributes</span></code> diagnoses more cases.</p></li>
<li><p>Clang now emits more descriptive diagnostics for 'unusual' expressions (e.g. incomplete index
expressions on matrix types or builtin functions without an argument list) as placement-args
to new-expressions.</p>
<p>Before:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>error: no matching function for call to &#39;operator new&#39;
   13 |     new (__builtin_memset) S {};
      |     ^   ~~~~~~~~~~~~~~~~~~

note: candidate function not viable: no known conversion from &#39;&lt;builtin fn type&gt;&#39; to &#39;int&#39; for 2nd argument
    5 |     void* operator new(__SIZE_TYPE__, int);
      |           ^
</pre></div>
</div>
<p>After:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>error: builtin functions must be directly called
   13 |     new (__builtin_memset) S {};
      |          ^
</pre></div>
</div>
</li>
<li><p>Clang now diagnoses import before module declarations but not in global
module fragment.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/67627">#67627</a>).</p></li>
<li><p>Clang now diagnoses include headers with angle in module purviews, which is
not usually intended.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/68615">#68615</a>)</p></li>
<li><p>Clang now won't mention invisible namespace when diagnose invisible declarations
inside namespace. The original diagnostic message is confusing.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/73893">#73893</a>)</p></li>
</ul>
</section>
<section id="improvements-to-clang-s-time-trace">
<h3><a class="toc-backref" href="#id220" role="doc-backlink">Improvements to Clang's time-trace</a><a class="headerlink" href="#improvements-to-clang-s-time-trace" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>Two time-trace scope variables are added. A time trace scope variable of
<code class="docutils literal notranslate"><span class="pre">ParseDeclarationOrFunctionDefinition</span></code> with the function's source location
is added to record the time spent parsing the function's declaration or
definition. Another time trace scope variable of <code class="docutils literal notranslate"><span class="pre">ParseFunctionDefinition</span></code>
is also added to record the name of the defined function.</p></li>
</ul>
</section>
<section id="bug-fixes-in-this-version">
<h3><a class="toc-backref" href="#id221" role="doc-backlink">Bug Fixes in This Version</a><a class="headerlink" href="#bug-fixes-in-this-version" title="連結到這個標頭">¶</a></h3>
<ul>
<li><p>Fixed an issue where a class template specialization whose declaration is
instantiated in one module and whose definition is instantiated in another
module may end up with members associated with the wrong declaration of the
class, which can result in miscompiles in some cases.</p></li>
<li><p>Fix crash on use of a variadic overloaded operator.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/42535">#42535</a>)</p></li>
<li><p>Fix a hang on valid C code passing a function type as an argument to
<code class="docutils literal notranslate"><span class="pre">typeof</span></code> to form a function declaration.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64713">#64713</a>)</p></li>
<li><p>Clang now reports missing-field-initializers warning for missing designated
initializers in C++.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/56628">#56628</a>)</p></li>
<li><p>Clang now respects <code class="docutils literal notranslate"><span class="pre">-fwrapv</span></code> and <code class="docutils literal notranslate"><span class="pre">-ftrapv</span></code> for <code class="docutils literal notranslate"><span class="pre">__builtin_abs</span></code> and
<code class="docutils literal notranslate"><span class="pre">abs</span></code> builtins.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/45129">#45129</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/issues/45794">#45794</a>)</p></li>
<li><p>Fixed an issue where accesses to the local variables of a coroutine during
<code class="docutils literal notranslate"><span class="pre">await_suspend</span></code> could be misoptimized, including accesses to the awaiter
object itself.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/56301">#56301</a>)
The current solution may bring performance regressions if the awaiters have
non-static data members. See
<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64945">#64945</a> for details.</p></li>
<li><p>Clang now prints unnamed members in diagnostic messages instead of giving an
empty ''. Fixes
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/63759">#63759</a>)</p></li>
<li><p>Fix crash in __builtin_strncmp and related builtins when the size value
exceeded the maximum value representable by int64_t. Fixes
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64876">#64876</a>)</p></li>
<li><p>Fixed an assertion if a function has cleanups and fatal erors.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/48974">#48974</a>)</p></li>
<li><p>Clang now emits an error if it is not possible to deduce array size for a
variable with incomplete array type.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/37257">#37257</a>)</p></li>
<li><p>Clang's <code class="docutils literal notranslate"><span class="pre">-Wunused-private-field</span></code> no longer warns on fields whose type is
declared with <code class="docutils literal notranslate"><span class="pre">[[maybe_unused]]</span></code>.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/61334">#61334</a>)</p></li>
<li><p>For function multi-versioning using the <code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">target_clones</span></code>, or
<code class="docutils literal notranslate"><span class="pre">target_version</span></code> attributes, remove comdat for internal linkage functions.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/65114">#65114</a>)</p></li>
<li><p>Clang now reports <code class="docutils literal notranslate"><span class="pre">-Wformat</span></code> for bool value and char specifier confusion
in scanf. Fixes
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64987">#64987</a>)</p></li>
<li><p>Support MSVC predefined macro expressions in constant expressions and in
local structs.</p></li>
<li><p>Correctly parse non-ascii identifiers that appear immediately after a line splicing
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/65156">#65156</a>)</p></li>
<li><p>Clang no longer considers the loss of <code class="docutils literal notranslate"><span class="pre">__unaligned</span></code> qualifier from objects as
an invalid conversion during method function overload resolution.</p></li>
<li><p>Fix lack of comparison of declRefExpr in ASTStructuralEquivalence
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/66047">#66047</a>)</p></li>
<li><p>Fix parser crash when dealing with ill-formed objective C++ header code. Fixes
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64836">#64836</a>)</p></li>
<li><p>Fix crash in implicit conversions from initialize list to arrays of unknown
bound for C++20. Fixes
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/62945">#62945</a>)</p></li>
<li><p>Clang now allows an <code class="docutils literal notranslate"><span class="pre">_Atomic</span></code> qualified integer in a switch statement. Fixes
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/65557">#65557</a>)</p></li>
<li><p>Fixes crash when trying to obtain the common sugared type of
<cite>decltype(instantiation-dependent-expr)</cite>.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/67603">#67603</a>)</p></li>
<li><p>Fixes a crash caused by a multidimensional array being captured by a lambda
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/67722">#67722</a>).</p></li>
<li><p>Fixes a crash when instantiating a lambda with requires clause.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64462">#64462</a>)</p></li>
<li><p>Fixes a regression where the <code class="docutils literal notranslate"><span class="pre">UserDefinedLiteral</span></code> was not properly preserved
while evaluating consteval functions. (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/63898">#63898</a>).</p></li>
<li><p>Fix a crash when evaluating value-dependent structured binding
variables at compile time.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/67690">#67690</a>)</p></li>
<li><p>Fixes a <code class="docutils literal notranslate"><span class="pre">clang-17</span></code> regression where <code class="docutils literal notranslate"><span class="pre">LLVM_UNREACHABLE_OPTIMIZE=OFF</span></code>
cannot be used with <code class="docutils literal notranslate"><span class="pre">Release</span></code> mode builds. (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/68237">#68237</a>).</p></li>
<li><p>Fix crash in evaluating <code class="docutils literal notranslate"><span class="pre">constexpr</span></code> value for invalid template function.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/68542">#68542</a>)</p></li>
<li><p>Clang will correctly evaluate <code class="docutils literal notranslate"><span class="pre">noexcept</span></code> expression for template functions
of template classes. Fixes
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/68543">#68543</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/issues/42496">#42496</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/issues/77071">#77071</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/issues/77411">#77411</a>)</p></li>
<li><p>Fixed an issue when a shift count larger than <code class="docutils literal notranslate"><span class="pre">__INT64_MAX__</span></code>, in a right
shift operation, could result in missing warnings about
<code class="docutils literal notranslate"><span class="pre">shift</span> <span class="pre">count</span> <span class="pre">&gt;=</span> <span class="pre">width</span> <span class="pre">of</span> <span class="pre">type</span></code> or internal compiler error.</p></li>
<li><p>Fixed an issue with computing the common type for the LHS and RHS of a <cite>?:</cite>
operator in C. No longer issuing a confusing diagnostic along the lines of
&quot;incompatible operand types ('foo' and 'foo')&quot; with extensions such as matrix
types. Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/69008">#69008</a>)</p></li>
<li><p>Clang no longer permits using the <cite>_BitInt</cite> types as an underlying type for an
enumeration as specified in the C23 Standard.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/69619">#69619</a>)</p></li>
<li><p>Fixed an issue when a shift count specified by a small constant <code class="docutils literal notranslate"><span class="pre">_BitInt()</span></code>,
in a left shift operation, could result in a faulty warnings about
<code class="docutils literal notranslate"><span class="pre">shift</span> <span class="pre">count</span> <span class="pre">&gt;=</span> <span class="pre">width</span> <span class="pre">of</span> <span class="pre">type</span></code>.</p></li>
<li><p>Clang now accepts anonymous members initialized with designated initializers
inside templates.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/65143">#65143</a>)</p></li>
<li><p>Fix crash in formatting the real/imaginary part of a complex lvalue.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/69218">#69218</a>)</p></li>
<li><p>No longer use C++ <code class="docutils literal notranslate"><span class="pre">thread_local</span></code> semantics in C23 when using
<code class="docutils literal notranslate"><span class="pre">thread_local</span></code> instead of <code class="docutils literal notranslate"><span class="pre">_Thread_local</span></code>.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/70068">#70068</a>) and
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/69167">#69167</a>)</p></li>
<li><p>Fix crash in evaluating invalid lambda expression which forget capture this.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/67687">#67687</a>)</p></li>
<li><p>Fix crash from constexpr evaluator evaluating uninitialized arrays as rvalue.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/67317">#67317</a>)</p></li>
<li><p>Clang now properly diagnoses use of stand-alone OpenMP directives after a
label (including <code class="docutils literal notranslate"><span class="pre">case</span></code> or <code class="docutils literal notranslate"><span class="pre">default</span></code> labels).</p></li>
<li><p>Fix compiler memory leak for enums with underlying type larger than 64 bits.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/pull/78311">#78311</a>)</p>
<p>Before:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="nl">label</span><span class="p">:</span>
<span class="cp">#pragma omp barrier </span><span class="c1">// ok</span>
</pre></div>
</div>
<p>After:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="nl">label</span><span class="p">:</span>
<span class="cp">#pragma omp barrier </span><span class="c1">// error: &#39;#pragma omp barrier&#39; cannot be an immediate substatement</span>
</pre></div>
</div>
</li>
<li><p>Fixed an issue that a benign assertion might hit when instantiating a pack expansion
inside a lambda. (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/61460">#61460</a>)</p></li>
<li><p>Fix crash during instantiation of some class template specializations within class
templates. Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/70375">#70375</a>)</p></li>
<li><p>Fix crash during code generation of C++ coroutine initial suspend when the return
type of await_resume is not trivially destructible.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/63803">#63803</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__is_trivially_relocatable</span></code> no longer returns true for non-object types
such as references and functions.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/67498">#67498</a>)</p></li>
<li><p>Fix crash when the object used as a <code class="docutils literal notranslate"><span class="pre">static_assert</span></code> message has <code class="docutils literal notranslate"><span class="pre">size</span></code> or <code class="docutils literal notranslate"><span class="pre">data</span></code> members
which are not member functions.</p></li>
<li><p>Support UDLs in <code class="docutils literal notranslate"><span class="pre">static_assert</span></code> message.</p></li>
<li><p>Fixed false positive error emitted by clang when performing qualified name
lookup and the current class instantiation has dependent bases.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/13826">#13826</a>)</p></li>
<li><p>Fix a <code class="docutils literal notranslate"><span class="pre">clang-17</span></code> regression where a templated friend with constraints is not
properly applied when its parameters reference an enclosing non-template class.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/71595">#71595</a>)</p></li>
<li><p>Fix the name of the ifunc symbol emitted for multiversion functions declared with the
<code class="docutils literal notranslate"><span class="pre">target_clones</span></code> attribute. This addresses a linker error that would otherwise occur
when these functions are referenced from other TUs.</p></li>
<li><p>Fixes compile error that double colon operator cannot resolve macro with parentheses.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64467">#64467</a>)</p></li>
<li><p>Clang's <code class="docutils literal notranslate"><span class="pre">-Wchar-subscripts</span></code> no longer warns on chars whose values are known non-negative constants.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/18763">#18763</a>)</p></li>
<li><p>Fix crash due to incorrectly allowing conversion functions in copy elision.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/39319">#39319</a>) and
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/60182">#60182</a>) and
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/62157">#62157</a>) and
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64885">#64885</a>) and
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/65568">#65568</a>)</p></li>
<li><p>Fix an issue where clang doesn't respect detault template arguments that
are added in a later redeclaration for CTAD.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/69987">#69987</a>)</p></li>
<li><p>Fix an issue where CTAD fails for explicit type conversion.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64347">#64347</a>)</p></li>
<li><p>Fix crash when using C++ only tokens like <code class="docutils literal notranslate"><span class="pre">::</span></code> in C compiler clang.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/73559">#73559</a>)</p></li>
<li><p>Clang now accepts recursive non-dependent calls to functions with deduced
return type.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/71015">#71015</a>)</p></li>
<li><p>Fix assertion failure when initializing union containing struct with
flexible array member using empty initializer list.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/77085">#77085</a>)</p></li>
<li><p>Fix assertion crash due to failed scope restoring caused by too-early VarDecl
invalidation by invalid initializer Expr.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/30908">#30908</a>)</p></li>
<li><p>Clang now emits correct source location for code-coverage regions in <cite>if constexpr</cite>
and <cite>if consteval</cite> branches. Untaken branches are now skipped.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/54419">#54419</a>)</p></li>
<li><p>Fix assertion failure when declaring a template friend function with
a constrained parameter in a template class that declares a class method
or lambda at different depth.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/75426">#75426</a>)</p></li>
<li><p>Fix an issue where clang cannot find conversion function with template
parameter when instantiation of template class.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/77583">#77583</a>)</p></li>
<li><p>Fix an issue where CTAD fails for function-type/array-type arguments.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/51710">#51710</a>)</p></li>
<li><p>Fix crashes when using the binding decl from an invalid structured binding.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/67495">#67495</a>) and
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/72198">#72198</a>)</p></li>
<li><p>Fix assertion failure when call noreturn-attribute function with musttail
attribute.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/76631">#76631</a>)
- The MS <code class="docutils literal notranslate"><span class="pre">__noop</span></code> builtin without an argument list is now accepted
in the placement-args of new-expressions, matching MSVC's behaviour.</p></li>
<li><p>Fix an issue that caused MS <code class="docutils literal notranslate"><span class="pre">__decspec(property)</span></code> accesses as well as
Objective-C++ property accesses to not be converted to a function call
to the getter in the placement-args of new-expressions.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/65053">#65053</a>)</p></li>
<li><p>Fix an issue with missing symbol definitions when the first coroutine
statement appears in a discarded <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">constexpr</span></code> branch.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/78290">#78290</a>)</p></li>
<li><p>Fixed assertion failure with deleted overloaded unary operators.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/78314">#78314</a>)</p></li>
<li><p>The XCOFF object file format does not support aliases to symbols having common
linkage. Clang now diagnoses the use of an alias for a common symbol when
compiling for AIX.</p></li>
<li><p>Clang now doesn't produce false-positive warning <cite>-Wconstant-logical-operand</cite>
for logical operators in C23.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64356">#64356</a>).</p></li>
<li><p>Clang's <code class="docutils literal notranslate"><span class="pre">-Wshadow</span></code> no longer warns when an init-capture is named the same as
a class field unless the lambda can capture this.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/71976">#71976</a>)</p></li>
</ul>
<section id="bug-fixes-to-compiler-builtins">
<h4>Bug Fixes to Compiler Builtins<a class="headerlink" href="#bug-fixes-to-compiler-builtins" title="連結到這個標頭">¶</a></h4>
</section>
<section id="bug-fixes-to-attribute-support">
<h4>Bug Fixes to Attribute Support<a class="headerlink" href="#bug-fixes-to-attribute-support" title="連結到這個標頭">¶</a></h4>
</section>
<section id="bug-fixes-to-c-support">
<h4>Bug Fixes to C++ Support<a class="headerlink" href="#bug-fixes-to-c-support" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Clang limits the size of arrays it will try to evaluate at compile time
to avoid memory exhaustion.
This limit can be modified by <cite>-fconstexpr-steps</cite>.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/63562">#63562</a>)</p></li>
<li><p>Fix a crash caused by some named unicode escape sequences designating
a Unicode character whose name contains a <code class="docutils literal notranslate"><span class="pre">-</span></code>.
(Fixes <a class="reference external" href="https://github.com/llvm/llvm-project/issues/64161">#64161</a>)</p></li>
<li><p>Fix cases where we ignore ambiguous name lookup when looking up members.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/22413">#22413</a>),
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/29942">#29942</a>),
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/35574">#35574</a>) and
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/27224">#27224</a>).</p></li>
<li><p>Clang emits an error on substitution failure within lambda body inside a
requires-expression. This fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64138">#64138</a>) and
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/71684">#71684</a>).</p></li>
<li><p>Update <code class="docutils literal notranslate"><span class="pre">FunctionDeclBitfields.NumFunctionDeclBits</span></code>. This fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64171">#64171</a>).</p></li>
<li><p>Expressions producing <code class="docutils literal notranslate"><span class="pre">nullptr</span></code> are correctly evaluated
by the constant interpreter when appearing as the operand
of a binary comparison.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64923">#64923</a>)</p></li>
<li><p>Fix a crash when an immediate invocation is not a constant expression
and appear in an implicit cast.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64949">#64949</a>).</p></li>
<li><p>Fix crash when parsing ill-formed lambda trailing return type. Fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64962">#64962</a>) and
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/28679">#28679</a>).</p></li>
<li><p>Fix a crash caused by substitution failure in expression requirements.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64172">#64172</a>) and
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64723">#64723</a>).</p></li>
<li><p>Fix crash when parsing the requires clause of some generic lambdas.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64689">#64689</a>)</p></li>
<li><p>Fix crash when the trailing return type of a generic and dependent
lambda refers to an init-capture.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/65067">#65067</a> and
<a class="reference external" href="https://github.com/llvm/llvm-project/issues/63675">#63675</a>)</p></li>
<li><p>Clang now properly handles out of line template specializations when there is
a non-template inner-class between the function and the class template.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/65810">#65810</a>)</p></li>
<li><p>Fix a crash when calling a non-constant immediate function
in the initializer of a static data member.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/65985">#65985</a>).</p></li>
<li><p>Clang now properly converts static lambda call operator to function
pointers on win32.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/62594">#62594</a>)</p></li>
<li><p>Fixed some cases where the source location for an instantiated specialization
of a function template or a member function of a class template was assigned
the location of a non-defining declaration rather than the location of the
definition the specialization was instantiated from.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/26057">#26057</a>)</p></li>
<li><p>Fix a crash when a default member initializer of a base aggregate
makes an invalid call to an immediate function.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/66324">#66324</a>)</p></li>
<li><p>Fix crash for a lambda attribute with a statement expression
that contains a <cite>return</cite>.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/48527">#48527</a>)</p></li>
<li><p>Clang now no longer asserts when an UnresolvedLookupExpr is used as an
expression requirement. (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/66612">#66612</a>)</p></li>
<li><p>Clang now disambiguates NTTP types when printing diagnostics where the
NTTP types are compared with the 'diff' method.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/66744">#66744</a>)</p></li>
<li><p>Fix crash caused by a spaceship operator returning a comparision category by
reference. Fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64162">#64162</a>)</p></li>
<li><p>Fix a crash when calling a consteval function in an expression used as
the size of an array.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/65520">#65520</a>)</p></li>
<li><p>Clang no longer tries to capture non-odr-used variables that appear
in the enclosing expression of a lambda expression with a noexcept specifier.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/67492">#67492</a>)</p></li>
<li><p>Fix crash when fold expression was used in the initialization of default
argument. Fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/67395">#67395</a>)</p></li>
<li><p>Fixed a bug causing destructors of constant-evaluated structured bindings
initialized by array elements to be called in the wrong evaluation context.</p></li>
<li><p>Fix crash where ill-formed code was being treated as a deduction guide and
we now produce a diagnostic. Fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/65522">#65522</a>)</p></li>
<li><p>Fixed a bug where clang incorrectly considered implicitly generated deduction
guides from a non-templated constructor and a templated constructor as ambiguous,
rather than prefer the non-templated constructor as specified in
[standard.group]p3.</p></li>
<li><p>Fixed a crash caused by incorrect handling of dependence on variable templates
with non-type template parameters of reference type. Fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/65153">#65153</a>)</p></li>
<li><p>Clang now properly compares constraints on an out of line class template
declaration definition. Fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/61763">#61763</a>)</p></li>
<li><p>Fix a bug where implicit deduction guides are not correctly generated for nested template
classes. Fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/46200">#46200</a>)
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/57812">#57812</a>)</p></li>
<li><p>Diagnose use of a variable-length array in a coroutine. The design of
coroutines is such that it is not possible to support VLA use. Fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/65858">#65858</a>)</p></li>
<li><p>Fix bug where we were overriding zero-initialization of class members when
default initializing a base class in a constant expression context. Fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/69890">#69890</a>)</p></li>
<li><p>Fix crash when template class static member imported to other translation unit.
Fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/68769">#68769</a>)</p></li>
<li><p>Clang now rejects incomplete types for <code class="docutils literal notranslate"><span class="pre">__builtin_dump_struct</span></code>. Fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/63506">#63506</a>)</p></li>
<li><p>Fixed a crash for C++98/03 while checking an ill-formed <code class="docutils literal notranslate"><span class="pre">_Static_assert</span></code> expression.
Fixes: (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/72025">#72025</a>)</p></li>
<li><p>Clang now defers the instantiation of explicit specifier until constraint checking
completes (except deduction guides). Fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/59827">#59827</a>)</p></li>
<li><p>Fix crash when parsing nested requirement. Fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/73112">#73112</a>)</p></li>
<li><p>Fixed a crash caused by using return type requirement in a lambda. Fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/63808">#63808</a>)
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64607">#64607</a>)
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64086">#64086</a>)</p></li>
<li><p>Fixed a crash where we lost uninstantiated constraints on placeholder NTTP packs. Fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/63837">#63837</a>)</p></li>
<li><p>Fixed a regression where clang forgets how to substitute into constraints on template-template
parameters. Fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/57410">#57410</a>) and
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/57410">#76604</a>)</p></li>
<li><p>Fix a bug where clang would produce inconsistent values when
<code class="docutils literal notranslate"><span class="pre">std::source_location::current()</span></code> was used in a function template.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/78128">#78128</a>)</p></li>
<li><p>Clang now allows parenthesized initialization of arrays in <cite>operator new[]</cite>.
Fixes: (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/68198">#68198</a>)</p></li>
<li><p>Fixes CTAD for aggregates on nested template classes. Fixes:
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/77599">#77599</a>)</p></li>
<li><p>Fix crash when importing the same module with an dynamic initializer twice
in different visibility.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/67893">#67893</a>)</p></li>
<li><p>Remove recorded <cite>#pragma once</cite> state for headers included in named modules.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/77995">#77995</a>)</p></li>
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">__cpp_auto_cast</span></code> feature test macro in C++23 mode.</p></li>
<li><p>Fix crash for inconsistent deducing state of function return types
in importing modules.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/78830">#78830</a>)
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/60085">#60085</a>)</p></li>
<li><p>Fixed a bug where variables referenced by requires-clauses inside
nested generic lambdas were not properly injected into the constraint scope.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/73418">#73418</a>)</p></li>
<li><p>Fix incorrect code generation caused by the object argument of <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">operator()</span></code> and <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">operator[]</span></code> calls not being evaluated.
Fixes (<a class="reference external" href="https://github.com/llvm/llvm-project/issues/67976">#67976</a>)</p></li>
<li><p>Fix crash when using an immediate-escalated function at global scope.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/82258">#82258</a>)</p></li>
<li><p>Correctly immediate-escalate lambda conversion functions.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/82258">#82258</a>)</p></li>
<li><p>Fix a crash when an unresolved overload set is encountered on the RHS of a <code class="docutils literal notranslate"><span class="pre">.*</span></code> operator.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/53815">#53815</a>)</p></li>
<li><p>Fixed a regression in CTAD that a friend declaration that befriends itself may cause
incorrect constraint substitution.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/86769">#86769</a>)</p></li>
</ul>
</section>
<section id="bug-fixes-to-ast-handling">
<h4>Bug Fixes to AST Handling<a class="headerlink" href="#bug-fixes-to-ast-handling" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Fixed an import failure of recursive friend class template.
<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64169">Issue 64169</a></p></li>
<li><p>Remove unnecessary RecordLayout computation when importing UnaryOperator. The
computed RecordLayout is incorrect if fields are not completely imported and
should not be cached.
<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64170">Issue 64170</a></p></li>
<li><p>Fixed <code class="docutils literal notranslate"><span class="pre">hasAnyBase</span></code> not binding nodes in its submatcher.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/65421">#65421</a>)</p></li>
<li><p>Fixed a bug where RecursiveASTVisitor fails to visit the
initializer of a bitfield.
<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64916">Issue 64916</a></p></li>
<li><p>Fixed a bug where range-loop-analysis checks for trivial copyability,
rather than trivial copy-constructibility
<a class="reference external" href="https://github.com/llvm/llvm-project/issues/47355">Issue 47355</a></p></li>
<li><p>Fixed a bug where Template Instantiation failed to handle Lambda Expressions
with certain types of Attributes.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/76521">#76521</a>)</p></li>
</ul>
</section>
<section id="miscellaneous-bug-fixes">
<h4>Miscellaneous Bug Fixes<a class="headerlink" href="#miscellaneous-bug-fixes" title="連結到這個標頭">¶</a></h4>
</section>
<section id="miscellaneous-clang-crashes-fixed">
<h4>Miscellaneous Clang Crashes Fixed<a class="headerlink" href="#miscellaneous-clang-crashes-fixed" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Fixed a crash when parsing top-level ObjC blocks that aren't properly
terminated. Clang should now also recover better when an &#64;end is missing
between blocks.
<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64065">Issue 64065</a></p></li>
<li><p>Fixed a crash when check array access on zero-length element.
<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64564">Issue 64564</a></p></li>
<li><p>Fixed a crash when an ObjC ivar has an invalid type. See
(<a class="reference external" href="https://github.com/llvm/llvm-project/pull/68001">#68001</a>)</p></li>
<li><p>Fixed a crash in C when redefined struct is another nested redefinition.
<a class="reference external" href="https://github.com/llvm/llvm-project/issues/41302">Issue 41302</a></p></li>
<li><p>Fixed a crash when <code class="docutils literal notranslate"><span class="pre">-ast-dump=json</span></code> was used for code using class
template deduction guides.</p></li>
<li><p>Fixed a crash when a lambda marked as <code class="docutils literal notranslate"><span class="pre">static</span></code> referenced a captured
variable in an expression.
<a class="reference external" href="https://github.com/llvm/llvm-project/issues/74608">Issue 74608</a></p></li>
<li><p>Fixed a crash with modules and a <code class="docutils literal notranslate"><span class="pre">constexpr</span></code> destructor.
<a class="reference external" href="https://github.com/llvm/llvm-project/issues/68702">Issue 68702</a></p></li>
</ul>
</section>
</section>
<section id="openacc-specific-changes">
<h3><a class="toc-backref" href="#id222" role="doc-backlink">OpenACC Specific Changes</a><a class="headerlink" href="#openacc-specific-changes" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>OpenACC Implementation effort is beginning with semantic analysis and parsing
of OpenACC pragmas. The <code class="docutils literal notranslate"><span class="pre">-fopenacc</span></code> flag was added to enable these new,
albeit incomplete changes. The <code class="docutils literal notranslate"><span class="pre">_OPENACC</span></code> macro is currently defined to
<code class="docutils literal notranslate"><span class="pre">1</span></code>, as support is too incomplete to update to a standards-required value.</p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">-fexperimental-openacc-macro-override</span></code>, a command line option to
permit overriding the <code class="docutils literal notranslate"><span class="pre">_OPENACC</span></code> macro to be any digit-only value specified
by the user, which permits testing the compiler against existing OpenACC
workloads in order to evaluate implementation progress.</p></li>
</ul>
</section>
<section id="target-specific-changes">
<h3><a class="toc-backref" href="#id223" role="doc-backlink">Target Specific Changes</a><a class="headerlink" href="#target-specific-changes" title="連結到這個標頭">¶</a></h3>
<section id="amdgpu-support">
<h4>AMDGPU Support<a class="headerlink" href="#amdgpu-support" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Use pass-by-reference (byref) in stead of pass-by-value (byval) for struct
arguments in C ABI. Callee is responsible for allocating stack memory and
copying the value of the struct if modified. Note that AMDGPU backend still
supports byval for struct arguments.</p></li>
<li><p>The default value for <code class="docutils literal notranslate"><span class="pre">-mcode-object-version</span></code> is now 5.
See <a class="reference external" href="https://llvm.org/docs/AMDGPUUsage.html#code-object-v5-metadata">AMDHSA Code Object V5 Metadata</a>
for more details.</p></li>
</ul>
</section>
<section id="x86-support">
<h4>X86 Support<a class="headerlink" href="#x86-support" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Added option <code class="docutils literal notranslate"><span class="pre">-m[no-]evex512</span></code> to disable ZMM and 64-bit mask instructions
for AVX512 features.</p></li>
<li><p>Support ISA of <code class="docutils literal notranslate"><span class="pre">USER_MSR</span></code>.
* Support intrinsic of <code class="docutils literal notranslate"><span class="pre">_urdmsr</span></code>.
* Support intrinsic of <code class="docutils literal notranslate"><span class="pre">_uwrmsr</span></code>.</p></li>
<li><p>Support ISA of <code class="docutils literal notranslate"><span class="pre">AVX10.1</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-march=pantherlake</span></code> and <code class="docutils literal notranslate"><span class="pre">-march=clearwaterforest</span></code> are now supported.</p></li>
<li><p>Added ABI handling for <code class="docutils literal notranslate"><span class="pre">__float128</span></code> to match with GCC.</p></li>
<li><p>Emit warnings for options to enable knl/knm specific ISAs: AVX512PF, AVX512ER
and PREFETCHWT1. From next version (LLVM 19), these ISAs' intrinsic supports
will be deprecated:
* intrinsic series of <em>_exp2a23_</em>
* intrinsic series of <em>_rsqrt28_</em>
* intrinsic series of <em>_rcp28_</em>
* intrinsic series of <em>_prefetch_i[3|6][2|4]gather_</em>
* intrinsic series of <em>_prefetch_i[3|6][2|4]scatter_</em></p></li>
</ul>
</section>
<section id="arm-and-aarch64-support">
<h4>Arm and AArch64 Support<a class="headerlink" href="#arm-and-aarch64-support" title="連結到這個標頭">¶</a></h4>
<ul>
<li><p>C++ function name mangling has been changed to align with the specification
(<a class="reference external" href="https://github.com/ARM-software/abi-aa/blob/main/aapcs64/aapcs64.rst">https://github.com/ARM-software/abi-aa/blob/main/aapcs64/aapcs64.rst</a>).
This affects C++ functions with SVE ACLE parameters. Clang will use the old
manglings if <code class="docutils literal notranslate"><span class="pre">-fclang-abi-compat=17</span></code> or lower is  specified.</p></li>
<li><p>New AArch64 asm constraints have been added for r8-r11(Uci) and r12-r15(Ucj).</p></li>
<li><p>Support has been added for the following processors (-mcpu identifiers in parenthesis):</p>
<p>For Arm:</p>
<ul class="simple">
<li><p>Cortex-M52 (cortex-m52).</p></li>
</ul>
<p>For AArch64:</p>
<ul class="simple">
<li><p>Cortex-A520 (cortex-a520).</p></li>
<li><p>Cortex-A720 (cortex-a720).</p></li>
<li><p>Cortex-X4 (cortex-x4).</p></li>
</ul>
</li>
<li><p>Alpha support has been added for SVE2.1 intrinsics.</p></li>
<li><p>Support has been added for <cite>-fstack-clash-protection</cite> and <cite>-mstack-probe-size</cite>
command line options.</p></li>
<li><p>Function Multi Versioning has been extended to support Load-Acquire RCpc
instructions v3 (rcpc3) as well as Memory Copy and Memory Set Acceleration
instructions (mops) when targeting AArch64. The feature identifiers (in
parenthesis) can be used with either of the <code class="docutils literal notranslate"><span class="pre">target_version</span></code> and
<code class="docutils literal notranslate"><span class="pre">target_clones</span></code> attributes.</p></li>
</ul>
</section>
<section id="android-support">
<h4>Android Support<a class="headerlink" href="#android-support" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Android target triples are usually suffixed with a version. Clang searches for
target-specific runtime and standard libraries in directories named after the
target (e.g. if you're building with <code class="docutils literal notranslate"><span class="pre">--target=aarch64-none-linux-android21</span></code>,
Clang will look for <code class="docutils literal notranslate"><span class="pre">lib/aarch64-none-linux-android21</span></code> under its resource
directory to find runtime libraries). If an exact match isn't found, Clang
would previously fall back to a directory without any version (which would be
<code class="docutils literal notranslate"><span class="pre">lib/aarch64-none-linux-android</span></code> in our example). Clang will now look for
directories for lower versions and use the newest version it finds instead,
e.g. if you have <code class="docutils literal notranslate"><span class="pre">lib/aarch64-none-linux-android21</span></code> and
<code class="docutils literal notranslate"><span class="pre">lib/aarch64-none-linux-android29</span></code>, <code class="docutils literal notranslate"><span class="pre">-target</span> <span class="pre">aarch64-none-linux-android23</span></code>
will use the former and <code class="docutils literal notranslate"><span class="pre">-target</span> <span class="pre">aarch64-none-linux-android30</span></code> will use the
latter. Falling back to a versionless directory will now emit a warning, and
the fallback will be removed in Clang 19.</p></li>
</ul>
</section>
<section id="windows-support">
<h4>Windows Support<a class="headerlink" href="#windows-support" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Fixed an assertion failure that occurred due to a failure to propagate
<code class="docutils literal notranslate"><span class="pre">MSInheritanceAttr</span></code> attributes to class template instantiations created
for explicit template instantiation declarations.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">-fno-auto-import</span></code> option was added for MinGW targets. The option both
affects code generation (inhibiting generating indirection via <code class="docutils literal notranslate"><span class="pre">.refptr</span></code>
stubs for potentially auto imported symbols, generating smaller and more
efficient code) and linking (making the linker error out on such cases).
If the option only is used during code generation but not when linking,
linking may succeed but the resulting executables may expose issues at
runtime.</p></li>
<li><p>Clang now passes relevant LTO options to the linker (LLD) in MinGW mode.</p></li>
</ul>
</section>
<section id="loongarch-support">
<h4>LoongArch Support<a class="headerlink" href="#loongarch-support" title="連結到這個標頭">¶</a></h4>
<ul>
<li><p>Added builtins support for all LSX (128-bits SIMD) and LASX (256-bits SIMD)
instructions.</p></li>
<li><p>Added builtins support for approximate calculation instructions that were
introduced in LoongArch Reference Manual V1.10.</p></li>
<li><p>Made <code class="docutils literal notranslate"><span class="pre">-mcmodel=</span></code> compatible with LoongArch gcc that accepted <code class="docutils literal notranslate"><span class="pre">normal</span></code>,
<code class="docutils literal notranslate"><span class="pre">medium</span></code> and <code class="docutils literal notranslate"><span class="pre">extreme</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">model</span></code> attribute was now supported for overriding the default code
model used to access global variables. The following values were supported:
<code class="docutils literal notranslate"><span class="pre">normal</span></code>, <code class="docutils literal notranslate"><span class="pre">medium</span></code> and <code class="docutils literal notranslate"><span class="pre">extreme</span></code>.</p>
<p><em>Example Code</em>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="n">__attribute</span><span class="p">((</span><span class="n">model</span><span class="p">(</span><span class="s">&quot;extreme&quot;</span><span class="p">)));</span>
</pre></div>
</div>
</li>
<li><p>Default to <code class="docutils literal notranslate"><span class="pre">-fno-direct-access-external-data</span></code> for non-PIC.</p></li>
<li><p>An ABI mismatch with gcc/g++ about empty structs/unions passing was fixed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_mcount</span></code> was generated instead of <code class="docutils literal notranslate"><span class="pre">mcount</span></code>.</p></li>
</ul>
</section>
<section id="risc-v-support">
<h4>RISC-V Support<a class="headerlink" href="#risc-v-support" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Unaligned memory accesses can be toggled by <code class="docutils literal notranslate"><span class="pre">-m[no-]unaligned-access</span></code> or the
aliases <code class="docutils literal notranslate"><span class="pre">-m[no-]strict-align</span></code>.</p></li>
<li><p>CodeGen of RV32E/RV64E was supported experimentally.</p></li>
<li><p>CodeGen of ilp32e/lp64e was supported experimentally.</p></li>
<li><p>Default ABI with F but without D was changed to ilp32f for RV32 and to lp64f
for RV64.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__attribute__((rvv_vector_bits(N)))</span></code> is now supported for RVV vbool*_t types.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-mtls-dialect=desc</span></code> is now supported to enable TLS descriptors (TLSDESC).</p></li>
</ul>
</section>
<section id="cuda-hip-language-changes">
<h4>CUDA/HIP Language Changes<a class="headerlink" href="#cuda-hip-language-changes" title="連結到這個標頭">¶</a></h4>
</section>
<section id="cuda-support">
<h4>CUDA Support<a class="headerlink" href="#cuda-support" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Clang now supports CUDA SDK up to 12.3</p></li>
<li><p>Added support for sm_90a</p></li>
</ul>
</section>
<section id="powerpc-support">
<h4>PowerPC Support<a class="headerlink" href="#powerpc-support" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Added <code class="docutils literal notranslate"><span class="pre">nmmintrin.h</span></code> to intrinsics headers.</p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">__builtin_ppc_fence</span></code> as barrier of code motion, and
<code class="docutils literal notranslate"><span class="pre">__builtin_ppc_mffsl</span></code> for corresponding instruction.</p></li>
<li><p>Supported <code class="docutils literal notranslate"><span class="pre">__attribute__((target(&quot;tune=cpu&quot;)))</span></code>.</p></li>
<li><p>Emit <code class="docutils literal notranslate"><span class="pre">float-abi</span></code> module flag on 64-bit ELFv2 PowerPC targets if
<code class="docutils literal notranslate"><span class="pre">long</span> <span class="pre">double</span></code> type is used in current module.</p></li>
</ul>
</section>
<section id="aix-support">
<h4>AIX Support<a class="headerlink" href="#aix-support" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Introduced the <code class="docutils literal notranslate"><span class="pre">-maix-small-local-exec-tls</span></code> option to produce a faster
access sequence for local-exec TLS variables where the offset from the TLS
base is encoded as an immediate operand.
This access sequence is not used for TLS variables larger than 32KB, and is
currently only supported on 64-bit mode.</p></li>
<li><p>Inline assembler supports VSR register in pure digits.</p></li>
<li><p>Enabled ThinLTO support. Requires AIX 7.2 TL5 SP7 or newer, or AIX 7.3 TL2
or newer. Similar to the LTO support on AIX, ThinLTO is implemented with
the libLTO.so plugin.</p></li>
</ul>
</section>
<section id="systemz-support">
<h4>SystemZ Support<a class="headerlink" href="#systemz-support" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Properly support 16 byte atomic int/fp types and ops. Atomic __int128 (and
long double) variables are now aligned to 16 bytes by default (like gcc 14).</p></li>
</ul>
</section>
<section id="webassembly-support">
<h4>WebAssembly Support<a class="headerlink" href="#webassembly-support" title="連結到這個標頭">¶</a></h4>
</section>
<section id="avr-support">
<h4>AVR Support<a class="headerlink" href="#avr-support" title="連結到這個標頭">¶</a></h4>
</section>
</section>
<section id="dwarf-support-in-clang">
<h3><a class="toc-backref" href="#id224" role="doc-backlink">DWARF Support in Clang</a><a class="headerlink" href="#dwarf-support-in-clang" title="連結到這個標頭">¶</a></h3>
</section>
<section id="floating-point-support-in-clang">
<h3><a class="toc-backref" href="#id225" role="doc-backlink">Floating Point Support in Clang</a><a class="headerlink" href="#floating-point-support-in-clang" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>Add <code class="docutils literal notranslate"><span class="pre">__builtin_elementwise_log</span></code> builtin for floating point types only.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">__builtin_elementwise_log10</span></code> builtin for floating point types only.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">__builtin_elementwise_log2</span></code> builtin for floating point types only.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">__builtin_elementwise_exp</span></code> builtin for floating point types only.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">__builtin_elementwise_exp2</span></code> builtin for floating point types only.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">__builtin_set_flt_rounds</span></code> builtin for X86, x86_64, Arm and AArch64 only.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">__builtin_elementwise_pow</span></code> builtin for floating point types only.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">__builtin_elementwise_bitreverse</span></code> builtin for integer types only.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">__builtin_elementwise_sqrt</span></code> builtin for floating point types only.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__builtin_isfpclass</span></code> builtin now supports vector types.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#pragma</span> <span class="pre">float_control(precise,on)</span></code> enables precise floating-point
semantics. If <code class="docutils literal notranslate"><span class="pre">math-errno</span></code> is disabled in the current TU, clang will
re-enable <code class="docutils literal notranslate"><span class="pre">math-errno</span></code> in the presense of
<code class="docutils literal notranslate"><span class="pre">#pragma</span> <span class="pre">float_control(precise,on)</span></code>.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">__builtin_exp10</span></code>, <code class="docutils literal notranslate"><span class="pre">__builtin_exp10f</span></code>,
<code class="docutils literal notranslate"><span class="pre">__builtin_exp10f16</span></code>, <code class="docutils literal notranslate"><span class="pre">__builtin_exp10l</span></code> and
<code class="docutils literal notranslate"><span class="pre">__builtin_exp10f128</span></code> builtins.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">__builtin_iszero</span></code>, <code class="docutils literal notranslate"><span class="pre">__builtin_issignaling</span></code> and
<code class="docutils literal notranslate"><span class="pre">__builtin_issubnormal</span></code>.</p></li>
<li><p>Add support for C99's <code class="docutils literal notranslate"><span class="pre">#pragma</span> <span class="pre">STDC</span> <span class="pre">CX_LIMITED_RANGE</span></code> feature.  This
enables the naive mathematical formulas for complex multiplication and
division, which are faster but do not correctly handle overflow and infinities.</p></li>
</ul>
</section>
<section id="ast-matchers">
<h3><a class="toc-backref" href="#id226" role="doc-backlink">AST Matchers</a><a class="headerlink" href="#ast-matchers" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>Add <code class="docutils literal notranslate"><span class="pre">convertVectorExpr</span></code>.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">dependentSizedExtVectorType</span></code>.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">macroQualifiedType</span></code>.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">CXXFoldExpr</span></code> related matchers: <code class="docutils literal notranslate"><span class="pre">cxxFoldExpr</span></code>, <code class="docutils literal notranslate"><span class="pre">callee</span></code>,
<code class="docutils literal notranslate"><span class="pre">hasInit</span></code>, <code class="docutils literal notranslate"><span class="pre">hasPattern</span></code>, <code class="docutils literal notranslate"><span class="pre">isRightFold</span></code>, <code class="docutils literal notranslate"><span class="pre">isLeftFold</span></code>,
<code class="docutils literal notranslate"><span class="pre">isUnaryFold</span></code>, <code class="docutils literal notranslate"><span class="pre">isBinaryFold</span></code>, <code class="docutils literal notranslate"><span class="pre">hasOperator</span></code>, <code class="docutils literal notranslate"><span class="pre">hasLHS</span></code>, <code class="docutils literal notranslate"><span class="pre">hasRHS</span></code>, <code class="docutils literal notranslate"><span class="pre">hasEitherOperand</span></code>.</p></li>
</ul>
</section>
<section id="clang-format">
<h3><a class="toc-backref" href="#id227" role="doc-backlink">clang-format</a><a class="headerlink" href="#clang-format" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>Add <code class="docutils literal notranslate"><span class="pre">AllowBreakBeforeNoexceptSpecifier</span></code> option.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">AllowShortCompoundRequirementOnASingleLine</span></code> option.</p></li>
<li><p>Change <code class="docutils literal notranslate"><span class="pre">BreakAfterAttributes</span></code> from <code class="docutils literal notranslate"><span class="pre">Never</span></code> to <code class="docutils literal notranslate"><span class="pre">Leave</span></code> in LLVM style.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">BreakAdjacentStringLiterals</span></code> option.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">ObjCPropertyAttributeOrder</span></code> which can be used to sort ObjC property
attributes (like <code class="docutils literal notranslate"><span class="pre">nonatomic,</span> <span class="pre">strong,</span> <span class="pre">nullable</span></code>).</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">PenaltyBreakScopeResolution</span></code> option.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">.clang-format-ignore</span></code> files.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">AlignFunctionPointers</span></code> sub-option for <code class="docutils literal notranslate"><span class="pre">AlignConsecutiveDeclarations</span></code>.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">SkipMacroDefinitionBody</span></code> option.</p></li>
</ul>
</section>
<section id="libclang">
<h3><a class="toc-backref" href="#id228" role="doc-backlink">libclang</a><a class="headerlink" href="#libclang" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>Exposed arguments of <code class="docutils literal notranslate"><span class="pre">clang::annotate</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">clang::getCursorKindForDecl</span></code> now recognizes linkage specifications such as
<code class="docutils literal notranslate"><span class="pre">extern</span> <span class="pre">&quot;C&quot;</span></code> and reports them as <code class="docutils literal notranslate"><span class="pre">CXCursor_LinkageSpec</span></code>.</p></li>
<li><p>Changed the libclang library on AIX to export only the necessary symbols to
prevent issues of resolving to the wrong duplicate symbol.</p></li>
</ul>
</section>
<section id="static-analyzer">
<h3><a class="toc-backref" href="#id229" role="doc-backlink">Static Analyzer</a><a class="headerlink" href="#static-analyzer" title="連結到這個標頭">¶</a></h3>
<section id="new-features">
<h4>New features<a class="headerlink" href="#new-features" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Implemented the <code class="docutils literal notranslate"><span class="pre">[[clang::suppress]]</span></code> attribute for suppressing diagnostics
of static analysis tools, such as the Clang Static Analyzer.
<a class="reference external" href="https://clang.llvm.org/docs/AttributeReference.html#suppress">Documentation</a>.</p></li>
<li><p>Support &quot;Deducing this&quot; (P0847R7). (Worked out of the box)
(<a class="reference external" href="https://github.com/llvm/llvm-project/commit/af4751738db89a142a8880c782d12d4201b222a8">af4751738db8</a>)</p></li>
<li><p>Added a new checker <code class="docutils literal notranslate"><span class="pre">core.BitwiseShift</span></code> which reports situations where
bitwise shift operators produce undefined behavior (because some operand is
negative or too large).
<a class="reference external" href="https://clang.llvm.org/docs/analyzer/checkers.html#core-bitwiseshift-c-c">Documentation</a>.</p></li>
<li><p>Added a new experimental checker <code class="docutils literal notranslate"><span class="pre">alpha.core.StdVariant</span></code> to detect variant
accesses via wrong alternatives.
<a class="reference external" href="https://clang.llvm.org/docs/analyzer/checkers.html#alpha-core-stdvariant-c">Documentation</a>.
(<a class="reference external" href="https://github.com/llvm/llvm-project/pull/66481">#66481</a>)</p></li>
<li><p>Added a new experimental checker <code class="docutils literal notranslate"><span class="pre">alpha.cplusplus.ArrayDelete</span></code> to detect
destructions of arrays of polymorphic objects that are destructed as their
base class (<a class="reference external" href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/EXP51-CPP.+Do+not+delete+an+array+through+a+pointer+of+the+incorrect+type">CERT EXP51-CPP</a>).
<a class="reference external" href="https://clang.llvm.org/docs/analyzer/checkers.html#alpha-cplusplus-arraydelete-c">Documentation</a>.
(<a class="reference external" href="https://github.com/llvm/llvm-project/commit/0e246bb67573799409d0085b89902a330998ddcc">0e246bb67573</a>)</p></li>
<li><p>Added a new checker configuration option <code class="docutils literal notranslate"><span class="pre">InvalidatingGetEnv=[true,false]</span></code> to
<code class="docutils literal notranslate"><span class="pre">security.cert.env.InvalidPtr</span></code>. It's not set by default.
If set, <code class="docutils literal notranslate"><span class="pre">getenv</span></code> calls won't invalidate previously returned pointers.
<a class="reference external" href="https://clang.llvm.org/docs/analyzer/checkers.html#security-cert-env-invalidptr">Documentation</a>.
(<a class="reference external" href="https://github.com/llvm/llvm-project/pull/67663">#67663</a>)</p></li>
</ul>
</section>
<section id="crash-and-bug-fixes">
<h4>Crash and bug fixes<a class="headerlink" href="#crash-and-bug-fixes" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Fixed a crash caused by <code class="docutils literal notranslate"><span class="pre">builtin_bit_cast</span></code>.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/69922">#69922</a>)</p></li>
<li><p>Fixed a <code class="docutils literal notranslate"><span class="pre">core.StackAddressEscape</span></code> crash on temporary object fields.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/66221">#66221</a>)</p></li>
<li><p>A few crashes have been found and fixed using randomized testing related
to the use of <code class="docutils literal notranslate"><span class="pre">_BitInt()</span></code> in tidy checks and in clang analysis.
(<a class="reference external" href="https://github.com/llvm/llvm-project/pull/67212">#67212</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/66782">#66782</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/65889">#65889</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/65888">#65888</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/65887">#65887</a>)</p></li>
<li><p>Fixed note links of the HTML output.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/64054">#64054</a>)</p></li>
<li><p>Allow widening rage-based for loops.
(<a class="reference external" href="https://github.com/llvm/llvm-project/pull/70190">#70190</a>)</p></li>
<li><p>Fixed uninitialized base class with initializer list when ctor is not
declared in the base class.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/70464">#70464</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/issues/59493">#59493</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/issues/54533">#54533</a>)</p></li>
<li><p>Fixed an <code class="docutils literal notranslate"><span class="pre">alpha.unix.cstring</span></code> crash on variadic functions.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/74269">#74269</a>)</p></li>
<li><p>Fix false positive in mutation check when using pointer to member function.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/66204">#66204</a>)</p></li>
<li><p>Fixed a crash in <code class="docutils literal notranslate"><span class="pre">security.cert.env.InvalidPtr</span></code> checker when accidentally
matched user-defined <code class="docutils literal notranslate"><span class="pre">strerror</span></code> and similar library functions.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/88181">#88181</a>)</p></li>
</ul>
</section>
<section id="improvements">
<h4>Improvements<a class="headerlink" href="#improvements" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Improved the <code class="docutils literal notranslate"><span class="pre">unix.StdCLibraryFunctions</span></code> checker by modeling more
functions like <code class="docutils literal notranslate"><span class="pre">send</span></code>, <code class="docutils literal notranslate"><span class="pre">recv</span></code>, <code class="docutils literal notranslate"><span class="pre">readlink</span></code>, <code class="docutils literal notranslate"><span class="pre">fflush</span></code>, <code class="docutils literal notranslate"><span class="pre">mkdtemp</span></code>,
<code class="docutils literal notranslate"><span class="pre">getcwd</span></code> and <code class="docutils literal notranslate"><span class="pre">errno</span></code> behavior.
(<a class="reference external" href="https://github.com/llvm/llvm-project/commit/52ac71f92d38f75df5cb88e9c090ac5fd5a71548">52ac71f92d38</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/77040">#77040</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/76671">#76671</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/71373">#71373</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/76557">#76557</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/71392">#71392</a>)</p></li>
<li><p>Fixed a false negative for when accessing a nonnull property (ObjC).
(<a class="reference external" href="https://github.com/llvm/llvm-project/commit/1dceba3a3684d12394731e09a6cf3efcebf07a3a">1dceba3a3684</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">security.insecureAPI.DeprecatedOrUnsafeBufferHandling</span></code> now considers
<code class="docutils literal notranslate"><span class="pre">fprintf</span></code> calls unsafe.
<a class="reference external" href="https://clang.llvm.org/docs/analyzer/checkers.html#security-insecureapi-deprecatedorunsafebufferhandling-c">Documentation</a>.</p></li>
<li><p>Improved the diagnostics of the <code class="docutils literal notranslate"><span class="pre">optin.core.EnumCastOutOfRange</span></code> checker.
It will display the name and the declaration of the enumeration along with
the concrete value being cast to the enum.
(<a class="reference external" href="https://github.com/llvm/llvm-project/pull/74503">#74503</a>)</p></li>
<li><p>Improved the <code class="docutils literal notranslate"><span class="pre">alpha.security.ArrayBoundV2</span></code> checker for detecting buffer
accesses prior the buffer; and also reworked the diagnostic messages.
(<a class="reference external" href="https://github.com/llvm/llvm-project/commit/3e014038b373e5a4a96d89d46cea17e4d2456a04">3e014038b373</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/70056">#70056</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/72107">#72107</a>)</p></li>
<li><p>Improved the <code class="docutils literal notranslate"><span class="pre">alpha.unix.cstring.OutOfBounds</span></code> checking both ends of the
buffers in more cases.
(<a class="reference external" href="https://github.com/llvm/llvm-project/commit/c3a87ddad62a6cc01acaccc76592bc6730c8ac3c">c3a87ddad62a</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/commit/0954dc3fb9214b994623f5306473de075f8e3593">0954dc3fb921</a>)</p></li>
<li><p>Improved the <code class="docutils literal notranslate"><span class="pre">alpha.unix.Stream</span></code> checker by modeling more functions
<code class="docutils literal notranslate"><span class="pre">fputs</span></code>, <code class="docutils literal notranslate"><span class="pre">fputc</span></code>, <code class="docutils literal notranslate"><span class="pre">fgets</span></code>, <code class="docutils literal notranslate"><span class="pre">fgetc</span></code>, <code class="docutils literal notranslate"><span class="pre">fdopen</span></code>, <code class="docutils literal notranslate"><span class="pre">ungetc</span></code>, <code class="docutils literal notranslate"><span class="pre">fflush</span></code>,
<code class="docutils literal notranslate"><span class="pre">getdelim</span></code>, <code class="docutils literal notranslate"><span class="pre">getline</span></code> and no not recognize alternative
<code class="docutils literal notranslate"><span class="pre">fopen</span></code> and <code class="docutils literal notranslate"><span class="pre">tmpfile</span></code> implementations.
(<a class="reference external" href="https://github.com/llvm/llvm-project/pull/78693">#78693</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/76776">#76776</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/74296">#74296</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/73335">#73335</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/72627">#72627</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/71518">#71518</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/72016">#72016</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/70540">#70540</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/73638">#73638</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/77331">#77331</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">alpha.security.taint.TaintPropagation</span></code> checker no longer propagates
taint on <code class="docutils literal notranslate"><span class="pre">strlen</span></code> and <code class="docutils literal notranslate"><span class="pre">strnlen</span></code> calls, unless these are marked
explicitly propagators in the user-provided taint configuration file.
This removal empirically reduces the number of false positive reports.
Read the PR for the details.
(<a class="reference external" href="https://github.com/llvm/llvm-project/pull/66086">#66086</a>)</p></li>
<li><p>Other taint-related improvements.
(<a class="reference external" href="https://github.com/llvm/llvm-project/pull/66358">#66358</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/66074">#66074</a>,
<a class="reference external" href="https://github.com/llvm/llvm-project/pull/66358">#66358</a>)</p></li>
<li><p>Checkers can query constraint bounds to improve diagnostic messages.
(<a class="reference external" href="https://github.com/llvm/llvm-project/pull/74141">#74141</a>)</p></li>
<li><p>Improved the generated initializers for modules. Now the calls to initialize
functions from imported module units can be omitted if the initialize
function is known to be empty.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/56794">#56794</a>)</p></li>
<li><p>Clang now allow to export declarations within linkage-specification.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/71347">#71347</a>)</p></li>
</ul>
</section>
<section id="moved-checkers">
<h4>Moved checkers<a class="headerlink" href="#moved-checkers" title="連結到這個標頭">¶</a></h4>
<ul class="simple">
<li><p>Move checker <code class="docutils literal notranslate"><span class="pre">alpha.unix.Errno</span></code> out of the <code class="docutils literal notranslate"><span class="pre">alpha</span></code> package
to <code class="docutils literal notranslate"><span class="pre">unix.Errno</span></code>.
<a class="reference external" href="https://clang.llvm.org/docs/analyzer/checkers.html#unix-errno-c">Documentation</a>.</p></li>
<li><p>Move checker <code class="docutils literal notranslate"><span class="pre">alpha.unix.StdCLibraryFunctions</span></code> out of the <code class="docutils literal notranslate"><span class="pre">alpha</span></code> package
to <code class="docutils literal notranslate"><span class="pre">unix.StdCLibraryFunctions</span></code>.
<a class="reference external" href="https://clang.llvm.org/docs/analyzer/checkers.html#unix-stdclibraryfunctions-c">Documentation</a>.</p></li>
<li><p>Move checker <code class="docutils literal notranslate"><span class="pre">alpha.security.cert.env.InvalidPtr</span></code> out of the <code class="docutils literal notranslate"><span class="pre">alpha</span></code>
package to <code class="docutils literal notranslate"><span class="pre">security.cert.env.InvalidPtr</span></code>.
<a class="reference external" href="https://clang.llvm.org/docs/analyzer/checkers.html#security-cert-env-invalidptr">Documentation</a>.</p></li>
<li><p>Move checker <code class="docutils literal notranslate"><span class="pre">alpha.cplusplus.EnumCastOutOfRange</span></code> out of the <code class="docutils literal notranslate"><span class="pre">alpha</span></code>
package to <code class="docutils literal notranslate"><span class="pre">optin.core.EnumCastOutOfRange</span></code>.
<a class="reference external" href="https://clang.llvm.org/docs/analyzer/checkers.html#optin-core-enumcastoutofrange-c-c">Documentation</a>.</p></li>
</ul>
</section>
</section>
<section id="sanitizers">
<span id="release-notes-sanitizers"></span><h3><a class="toc-backref" href="#id230" role="doc-backlink">Sanitizers</a><a class="headerlink" href="#sanitizers" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-fsanitize=signed-integer-overflow</span></code> now instruments <code class="docutils literal notranslate"><span class="pre">__builtin_abs</span></code> and
<code class="docutils literal notranslate"><span class="pre">abs</span></code> builtins.</p></li>
</ul>
</section>
<section id="python-binding-changes">
<h3><a class="toc-backref" href="#id231" role="doc-backlink">Python Binding Changes</a><a class="headerlink" href="#python-binding-changes" title="連結到這個標頭">¶</a></h3>
</section>
</section>
<section id="additional-information">
<h2><a class="toc-backref" href="#id232" role="doc-backlink">Additional Information</a><a class="headerlink" href="#additional-information" title="連結到這個標頭">¶</a></h2>
<p>A wide variety of additional information is available on the <a class="reference external" href="https://clang.llvm.org/">Clang web
page</a>. The web page contains versions of the
API documentation which are up-to-date with the Git version of
the source code. You can access versions of these documents specific to
this release by going into the &quot;<code class="docutils literal notranslate"><span class="pre">clang/docs/</span></code>&quot; directory in the Clang
tree.</p>
<p>If you have any questions or comments about Clang, please feel free to
contact us on the <a class="reference external" href="https://discourse.llvm.org/c/clang/6">Discourse forums (Clang Frontend category)</a>.</p>
</section>
</section>


      </div>
      <div class="bottomnav" role="navigation" aria-label="Bottom">
      
        <p>
        «&#160;&#160;<a href="index.html">Using Clang as a Compiler</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">內容</a>
        &#160;&#160;::&#160;&#160;
        <a href="UsersManual.html">Clang Compiler User's Manual</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
    &#169; 版權所有 2007-2025, The Clang Team.
      使用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3 建立。
    </div>
  </body>
</html>