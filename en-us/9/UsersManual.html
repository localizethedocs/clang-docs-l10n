<!DOCTYPE html>

<html lang="en-US" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Clang Compiler User’s Manual &#8212; Clang 9 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="_static/haiku.css?v=fce32b03" />
    <script src="_static/documentation_options.js?v=5fdf2b4a"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="canonical" href="https://projects.localizethedocs.org/clang-docs-l10n/UsersManual.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Assembling a Complete Toolchain" href="Toolchain.html" />
    <link rel="prev" title="Clang 9.0.0 Release Notes" href="ReleaseNotes.html" />
<script type="text/javascript" src="ltd-provenance.js"></script>
<script type="text/javascript" src="ltd-current.js"></script>
<script type="text/javascript" src="../../ltd-config.js"></script>
<script type="text/javascript" src="../../ltd-flyout.js"></script>

  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>Clang 9 documentation</span></a></h1>
        <h2 class="heading"><span>Clang Compiler User’s Manual</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="Top">
      
        <p>
        «&#160;&#160;<a href="ReleaseNotes.html">Clang 9.0.0 Release Notes</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="Toolchain.html">Assembling a Complete Toolchain</a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <section id="clang-compiler-user-s-manual">
<h1>Clang Compiler User’s Manual<a class="headerlink" href="#clang-compiler-user-s-manual" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id10">Introduction</a></p>
<ul>
<li><p><a class="reference internal" href="#terminology" id="id11">Terminology</a></p></li>
<li><p><a class="reference internal" href="#basic-usage" id="id12">Basic Usage</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#command-line-options" id="id13">Command Line Options</a></p>
<ul>
<li><p><a class="reference internal" href="#options-to-control-error-and-warning-messages" id="id14">Options to Control Error and Warning Messages</a></p>
<ul>
<li><p><a class="reference internal" href="#formatting-of-diagnostics" id="id15">Formatting of Diagnostics</a></p></li>
<li><p><a class="reference internal" href="#individual-warning-groups" id="id16">Individual Warning Groups</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#options-to-control-clang-crash-diagnostics" id="id17">Options to Control Clang Crash Diagnostics</a></p></li>
<li><p><a class="reference internal" href="#options-to-emit-optimization-reports" id="id18">Options to Emit Optimization Reports</a></p>
<ul>
<li><p><a class="reference internal" href="#current-limitations" id="id19">Current limitations</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#other-options" id="id20">Other Options</a></p></li>
<li><p><a class="reference internal" href="#configuration-files" id="id21">Configuration files</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#language-and-target-independent-features" id="id22">Language and Target-Independent Features</a></p>
<ul>
<li><p><a class="reference internal" href="#controlling-errors-and-warnings" id="id23">Controlling Errors and Warnings</a></p>
<ul>
<li><p><a class="reference internal" href="#controlling-how-clang-displays-diagnostics" id="id24">Controlling How Clang Displays Diagnostics</a></p></li>
<li><p><a class="reference internal" href="#diagnostic-mappings" id="id25">Diagnostic Mappings</a></p></li>
<li><p><a class="reference internal" href="#diagnostic-categories" id="id26">Diagnostic Categories</a></p></li>
<li><p><a class="reference internal" href="#controlling-diagnostics-via-command-line-flags" id="id27">Controlling Diagnostics via Command Line Flags</a></p></li>
<li><p><a class="reference internal" href="#controlling-diagnostics-via-pragmas" id="id28">Controlling Diagnostics via Pragmas</a></p></li>
<li><p><a class="reference internal" href="#controlling-diagnostics-in-system-headers" id="id29">Controlling Diagnostics in System Headers</a></p></li>
<li><p><a class="reference internal" href="#enabling-all-diagnostics" id="id30">Enabling All Diagnostics</a></p></li>
<li><p><a class="reference internal" href="#controlling-static-analyzer-diagnostics" id="id31">Controlling Static Analyzer Diagnostics</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#precompiled-headers" id="id32">Precompiled Headers</a></p>
<ul>
<li><p><a class="reference internal" href="#generating-a-pch-file" id="id33">Generating a PCH File</a></p></li>
<li><p><a class="reference internal" href="#using-a-pch-file" id="id34">Using a PCH File</a></p></li>
<li><p><a class="reference internal" href="#relocatable-pch-files" id="id35">Relocatable PCH Files</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#controlling-code-generation" id="id36">Controlling Code Generation</a></p></li>
<li><p><a class="reference internal" href="#profile-guided-optimization" id="id37">Profile Guided Optimization</a></p>
<ul>
<li><p><a class="reference internal" href="#differences-between-sampling-and-instrumentation" id="id38">Differences Between Sampling and Instrumentation</a></p></li>
<li><p><a class="reference internal" href="#using-sampling-profilers" id="id39">Using Sampling Profilers</a></p>
<ul>
<li><p><a class="reference internal" href="#sample-profile-formats" id="id40">Sample Profile Formats</a></p></li>
<li><p><a class="reference internal" href="#sample-profile-text-format" id="id41">Sample Profile Text Format</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#profiling-with-instrumentation" id="id42">Profiling with Instrumentation</a></p></li>
<li><p><a class="reference internal" href="#disabling-instrumentation" id="id43">Disabling Instrumentation</a></p></li>
<li><p><a class="reference internal" href="#profile-remapping" id="id44">Profile remapping</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#gcov-based-profiling" id="id45">GCOV-based Profiling</a></p></li>
<li><p><a class="reference internal" href="#controlling-debug-information" id="id46">Controlling Debug Information</a></p>
<ul>
<li><p><a class="reference internal" href="#controlling-size-of-debug-information" id="id47">Controlling Size of Debug Information</a></p></li>
<li><p><a class="reference internal" href="#controlling-macro-debug-info-generation" id="id48">Controlling Macro Debug Info Generation</a></p></li>
<li><p><a class="reference internal" href="#controlling-debugger-tuning" id="id49">Controlling Debugger “Tuning”</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#controlling-llvm-ir-output" id="id50">Controlling LLVM IR Output</a></p>
<ul>
<li><p><a class="reference internal" href="#controlling-value-names-in-llvm-ir" id="id51">Controlling Value Names in LLVM IR</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#comment-parsing-options" id="id52">Comment Parsing Options</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#c-language-features" id="id53">C Language Features</a></p>
<ul>
<li><p><a class="reference internal" href="#extensions-supported-by-clang" id="id54">Extensions supported by clang</a></p></li>
<li><p><a class="reference internal" href="#differences-between-various-standard-modes" id="id55">Differences between various standard modes</a></p></li>
<li><p><a class="reference internal" href="#gcc-extensions-not-implemented-yet" id="id56">GCC extensions not implemented yet</a></p></li>
<li><p><a class="reference internal" href="#intentionally-unsupported-gcc-extensions" id="id57">Intentionally unsupported GCC extensions</a></p></li>
<li><p><a class="reference internal" href="#microsoft-extensions" id="id58">Microsoft extensions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#cxx" id="id59">C++ Language Features</a></p>
<ul>
<li><p><a class="reference internal" href="#controlling-implementation-limits" id="id60">Controlling implementation limits</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#objective-c-language-features" id="id61">Objective-C Language Features</a></p></li>
<li><p><a class="reference internal" href="#objcxx" id="id62">Objective-C++ Language Features</a></p></li>
<li><p><a class="reference internal" href="#openmp-features" id="id63">OpenMP Features</a></p>
<ul>
<li><p><a class="reference internal" href="#id6" id="id64">Controlling implementation limits</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#opencl-features" id="id65">OpenCL Features</a></p>
<ul>
<li><p><a class="reference internal" href="#opencl-specific-options" id="id66">OpenCL Specific Options</a></p></li>
<li><p><a class="reference internal" href="#opencl-targets" id="id67">OpenCL Targets</a></p>
<ul>
<li><p><a class="reference internal" href="#specific-targets" id="id68">Specific Targets</a></p></li>
<li><p><a class="reference internal" href="#generic-targets" id="id69">Generic Targets</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#opencl-header" id="id70">OpenCL Header</a></p></li>
<li><p><a class="reference internal" href="#opencl-extensions" id="id71">OpenCL Extensions</a></p></li>
<li><p><a class="reference internal" href="#opencl-metadata" id="id72">OpenCL Metadata</a></p></li>
<li><p><a class="reference internal" href="#opencl-specific-attributes" id="id73">OpenCL-Specific Attributes</a></p>
<ul>
<li><p><a class="reference internal" href="#nosvm" id="id74">nosvm</a></p></li>
<li><p><a class="reference internal" href="#opencl-unroll-hint" id="id75">opencl_unroll_hint</a></p></li>
<li><p><a class="reference internal" href="#convergent" id="id76">convergent</a></p></li>
<li><p><a class="reference internal" href="#noduplicate" id="id77">noduplicate</a></p></li>
<li><p><a class="reference internal" href="#address-space" id="id78">address_space</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#opencl-builtins" id="id79">OpenCL builtins</a></p></li>
<li><p><a class="reference internal" href="#c-for-opencl" id="id80">C++ for OpenCL</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#target-specific-features-and-limitations" id="id81">Target-Specific Features and Limitations</a></p>
<ul>
<li><p><a class="reference internal" href="#cpu-architectures-features-and-limitations" id="id82">CPU Architectures Features and Limitations</a></p>
<ul>
<li><p><a class="reference internal" href="#x86" id="id83">X86</a></p></li>
<li><p><a class="reference internal" href="#arm" id="id84">ARM</a></p></li>
<li><p><a class="reference internal" href="#powerpc" id="id85">PowerPC</a></p></li>
<li><p><a class="reference internal" href="#other-platforms" id="id86">Other platforms</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#operating-system-features-and-limitations" id="id87">Operating System Features and Limitations</a></p>
<ul>
<li><p><a class="reference internal" href="#darwin-macos" id="id88">Darwin (macOS)</a></p></li>
<li><p><a class="reference internal" href="#windows" id="id89">Windows</a></p>
<ul>
<li><p><a class="reference internal" href="#cygwin" id="id90">Cygwin</a></p></li>
<li><p><a class="reference internal" href="#mingw32" id="id91">MinGW32</a></p></li>
<li><p><a class="reference internal" href="#mingw-w64" id="id92">MinGW-w64</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#clang-cl" id="id93">clang-cl</a></p>
<ul>
<li><p><a class="reference internal" href="#id9" id="id94">Command-Line Options</a></p>
<ul>
<li><p><a class="reference internal" href="#the-clang-option" id="id95">The /clang: Option</a></p></li>
<li><p><a class="reference internal" href="#the-zc-dllexportinlines-option" id="id96">The /Zc:dllexportInlines- Option</a></p></li>
<li><p><a class="reference internal" href="#the-fallback-option" id="id97">The /fallback Option</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>The Clang Compiler is an open-source compiler for the C family of
programming languages, aiming to be the best in class implementation of
these languages. Clang builds on the LLVM optimizer and code generator,
allowing it to provide high-quality optimization and code generation
support for many targets. For more general information, please see the
<a class="reference external" href="https://clang.llvm.org">Clang Web Site</a> or the <a class="reference external" href="https://llvm.org">LLVM Web
Site</a>.</p>
<p>This document describes important notes about using Clang as a compiler
for an end-user, documenting the supported features, command line
options, etc. If you are interested in using Clang to build a tool that
processes code, please see <a class="reference internal" href="InternalsManual.html"><span class="doc">“Clang” CFE Internals Manual</span></a>. If you are interested in the
<a class="reference external" href="https://clang-analyzer.llvm.org">Clang Static Analyzer</a>, please see its web
page.</p>
<p>Clang is one component in a complete toolchain for C family languages.
A separate document describes the other pieces necessary to
<a class="reference internal" href="Toolchain.html"><span class="doc">assemble a complete toolchain</span></a>.</p>
<p>Clang is designed to support the C family of programming languages,
which includes <a class="reference internal" href="#c"><span class="std std-ref">C</span></a>, <a class="reference internal" href="#objc"><span class="std std-ref">Objective-C</span></a>, <a class="reference internal" href="#cxx"><span class="std std-ref">C++</span></a>, and
<a class="reference internal" href="#objcxx"><span class="std std-ref">Objective-C++</span></a> as well as many dialects of those. For
language-specific information, please see the corresponding language
specific section:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c"><span class="std std-ref">C Language</span></a>: K&amp;R C, ANSI C89, ISO C90, ISO C94 (C89+AMD1), ISO
C99 (+TC1, TC2, TC3).</p></li>
<li><p><a class="reference internal" href="#objc"><span class="std std-ref">Objective-C Language</span></a>: ObjC 1, ObjC 2, ObjC 2.1, plus
variants depending on base language.</p></li>
<li><p><a class="reference internal" href="#cxx"><span class="std std-ref">C++ Language</span></a></p></li>
<li><p><a class="reference internal" href="#objcxx"><span class="std std-ref">Objective C++ Language</span></a></p></li>
<li><p><a class="reference internal" href="#opencl"><span class="std std-ref">OpenCL C Language</span></a>: v1.0, v1.1, v1.2, v2.0.</p></li>
</ul>
<p>In addition to these base languages and their dialects, Clang supports a
broad variety of language extensions, which are documented in the
corresponding language section. These extensions are provided to be
compatible with the GCC, Microsoft, and other popular compilers as well
as to improve functionality through Clang-specific features. The Clang
driver and language features are intentionally designed to be as
compatible with the GNU GCC compiler as reasonably possible, easing
migration from GCC to Clang. In most cases, code “just works”.
Clang also provides an alternative driver, <a class="reference internal" href="#clang-cl"><span class="std std-ref">clang-cl</span></a>, that is designed
to be compatible with the Visual C++ compiler, cl.exe.</p>
<p>In addition to language specific features, Clang has a variety of
features that depend on what CPU architecture or operating system is
being compiled for. Please see the <a class="reference internal" href="#target-features"><span class="std std-ref">Target-Specific Features and
Limitations</span></a> section for more details.</p>
<p>The rest of the introduction introduces some basic <a class="reference internal" href="#terminology"><span class="std std-ref">compiler
terminology</span></a> that is used throughout this manual and
contains a basic <a class="reference internal" href="#basicusage"><span class="std std-ref">introduction to using Clang</span></a> as a
command line compiler.</p>
<section id="terminology">
<span id="id1"></span><h3><a class="toc-backref" href="#id11" role="doc-backlink">Terminology</a><a class="headerlink" href="#terminology" title="Link to this heading">¶</a></h3>
<p>Front end, parser, backend, preprocessor, undefined behavior,
diagnostic, optimizer</p>
</section>
<section id="basic-usage">
<span id="basicusage"></span><h3><a class="toc-backref" href="#id12" role="doc-backlink">Basic Usage</a><a class="headerlink" href="#basic-usage" title="Link to this heading">¶</a></h3>
<p>Intro to how to use a C compiler for newbies.</p>
<p>compile + link compile then link debug info enabling optimizations
picking a language to use, defaults to C11 by default. Autosenses based
on extension. using a makefile</p>
</section>
</section>
<section id="command-line-options">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Command Line Options</a><a class="headerlink" href="#command-line-options" title="Link to this heading">¶</a></h2>
<p>This section is generally an index into other sections. It does not go
into depth on the ones that are covered by other sections. However, the
first part introduces the language selection and other high level
options like <a class="reference internal" href="CommandGuide/clang.html#cmdoption-c"><code class="xref std std-option docutils literal notranslate"><span class="pre">-c</span></code></a>, <a class="reference internal" href="CommandGuide/clang.html#cmdoption-g"><code class="xref std std-option docutils literal notranslate"><span class="pre">-g</span></code></a>, etc.</p>
<section id="options-to-control-error-and-warning-messages">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">Options to Control Error and Warning Messages</a><a class="headerlink" href="#options-to-control-error-and-warning-messages" title="Link to this heading">¶</a></h3>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-Werror">
<span class="sig-name descname"><span class="pre">-Werror</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-Werror" title="Link to this definition">¶</a></dt>
<dd><p>Turn warnings into errors.</p>
</dd></dl>

<p><code class="docutils literal notranslate"><span class="pre">-Werror=foo</span></code></p>
<blockquote>
<div><p>Turn warning “foo” into an error.</p>
</div></blockquote>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-Wno-error">
<span class="sig-name descname"><span class="pre">-Wno-error</span></span><span class="sig-prename descclassname"><span class="pre">=foo</span></span><a class="headerlink" href="#cmdoption-Wno-error" title="Link to this definition">¶</a></dt>
<dd><p>Turn warning “foo” into a warning even if <a class="reference internal" href="#cmdoption-Werror"><code class="xref std std-option docutils literal notranslate"><span class="pre">-Werror</span></code></a> is specified.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-Wfoo">
<span class="sig-name descname"><span class="pre">-Wfoo</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-Wfoo" title="Link to this definition">¶</a></dt>
<dd><p>Enable warning “foo”.
See the <a class="reference internal" href="DiagnosticsReference.html"><span class="doc">diagnostics reference</span></a> for a complete
list of the warning flags that can be specified in this way.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-Wno-foo">
<span class="sig-name descname"><span class="pre">-Wno-foo</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-Wno-foo" title="Link to this definition">¶</a></dt>
<dd><p>Disable warning “foo”.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-w">
<span class="sig-name descname"><span class="pre">-w</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-w" title="Link to this definition">¶</a></dt>
<dd><p>Disable all diagnostics.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-Weverything">
<span class="sig-name descname"><span class="pre">-Weverything</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-Weverything" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#diagnostics-enable-everything"><span class="std std-ref">Enable all diagnostics.</span></a></p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pedantic">
<span class="sig-name descname"><span class="pre">-pedantic</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pedantic" title="Link to this definition">¶</a></dt>
<dd><p>Warn on language extensions.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pedantic-errors">
<span class="sig-name descname"><span class="pre">-pedantic-errors</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pedantic-errors" title="Link to this definition">¶</a></dt>
<dd><p>Error on language extensions.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-Wsystem-headers">
<span class="sig-name descname"><span class="pre">-Wsystem-headers</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-Wsystem-headers" title="Link to this definition">¶</a></dt>
<dd><p>Enable warnings from system headers.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-ferror-limit">
<span class="sig-name descname"><span class="pre">-ferror-limit</span></span><span class="sig-prename descclassname"><span class="pre">=123</span></span><a class="headerlink" href="#cmdoption-ferror-limit" title="Link to this definition">¶</a></dt>
<dd><p>Stop emitting diagnostics after 123 errors have been produced. The default is
20, and the error limit can be disabled with <cite>-ferror-limit=0</cite>.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-ftemplate-backtrace-limit">
<span class="sig-name descname"><span class="pre">-ftemplate-backtrace-limit</span></span><span class="sig-prename descclassname"><span class="pre">=123</span></span><a class="headerlink" href="#cmdoption-ftemplate-backtrace-limit" title="Link to this definition">¶</a></dt>
<dd><p>Only emit up to 123 template instantiation notes within the template
instantiation backtrace for a single warning or error. The default is 10, and
the limit can be disabled with <cite>-ftemplate-backtrace-limit=0</cite>.</p>
</dd></dl>

<section id="formatting-of-diagnostics">
<span id="cl-diag-formatting"></span><h4><a class="toc-backref" href="#id15" role="doc-backlink">Formatting of Diagnostics</a><a class="headerlink" href="#formatting-of-diagnostics" title="Link to this heading">¶</a></h4>
<p>Clang aims to produce beautiful diagnostics by default, particularly for
new users that first come to Clang. However, different people have
different preferences, and sometimes Clang is driven not by a human,
but by a program that wants consistent and easily parsable output. For
these cases, Clang provides a wide range of options to control the exact
output format of the diagnostics that it generates.</p>
<dl id="opt-fshow-column">
<dt><strong>-f[no-]show-column</strong></dt><dd><p>Print column number in diagnostic.</p>
<p>This option, which defaults to on, controls whether or not Clang
prints the column number of a diagnostic. For example, when this is
enabled, Clang will print something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span> <span class="n">warning</span><span class="p">:</span> <span class="n">extra</span> <span class="n">tokens</span> <span class="n">at</span> <span class="n">end</span> <span class="n">of</span> <span class="c1">#endif directive [-Wextra-tokens]</span>
<span class="c1">#endif bad</span>
       <span class="o">^</span>
       <span class="o">//</span>
</pre></div>
</div>
<p>When this is disabled, Clang will print “test.c:28: warning…” with
no column number.</p>
<p>The printed column numbers count bytes from the beginning of the
line; take care if your source contains multibyte characters.</p>
</dd>
</dl>
<dl id="opt-fshow-source-location">
<dt><strong>-f[no-]show-source-location</strong></dt><dd><p>Print source file/line/column information in diagnostic.</p>
<p>This option, which defaults to on, controls whether or not Clang
prints the filename, line number and column number of a diagnostic.
For example, when this is enabled, Clang will print something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span> <span class="n">warning</span><span class="p">:</span> <span class="n">extra</span> <span class="n">tokens</span> <span class="n">at</span> <span class="n">end</span> <span class="n">of</span> <span class="c1">#endif directive [-Wextra-tokens]</span>
<span class="c1">#endif bad</span>
       <span class="o">^</span>
       <span class="o">//</span>
</pre></div>
</div>
<p>When this is disabled, Clang will not print the “test.c:28:8: ”
part.</p>
</dd>
</dl>
<dl id="opt-fcaret-diagnostics">
<dt><strong>-f[no-]caret-diagnostics</strong></dt><dd><p>Print source line and ranges from source code in diagnostic.
This option, which defaults to on, controls whether or not Clang
prints the source line, source ranges, and caret when emitting a
diagnostic. For example, when this is enabled, Clang will print
something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span> <span class="n">warning</span><span class="p">:</span> <span class="n">extra</span> <span class="n">tokens</span> <span class="n">at</span> <span class="n">end</span> <span class="n">of</span> <span class="c1">#endif directive [-Wextra-tokens]</span>
<span class="c1">#endif bad</span>
       <span class="o">^</span>
       <span class="o">//</span>
</pre></div>
</div>
</dd>
<dt><strong>-f[no-]color-diagnostics</strong></dt><dd><p>This option, which defaults to on when a color-capable terminal is
detected, controls whether or not Clang prints diagnostics in color.</p>
<p>When this option is enabled, Clang will use colors to highlight
specific parts of the diagnostic, e.g.,</p>
<pre>
  <b><span style="color:black">test.c:28:8: <span style="color:magenta">warning</span>: extra tokens at end of #endif directive [-Wextra-tokens]</span></b>
  #endif bad
         <span style="color:green">^</span>
         <span style="color:green">//</span>
</pre><p>When this is disabled, Clang will just print:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span> <span class="n">warning</span><span class="p">:</span> <span class="n">extra</span> <span class="n">tokens</span> <span class="n">at</span> <span class="n">end</span> <span class="n">of</span> <span class="c1">#endif directive [-Wextra-tokens]</span>
<span class="c1">#endif bad</span>
       <span class="o">^</span>
       <span class="o">//</span>
</pre></div>
</div>
</dd>
<dt><strong>-fansi-escape-codes</strong></dt><dd><p>Controls whether ANSI escape codes are used instead of the Windows Console
API to output colored diagnostics. This option is only used on Windows and
defaults to off.</p>
</dd>
</dl>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fdiagnostics-format">
<span class="sig-name descname"><span class="pre">-fdiagnostics-format</span></span><span class="sig-prename descclassname"><span class="pre">=clang/msvc/vi</span></span><a class="headerlink" href="#cmdoption-fdiagnostics-format" title="Link to this definition">¶</a></dt>
<dd><p>Changes diagnostic output format to better match IDEs and command line tools.</p>
<p>This option controls the output format of the filename, line number,
and column printed in diagnostic messages. The options, and their
affect on formatting a simple conversion diagnostic, follow:</p>
<dl>
<dt><strong>clang</strong> (default)</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span> <span class="n">warning</span><span class="p">:</span> <span class="n">conversion</span> <span class="n">specifies</span> <span class="nb">type</span> <span class="s1">&#39;char *&#39;</span> <span class="n">but</span> <span class="n">the</span> <span class="n">argument</span> <span class="n">has</span> <span class="nb">type</span> <span class="s1">&#39;int&#39;</span>
</pre></div>
</div>
</dd>
<dt><strong>msvc</strong></dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span> <span class="p">:</span> <span class="n">warning</span><span class="p">:</span> <span class="n">conversion</span> <span class="n">specifies</span> <span class="nb">type</span> <span class="s1">&#39;char *&#39;</span> <span class="n">but</span> <span class="n">the</span> <span class="n">argument</span> <span class="n">has</span> <span class="nb">type</span> <span class="s1">&#39;int&#39;</span>
</pre></div>
</div>
</dd>
<dt><strong>vi</strong></dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">c</span> <span class="o">+</span><span class="mi">3</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span> <span class="n">warning</span><span class="p">:</span> <span class="n">conversion</span> <span class="n">specifies</span> <span class="nb">type</span> <span class="s1">&#39;char *&#39;</span> <span class="n">but</span> <span class="n">the</span> <span class="n">argument</span> <span class="n">has</span> <span class="nb">type</span> <span class="s1">&#39;int&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl id="opt-fdiagnostics-show-option">
<dt><strong>-f[no-]diagnostics-show-option</strong></dt><dd><p>Enable <code class="docutils literal notranslate"><span class="pre">[-Woption]</span></code> information in diagnostic line.</p>
<p>This option, which defaults to on, controls whether or not Clang
prints the associated <a class="reference internal" href="#cl-diag-warning-groups"><span class="std std-ref">warning group</span></a>
option name when outputting a warning diagnostic. For example, in
this output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span> <span class="n">warning</span><span class="p">:</span> <span class="n">extra</span> <span class="n">tokens</span> <span class="n">at</span> <span class="n">end</span> <span class="n">of</span> <span class="c1">#endif directive [-Wextra-tokens]</span>
<span class="c1">#endif bad</span>
       <span class="o">^</span>
       <span class="o">//</span>
</pre></div>
</div>
<p>Passing <strong>-fno-diagnostics-show-option</strong> will prevent Clang from
printing the [<a class="reference internal" href="#opt-wextra-tokens"><span class="std std-ref">-Wextra-tokens</span></a>] information in
the diagnostic. This information tells you the flag needed to enable
or disable the diagnostic, either from the command line or through
<a class="reference internal" href="#pragma-gcc-diagnostic"><span class="std std-ref">#pragma GCC diagnostic</span></a>.</p>
</dd>
</dl>
<dl class="std option" id="opt-fdiagnostics-show-category">
<dt class="sig sig-object std" id="cmdoption-fdiagnostics-show-category">
<span class="sig-name descname"><span class="pre">-fdiagnostics-show-category</span></span><span class="sig-prename descclassname"><span class="pre">=none/id/name</span></span><a class="headerlink" href="#cmdoption-fdiagnostics-show-category" title="Link to this definition">¶</a></dt>
<dd><p>Enable printing category information in diagnostic line.</p>
<p>This option, which defaults to “none”, controls whether or not Clang
prints the category associated with a diagnostic when emitting it.
Each diagnostic may or many not have an associated category, if it
has one, it is listed in the diagnostic categorization field of the
diagnostic line (in the []’s).</p>
<p>For example, a format string warning will produce these three
renditions based on the setting of this option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span> <span class="n">warning</span><span class="p">:</span> <span class="n">conversion</span> <span class="n">specifies</span> <span class="nb">type</span> <span class="s1">&#39;char *&#39;</span> <span class="n">but</span> <span class="n">the</span> <span class="n">argument</span> <span class="n">has</span> <span class="nb">type</span> <span class="s1">&#39;int&#39;</span> <span class="p">[</span><span class="o">-</span><span class="n">Wformat</span><span class="p">]</span>
<span class="n">t</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span> <span class="n">warning</span><span class="p">:</span> <span class="n">conversion</span> <span class="n">specifies</span> <span class="nb">type</span> <span class="s1">&#39;char *&#39;</span> <span class="n">but</span> <span class="n">the</span> <span class="n">argument</span> <span class="n">has</span> <span class="nb">type</span> <span class="s1">&#39;int&#39;</span> <span class="p">[</span><span class="o">-</span><span class="n">Wformat</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">t</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span> <span class="n">warning</span><span class="p">:</span> <span class="n">conversion</span> <span class="n">specifies</span> <span class="nb">type</span> <span class="s1">&#39;char *&#39;</span> <span class="n">but</span> <span class="n">the</span> <span class="n">argument</span> <span class="n">has</span> <span class="nb">type</span> <span class="s1">&#39;int&#39;</span> <span class="p">[</span><span class="o">-</span><span class="n">Wformat</span><span class="p">,</span><span class="n">Format</span> <span class="n">String</span><span class="p">]</span>
</pre></div>
</div>
<p>This category can be used by clients that want to group diagnostics
by category, so it should be a high level category. We want dozens
of these, not hundreds or thousands of them.</p>
</dd></dl>

<dl class="std option" id="opt-fsave-optimization-record">
<dt class="sig sig-object std" id="cmdoption-fsave-optimization-record">
<span class="sig-name descname"><span class="pre">-fsave-optimization-record</span></span><span class="sig-prename descclassname"><span class="pre">[=&lt;format&gt;]</span></span><a class="headerlink" href="#cmdoption-fsave-optimization-record" title="Link to this definition">¶</a></dt>
<dd><p>Write optimization remarks to a separate file.</p>
<p>This option, which defaults to off, controls whether Clang writes
optimization reports to a separate file. By recording diagnostics in a file,
users can parse or sort the remarks in a convenient way.</p>
<p>By default, the serialization format is YAML.</p>
<p>The supported serialization formats are:</p>
<ul class="simple">
<li><p id="opt-fsave-optimization-record-yaml"><code class="docutils literal notranslate"><span class="pre">-fsave-optimization-record=yaml</span></code>: A structured YAML format.</p>
</li>
</ul>
</dd></dl>

<dl id="opt-foptimization-record-file">
<dt><strong>-foptimization-record-file</strong></dt><dd><p>Control the file to which optimization reports are written.</p>
<p>When optimization reports are being output (see
<a class="reference internal" href="#opt-fsave-optimization-record"><span class="std std-ref">-fsave-optimization-record</span></a>), this
option controls the file to which those reports are written.</p>
<p>If this option is not used, optimization records are output to a file named
after the primary file being compiled. If that’s “foo.c”, for example,
optimization records are output to “foo.opt.yaml”. If a specific
serialization format is specified, the file will be named
“foo.opt.&lt;format&gt;”.</p>
</dd>
</dl>
<dl id="opt-foptimization-record-passes">
<dt><strong>-foptimization-record-passes</strong></dt><dd><p>Only include passes which match a specified regular expression.</p>
<p>When optimization reports are being output (see
<a class="reference internal" href="#opt-fsave-optimization-record"><span class="std std-ref">-fsave-optimization-record</span></a>), this
option controls the passes that will be included in the final report.</p>
<p>If this option is not used, all the passes are included in the optimization
record.</p>
</dd>
</dl>
<dl id="opt-fdiagnostics-show-hotness">
<dt><strong>-f[no-]diagnostics-show-hotness</strong></dt><dd><p>Enable profile hotness information in diagnostic line.</p>
<p>This option controls whether Clang prints the profile hotness associated
with diagnostics in the presence of profile-guided optimization information.
This is currently supported with optimization remarks (see
<a class="reference internal" href="#rpass"><span class="std std-ref">Options to Emit Optimization Reports</span></a>). The hotness information
allows users to focus on the hot optimization remarks that are likely to be
more relevant for run-time performance.</p>
<p>For example, in this output, the block containing the callsite of <cite>foo</cite> was
executed 3000 times according to the profile data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">7</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span> <span class="n">remark</span><span class="p">:</span> <span class="n">foo</span> <span class="n">inlined</span> <span class="n">into</span> <span class="n">bar</span> <span class="p">(</span><span class="n">hotness</span><span class="p">:</span> <span class="mi">3000</span><span class="p">)</span> <span class="p">[</span><span class="o">-</span><span class="n">Rpass</span><span class="o">-</span><span class="n">analysis</span><span class="o">=</span><span class="n">inline</span><span class="p">]</span>
  <span class="nb">sum</span> <span class="o">+=</span> <span class="n">foo</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span>
         <span class="o">^</span>
</pre></div>
</div>
<p>This option is implied when
<a class="reference internal" href="#opt-fsave-optimization-record"><span class="std std-ref">-fsave-optimization-record</span></a> is used.
Otherwise, it defaults to off.</p>
</dd>
</dl>
<dl id="opt-fdiagnostics-hotness-threshold">
<dt><strong>-fdiagnostics-hotness-threshold</strong></dt><dd><p>Prevent optimization remarks from being output if they do not have at least
this hotness value.</p>
<p>This option, which defaults to zero, controls the minimum hotness an
optimization remark would need in order to be output by Clang. This is
currently supported with optimization remarks (see <a class="reference internal" href="#rpass"><span class="std std-ref">Options to Emit
Optimization Reports</span></a>) when profile hotness information in
diagnostics is enabled (see
<a class="reference internal" href="#opt-fdiagnostics-show-hotness"><span class="std std-ref">-fdiagnostics-show-hotness</span></a>).</p>
</dd>
</dl>
<dl id="opt-fdiagnostics-fixit-info">
<dt><strong>-f[no-]diagnostics-fixit-info</strong></dt><dd><p>Enable “FixIt” information in the diagnostics output.</p>
<p>This option, which defaults to on, controls whether or not Clang
prints the information on how to fix a specific diagnostic
underneath it when it knows. For example, in this output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span> <span class="n">warning</span><span class="p">:</span> <span class="n">extra</span> <span class="n">tokens</span> <span class="n">at</span> <span class="n">end</span> <span class="n">of</span> <span class="c1">#endif directive [-Wextra-tokens]</span>
<span class="c1">#endif bad</span>
       <span class="o">^</span>
       <span class="o">//</span>
</pre></div>
</div>
<p>Passing <strong>-fno-diagnostics-fixit-info</strong> will prevent Clang from
printing the “//” line at the end of the message. This information
is useful for users who may not understand what is wrong, but can be
confusing for machine parsing.</p>
</dd>
</dl>
<dl id="opt-fdiagnostics-print-source-range-info">
<dt><strong>-fdiagnostics-print-source-range-info</strong></dt><dd><p>Print machine parsable information about source ranges.
This option makes Clang print information about source ranges in a machine
parsable format after the file/line/column number information. The
information is a simple sequence of brace enclosed ranges, where each range
lists the start and end line/column locations. For example, in this output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">exprs</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">47</span><span class="p">:</span><span class="mi">15</span><span class="p">:{</span><span class="mi">47</span><span class="p">:</span><span class="mi">8</span><span class="o">-</span><span class="mi">47</span><span class="p">:</span><span class="mi">14</span><span class="p">}{</span><span class="mi">47</span><span class="p">:</span><span class="mi">17</span><span class="o">-</span><span class="mi">47</span><span class="p">:</span><span class="mi">24</span><span class="p">}:</span> <span class="n">error</span><span class="p">:</span> <span class="n">invalid</span> <span class="n">operands</span> <span class="n">to</span> <span class="n">binary</span> <span class="n">expression</span> <span class="p">(</span><span class="s1">&#39;int *&#39;</span> <span class="ow">and</span> <span class="s1">&#39;_Complex float&#39;</span><span class="p">)</span>
   <span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="mi">42</span><span class="p">)</span> <span class="o">+</span> <span class="n">Gamma</span><span class="o">*</span><span class="mi">4</span><span class="p">;</span>
       <span class="o">~~~~~~</span> <span class="o">^</span> <span class="o">~~~~~~~</span>
</pre></div>
</div>
<p>The {}’s are generated by -fdiagnostics-print-source-range-info.</p>
<p>The printed column numbers count bytes from the beginning of the
line; take care if your source contains multibyte characters.</p>
</dd>
</dl>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fdiagnostics-parseable-fixits">
<span class="sig-name descname"><span class="pre">-fdiagnostics-parseable-fixits</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fdiagnostics-parseable-fixits" title="Link to this definition">¶</a></dt>
<dd><p>Print Fix-Its in a machine parseable form.</p>
<p>This option makes Clang print available Fix-Its in a machine
parseable format at the end of diagnostics. The following example
illustrates the format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fix</span><span class="o">-</span><span class="n">it</span><span class="p">:</span><span class="s2">&quot;t.cpp&quot;</span><span class="p">:{</span><span class="mi">7</span><span class="p">:</span><span class="mi">25</span><span class="o">-</span><span class="mi">7</span><span class="p">:</span><span class="mi">29</span><span class="p">}:</span><span class="s2">&quot;Gamma&quot;</span>
</pre></div>
</div>
<p>The range printed is a half-open range, so in this example the
characters at column 25 up to but not including column 29 on line 7
in t.cpp should be replaced with the string “Gamma”. Either the
range or the replacement string may be empty (representing strict
insertions and strict erasures, respectively). Both the file name
and the insertion string escape backslash (as “\\”), tabs (as
“\t”), newlines (as “\n”), double quotes(as “\””) and
non-printable characters (as octal “\xxx”).</p>
<p>The printed column numbers count bytes from the beginning of the
line; take care if your source contains multibyte characters.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fno-elide-type">
<span class="sig-name descname"><span class="pre">-fno-elide-type</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fno-elide-type" title="Link to this definition">¶</a></dt>
<dd><p>Turns off elision in template type printing.</p>
<p>The default for template type printing is to elide as many template
arguments as possible, removing those which are the same in both
template types, leaving only the differences. Adding this flag will
print all the template arguments. If supported by the terminal,
highlighting will still appear on differing arguments.</p>
<p>Default:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">cc</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span> <span class="n">note</span><span class="p">:</span> <span class="n">candidate</span> <span class="n">function</span> <span class="ow">not</span> <span class="n">viable</span><span class="p">:</span> <span class="n">no</span> <span class="n">known</span> <span class="n">conversion</span> <span class="kn">from</span><span class="w"> </span><span class="s1">&#39;vector&lt;map&lt;[...], map&lt;float, [...]&gt;&gt;&gt;&#39;</span> <span class="n">to</span> <span class="s1">&#39;vector&lt;map&lt;[...], map&lt;double, [...]&gt;&gt;&gt;&#39;</span> <span class="k">for</span> <span class="mi">1</span><span class="n">st</span> <span class="n">argument</span><span class="p">;</span>
</pre></div>
</div>
<p>-fno-elide-type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">cc</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span> <span class="n">note</span><span class="p">:</span> <span class="n">candidate</span> <span class="n">function</span> <span class="ow">not</span> <span class="n">viable</span><span class="p">:</span> <span class="n">no</span> <span class="n">known</span> <span class="n">conversion</span> <span class="kn">from</span><span class="w"> </span><span class="s1">&#39;vector&lt;map&lt;int, map&lt;float, int&gt;&gt;&gt;&#39;</span> <span class="n">to</span> <span class="s1">&#39;vector&lt;map&lt;int, map&lt;double, int&gt;&gt;&gt;&#39;</span> <span class="k">for</span> <span class="mi">1</span><span class="n">st</span> <span class="n">argument</span><span class="p">;</span>
</pre></div>
</div>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fdiagnostics-show-template-tree">
<span class="sig-name descname"><span class="pre">-fdiagnostics-show-template-tree</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fdiagnostics-show-template-tree" title="Link to this definition">¶</a></dt>
<dd><p>Template type diffing prints a text tree.</p>
<p>For diffing large templated types, this option will cause Clang to
display the templates as an indented text tree, one argument per
line, with differences marked inline. This is compatible with
-fno-elide-type.</p>
<p>Default:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">cc</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span> <span class="n">note</span><span class="p">:</span> <span class="n">candidate</span> <span class="n">function</span> <span class="ow">not</span> <span class="n">viable</span><span class="p">:</span> <span class="n">no</span> <span class="n">known</span> <span class="n">conversion</span> <span class="kn">from</span><span class="w"> </span><span class="s1">&#39;vector&lt;map&lt;[...], map&lt;float, [...]&gt;&gt;&gt;&#39;</span> <span class="n">to</span> <span class="s1">&#39;vector&lt;map&lt;[...], map&lt;double, [...]&gt;&gt;&gt;&#39;</span> <span class="k">for</span> <span class="mi">1</span><span class="n">st</span> <span class="n">argument</span><span class="p">;</span>
</pre></div>
</div>
<p>With <a class="reference internal" href="#cmdoption-fdiagnostics-show-template-tree"><code class="xref std std-option docutils literal notranslate"><span class="pre">-fdiagnostics-show-template-tree</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">cc</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span> <span class="n">note</span><span class="p">:</span> <span class="n">candidate</span> <span class="n">function</span> <span class="ow">not</span> <span class="n">viable</span><span class="p">:</span> <span class="n">no</span> <span class="n">known</span> <span class="n">conversion</span> <span class="k">for</span> <span class="mi">1</span><span class="n">st</span> <span class="n">argument</span><span class="p">;</span>
  <span class="n">vector</span><span class="o">&lt;</span>
    <span class="nb">map</span><span class="o">&lt;</span>
      <span class="p">[</span><span class="o">...</span><span class="p">],</span>
      <span class="nb">map</span><span class="o">&lt;</span>
        <span class="p">[</span><span class="nb">float</span> <span class="o">!=</span> <span class="n">double</span><span class="p">],</span>
        <span class="p">[</span><span class="o">...</span><span class="p">]</span><span class="o">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="individual-warning-groups">
<span id="cl-diag-warning-groups"></span><h4><a class="toc-backref" href="#id16" role="doc-backlink">Individual Warning Groups</a><a class="headerlink" href="#individual-warning-groups" title="Link to this heading">¶</a></h4>
<p>TODO: Generate this from tblgen. Define one anchor per warning group.</p>
<dl class="std option" id="opt-wextra-tokens">
<dt class="sig sig-object std" id="cmdoption-Wextra-tokens">
<span class="sig-name descname"><span class="pre">-Wextra-tokens</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-Wextra-tokens" title="Link to this definition">¶</a></dt>
<dd><p>Warn about excess tokens at the end of a preprocessor directive.</p>
<p>This option, which defaults to on, enables warnings about extra
tokens at the end of preprocessor directives. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span> <span class="n">warning</span><span class="p">:</span> <span class="n">extra</span> <span class="n">tokens</span> <span class="n">at</span> <span class="n">end</span> <span class="n">of</span> <span class="c1">#endif directive [-Wextra-tokens]</span>
<span class="c1">#endif bad</span>
       <span class="o">^</span>
</pre></div>
</div>
<p>These extra tokens are not strictly conforming, and are usually best
handled by commenting them out.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-Wambiguous-member-template">
<span class="sig-name descname"><span class="pre">-Wambiguous-member-template</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-Wambiguous-member-template" title="Link to this definition">¶</a></dt>
<dd><p>Warn about unqualified uses of a member template whose name resolves to
another template at the location of the use.</p>
<p>This option, which defaults to on, enables a warning in the
following code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="n">typename</span> <span class="n">T</span><span class="o">&gt;</span> <span class="n">struct</span> <span class="nb">set</span><span class="p">{};</span>
<span class="n">template</span><span class="o">&lt;</span><span class="n">typename</span> <span class="n">T</span><span class="o">&gt;</span> <span class="n">struct</span> <span class="n">trait</span> <span class="p">{</span> <span class="n">typedef</span> <span class="n">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="nb">type</span><span class="p">;</span> <span class="p">};</span>
<span class="n">struct</span> <span class="n">Value</span> <span class="p">{</span>
  <span class="n">template</span><span class="o">&lt;</span><span class="n">typename</span> <span class="n">T</span><span class="o">&gt;</span> <span class="n">void</span> <span class="nb">set</span><span class="p">(</span><span class="n">typename</span> <span class="n">trait</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">::</span><span class="nb">type</span> <span class="n">value</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">};</span>
<span class="n">void</span> <span class="n">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">Value</span> <span class="n">v</span><span class="p">;</span>
  <span class="n">v</span><span class="o">.</span><span class="n">set</span><span class="o">&lt;</span><span class="n">double</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">3.2</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>C++ [basic.lookup.classref] requires this to be an error, but,
because it’s hard to work around, Clang downgrades it to a warning
as an extension.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-Wbind-to-temporary-copy">
<span class="sig-name descname"><span class="pre">-Wbind-to-temporary-copy</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-Wbind-to-temporary-copy" title="Link to this definition">¶</a></dt>
<dd><p>Warn about an unusable copy constructor when binding a reference to a
temporary.</p>
<p>This option enables warnings about binding a
reference to a temporary when the temporary doesn’t have a usable
copy constructor. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">struct</span> <span class="n">NonCopyable</span> <span class="p">{</span>
  <span class="n">NonCopyable</span><span class="p">();</span>
<span class="n">private</span><span class="p">:</span>
  <span class="n">NonCopyable</span><span class="p">(</span><span class="n">const</span> <span class="n">NonCopyable</span><span class="o">&amp;</span><span class="p">);</span>
<span class="p">};</span>
<span class="n">void</span> <span class="n">foo</span><span class="p">(</span><span class="n">const</span> <span class="n">NonCopyable</span><span class="o">&amp;</span><span class="p">);</span>
<span class="n">void</span> <span class="n">bar</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">foo</span><span class="p">(</span><span class="n">NonCopyable</span><span class="p">());</span>  <span class="o">//</span> <span class="n">Disallowed</span> <span class="ow">in</span> <span class="n">C</span><span class="o">++</span><span class="mi">98</span><span class="p">;</span> <span class="n">allowed</span> <span class="ow">in</span> <span class="n">C</span><span class="o">++</span><span class="mf">11.</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">struct</span> <span class="n">NonCopyable2</span> <span class="p">{</span>
  <span class="n">NonCopyable2</span><span class="p">();</span>
  <span class="n">NonCopyable2</span><span class="p">(</span><span class="n">NonCopyable2</span><span class="o">&amp;</span><span class="p">);</span>
<span class="p">};</span>
<span class="n">void</span> <span class="n">foo</span><span class="p">(</span><span class="n">const</span> <span class="n">NonCopyable2</span><span class="o">&amp;</span><span class="p">);</span>
<span class="n">void</span> <span class="n">bar</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">foo</span><span class="p">(</span><span class="n">NonCopyable2</span><span class="p">());</span>  <span class="o">//</span> <span class="n">Disallowed</span> <span class="ow">in</span> <span class="n">C</span><span class="o">++</span><span class="mi">98</span><span class="p">;</span> <span class="n">allowed</span> <span class="ow">in</span> <span class="n">C</span><span class="o">++</span><span class="mf">11.</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that if <code class="docutils literal notranslate"><span class="pre">NonCopyable2::NonCopyable2()</span></code> has a default argument
whose instantiation produces a compile error, that error will still
be a hard error in C++98 mode even if this warning is turned off.</p>
</dd></dl>

</section>
</section>
<section id="options-to-control-clang-crash-diagnostics">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Options to Control Clang Crash Diagnostics</a><a class="headerlink" href="#options-to-control-clang-crash-diagnostics" title="Link to this heading">¶</a></h3>
<p>As unbelievable as it may sound, Clang does crash from time to time.
Generally, this only occurs to those living on the <a class="reference external" href="https://llvm.org/releases/download.html#svn">bleeding
edge</a>. Clang goes to great
lengths to assist you in filing a bug report. Specifically, Clang
generates preprocessed source file(s) and associated run script(s) upon
a crash. These files should be attached to a bug report to ease
reproducibility of the failure. Below are the command line options to
control the crash diagnostics.</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fno-crash-diagnostics">
<span class="sig-name descname"><span class="pre">-fno-crash-diagnostics</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fno-crash-diagnostics" title="Link to this definition">¶</a></dt>
<dd><p>Disable auto-generation of preprocessed source files during a clang crash.</p>
</dd></dl>

<p>The -fno-crash-diagnostics flag can be helpful for speeding the process
of generating a delta reduced test case.</p>
<p>Clang is also capable of generating preprocessed source file(s) and associated
run script(s) even without a crash. This is specially useful when trying to
generate a reproducer for warnings or errors while using modules.</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-gen-reproducer">
<span class="sig-name descname"><span class="pre">-gen-reproducer</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-gen-reproducer" title="Link to this definition">¶</a></dt>
<dd><p>Generates preprocessed source files, a reproducer script and if relevant, a
cache containing: built module pcm’s and all headers needed to rebuilt the
same modules.</p>
</dd></dl>

</section>
<section id="options-to-emit-optimization-reports">
<span id="rpass"></span><h3><a class="toc-backref" href="#id18" role="doc-backlink">Options to Emit Optimization Reports</a><a class="headerlink" href="#options-to-emit-optimization-reports" title="Link to this heading">¶</a></h3>
<p>Optimization reports trace, at a high-level, all the major decisions
done by compiler transformations. For instance, when the inliner
decides to inline function <code class="docutils literal notranslate"><span class="pre">foo()</span></code> into <code class="docutils literal notranslate"><span class="pre">bar()</span></code>, or the loop unroller
decides to unroll a loop N times, or the vectorizer decides to
vectorize a loop body.</p>
<p>Clang offers a family of flags which the optimizers can use to emit
a diagnostic in three cases:</p>
<ol class="arabic simple">
<li><p>When the pass makes a transformation (<cite>-Rpass</cite>).</p></li>
<li><p>When the pass fails to make a transformation (<cite>-Rpass-missed</cite>).</p></li>
<li><p>When the pass determines whether or not to make a transformation
(<cite>-Rpass-analysis</cite>).</p></li>
</ol>
<p>NOTE: Although the discussion below focuses on <cite>-Rpass</cite>, the exact
same options apply to <cite>-Rpass-missed</cite> and <cite>-Rpass-analysis</cite>.</p>
<p>Since there are dozens of passes inside the compiler, each of these flags
take a regular expression that identifies the name of the pass which should
emit the associated diagnostic. For example, to get a report from the inliner,
compile the code with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>-O2<span class="w"> </span>-Rpass<span class="o">=</span>inline<span class="w"> </span>code.cc<span class="w"> </span>-o<span class="w"> </span>code
<span class="go">code.cc:4:25: remark: foo inlined into bar [-Rpass=inline]</span>
<span class="go">int bar(int j) { return foo(j, j - 2); }</span>
<span class="go">                        ^</span>
</pre></div>
</div>
<p>Note that remarks from the inliner are identified with <cite>[-Rpass=inline]</cite>.
To request a report from every optimization pass, you should use
<cite>-Rpass=.*</cite> (in fact, you can use any valid POSIX regular
expression). However, do not expect a report from every transformation
made by the compiler. Optimization remarks do not really make sense
outside of the major transformations (e.g., inlining, vectorization,
loop optimizations) and not every optimization pass supports this
feature.</p>
<p>Note that when using profile-guided optimization information, profile hotness
information can be included in the remarks (see
<a class="reference internal" href="#opt-fdiagnostics-show-hotness"><span class="std std-ref">-fdiagnostics-show-hotness</span></a>).</p>
<section id="current-limitations">
<h4><a class="toc-backref" href="#id19" role="doc-backlink">Current limitations</a><a class="headerlink" href="#current-limitations" title="Link to this heading">¶</a></h4>
<ol class="arabic simple">
<li><p>Optimization remarks that refer to function names will display the
mangled name of the function. Since these remarks are emitted by the
back end of the compiler, it does not know anything about the input
language, nor its mangling rules.</p></li>
<li><p>Some source locations are not displayed correctly. The front end has
a more detailed source location tracking than the locations included
in the debug info (e.g., the front end can locate code inside macro
expansions). However, the locations used by <cite>-Rpass</cite> are
translated from debug annotations. That translation can be lossy,
which results in some remarks having no location information.</p></li>
</ol>
</section>
</section>
<section id="other-options">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Other Options</a><a class="headerlink" href="#other-options" title="Link to this heading">¶</a></h3>
<p>Clang options that don’t fit neatly into other categories.</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-MV">
<span class="sig-name descname"><span class="pre">-MV</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-MV" title="Link to this definition">¶</a></dt>
<dd><p>When emitting a dependency file, use formatting conventions appropriate
for NMake or Jom. Ignored unless another option causes Clang to emit a
dependency file.</p>
</dd></dl>

<p>When Clang emits a dependency file (e.g., you supplied the -M option)
most filenames can be written to the file without any special formatting.
Different Make tools will treat different sets of characters as “special”
and use different conventions for telling the Make tool that the character
is actually part of the filename. Normally Clang uses backslash to “escape”
a special character, which is the convention used by GNU Make. The -MV
option tells Clang to put double-quotes around the entire filename, which
is the convention used by NMake and Jom.</p>
</section>
<section id="configuration-files">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Configuration files</a><a class="headerlink" href="#configuration-files" title="Link to this heading">¶</a></h3>
<p>Configuration files group command-line options and allow all of them to be
specified just by referencing the configuration file. They may be used, for
example, to collect options required to tune compilation for particular
target, such as -L, -I, -l, –sysroot, codegen options, etc.</p>
<p>The command line option <cite>–config</cite> can be used to specify configuration
file in a Clang invocation. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clang</span> <span class="o">--</span><span class="n">config</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">cfgs</span><span class="o">/</span><span class="n">testing</span><span class="o">.</span><span class="n">txt</span>
<span class="n">clang</span> <span class="o">--</span><span class="n">config</span> <span class="n">debug</span><span class="o">.</span><span class="n">cfg</span>
</pre></div>
</div>
<p>If the provided argument contains a directory separator, it is considered as
a file path, and options are read from that file. Otherwise the argument is
treated as a file name and is searched for sequentially in the directories:</p>
<blockquote>
<div><ul class="simple">
<li><p>user directory,</p></li>
<li><p>system directory,</p></li>
<li><p>the directory where Clang executable resides.</p></li>
</ul>
</div></blockquote>
<p>Both user and system directories for configuration files are specified during
clang build using CMake parameters, CLANG_CONFIG_FILE_USER_DIR and
CLANG_CONFIG_FILE_SYSTEM_DIR respectively. The first file found is used. It is
an error if the required file cannot be found.</p>
<p>Another way to specify a configuration file is to encode it in executable name.
For example, if the Clang executable is named <cite>armv7l-clang</cite> (it may be a
symbolic link to <cite>clang</cite>), then Clang will search for file <cite>armv7l.cfg</cite> in the
directory where Clang resides.</p>
<p>If a driver mode is specified in invocation, Clang tries to find a file specific
for the specified mode. For example, if the executable file is named
<cite>x86_64-clang-cl</cite>, Clang first looks for <cite>x86_64-cl.cfg</cite> and if it is not found,
looks for <cite>x86_64.cfg</cite>.</p>
<p>If the command line contains options that effectively change target architecture
(these are -m32, -EL, and some others) and the configuration file starts with an
architecture name, Clang tries to load the configuration file for the effective
architecture. For example, invocation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x86_64</span><span class="o">-</span><span class="n">clang</span> <span class="o">-</span><span class="n">m32</span> <span class="n">abc</span><span class="o">.</span><span class="n">c</span>
</pre></div>
</div>
<p>causes Clang search for a file <cite>i368.cfg</cite> first, and if no such file is found,
Clang looks for the file <cite>x86_64.cfg</cite>.</p>
<p>The configuration file consists of command-line options specified on one or
more lines. Lines composed of whitespace characters only are ignored as well as
lines in which the first non-blank character is <cite>#</cite>. Long options may be split
between several lines by a trailing backslash. Here is example of a
configuration file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Several options on line</span>
<span class="o">-</span><span class="n">c</span> <span class="o">--</span><span class="n">target</span><span class="o">=</span><span class="n">x86_64</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span>

<span class="c1"># Long option split between lines</span>
<span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">x86_64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="mf">5.4.0</span><span class="o">/../../../../</span>\
<span class="n">include</span><span class="o">/</span><span class="n">c</span><span class="o">++/</span><span class="mf">5.4.0</span>

<span class="c1"># other config files may be included</span>
<span class="nd">@linux</span><span class="o">.</span><span class="n">options</span>
</pre></div>
</div>
<p>Files included by <cite>&#64;file</cite> directives in configuration files are resolved
relative to the including file. For example, if a configuration file
<cite>~/.llvm/target.cfg</cite> contains the directive <cite>&#64;os/linux.opts</cite>, the file
<cite>linux.opts</cite> is searched for in the directory <cite>~/.llvm/os</cite>.</p>
</section>
</section>
<section id="language-and-target-independent-features">
<h2><a class="toc-backref" href="#id22" role="doc-backlink">Language and Target-Independent Features</a><a class="headerlink" href="#language-and-target-independent-features" title="Link to this heading">¶</a></h2>
<section id="controlling-errors-and-warnings">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">Controlling Errors and Warnings</a><a class="headerlink" href="#controlling-errors-and-warnings" title="Link to this heading">¶</a></h3>
<p>Clang provides a number of ways to control which code constructs cause
it to emit errors and warning messages, and how they are displayed to
the console.</p>
<section id="controlling-how-clang-displays-diagnostics">
<h4><a class="toc-backref" href="#id24" role="doc-backlink">Controlling How Clang Displays Diagnostics</a><a class="headerlink" href="#controlling-how-clang-displays-diagnostics" title="Link to this heading">¶</a></h4>
<p>When Clang emits a diagnostic, it includes rich information in the
output, and gives you fine-grain control over which information is
printed. Clang has the ability to print this information, and these are
the options that control it:</p>
<ol class="arabic simple">
<li><p>A file/line/column indicator that shows exactly where the diagnostic
occurs in your code [<a class="reference internal" href="#opt-fshow-column"><span class="std std-ref">-fshow-column</span></a>,
<a class="reference internal" href="#opt-fshow-source-location"><span class="std std-ref">-fshow-source-location</span></a>].</p></li>
<li><p>A categorization of the diagnostic as a note, warning, error, or
fatal error.</p></li>
<li><p>A text string that describes what the problem is.</p></li>
<li><p>An option that indicates how to control the diagnostic (for
diagnostics that support it)
[<a class="reference internal" href="#opt-fdiagnostics-show-option"><span class="std std-ref">-fdiagnostics-show-option</span></a>].</p></li>
<li><p>A <a class="reference internal" href="#diagnostics-categories"><span class="std std-ref">high-level category</span></a> for the diagnostic
for clients that want to group diagnostics by class (for diagnostics
that support it)
[<a class="reference internal" href="#opt-fdiagnostics-show-category"><span class="std std-ref">-fdiagnostics-show-category</span></a>].</p></li>
<li><p>The line of source code that the issue occurs on, along with a caret
and ranges that indicate the important locations
[<a class="reference internal" href="#opt-fcaret-diagnostics"><span class="std std-ref">-fcaret-diagnostics</span></a>].</p></li>
<li><p>“FixIt” information, which is a concise explanation of how to fix the
problem (when Clang is certain it knows)
[<a class="reference internal" href="#opt-fdiagnostics-fixit-info"><span class="std std-ref">-fdiagnostics-fixit-info</span></a>].</p></li>
<li><p>A machine-parsable representation of the ranges involved (off by
default)
[<a class="reference internal" href="#opt-fdiagnostics-print-source-range-info"><span class="std std-ref">-fdiagnostics-print-source-range-info</span></a>].</p></li>
</ol>
<p>For more information please see <a class="reference internal" href="#cl-diag-formatting"><span class="std std-ref">Formatting of
Diagnostics</span></a>.</p>
</section>
<section id="diagnostic-mappings">
<h4><a class="toc-backref" href="#id25" role="doc-backlink">Diagnostic Mappings</a><a class="headerlink" href="#diagnostic-mappings" title="Link to this heading">¶</a></h4>
<p>All diagnostics are mapped into one of these 6 classes:</p>
<ul class="simple">
<li><p>Ignored</p></li>
<li><p>Note</p></li>
<li><p>Remark</p></li>
<li><p>Warning</p></li>
<li><p>Error</p></li>
<li><p>Fatal</p></li>
</ul>
</section>
<section id="diagnostic-categories">
<span id="diagnostics-categories"></span><h4><a class="toc-backref" href="#id26" role="doc-backlink">Diagnostic Categories</a><a class="headerlink" href="#diagnostic-categories" title="Link to this heading">¶</a></h4>
<p>Though not shown by default, diagnostics may each be associated with a
high-level category. This category is intended to make it possible to
triage builds that produce a large number of errors or warnings in a
grouped way.</p>
<p>Categories are not shown by default, but they can be turned on with the
<a class="reference internal" href="#opt-fdiagnostics-show-category"><span class="std std-ref">-fdiagnostics-show-category</span></a> option.
When set to “<code class="docutils literal notranslate"><span class="pre">name</span></code>”, the category is printed textually in the
diagnostic output. When it is set to “<code class="docutils literal notranslate"><span class="pre">id</span></code>”, a category number is
printed. The mapping of category names to category id’s can be obtained
by running ‘<code class="docutils literal notranslate"><span class="pre">clang</span>&#160;&#160; <span class="pre">--print-diagnostic-categories</span></code>’.</p>
</section>
<section id="controlling-diagnostics-via-command-line-flags">
<h4><a class="toc-backref" href="#id27" role="doc-backlink">Controlling Diagnostics via Command Line Flags</a><a class="headerlink" href="#controlling-diagnostics-via-command-line-flags" title="Link to this heading">¶</a></h4>
<p>TODO: -W flags, -pedantic, etc</p>
</section>
<section id="controlling-diagnostics-via-pragmas">
<span id="pragma-gcc-diagnostic"></span><h4><a class="toc-backref" href="#id28" role="doc-backlink">Controlling Diagnostics via Pragmas</a><a class="headerlink" href="#controlling-diagnostics-via-pragmas" title="Link to this heading">¶</a></h4>
<p>Clang can also control what diagnostics are enabled through the use of
pragmas in the source code. This is useful for turning off specific
warnings in a section of source code. Clang supports GCC’s pragma for
compatibility with existing source code, as well as several extensions.</p>
<p>The pragma may control any warning that can be used from the command
line. Warnings may be set to ignored, warning, error, or fatal. The
following example code will tell Clang or GCC to ignore the -Wall
warnings:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#pragma GCC diagnostic ignored &quot;-Wall&quot;</span>
</pre></div>
</div>
<p>In addition to all of the functionality provided by GCC’s pragma, Clang
also allows you to push and pop the current warning state. This is
particularly useful when writing a header file that will be compiled by
other people, because you don’t know what warning flags they build with.</p>
<p>In the below example <a class="reference internal" href="#cmdoption-Wextra-tokens"><code class="xref std std-option docutils literal notranslate"><span class="pre">-Wextra-tokens</span></code></a> is ignored for only a single line
of code, after which the diagnostics return to whatever state had previously
existed.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#if foo</span>
<span class="cp">#endif foo </span><span class="c1">// warning: extra tokens at end of #endif directive</span>

<span class="cp">#pragma clang diagnostic push</span>
<span class="cp">#pragma clang diagnostic ignored &quot;-Wextra-tokens&quot;</span>

<span class="cp">#if foo</span>
<span class="cp">#endif foo </span><span class="c1">// no warning</span>

<span class="cp">#pragma clang diagnostic pop</span>
</pre></div>
</div>
<p>The push and pop pragmas will save and restore the full diagnostic state
of the compiler, regardless of how it was set. That means that it is
possible to use push and pop around GCC compatible diagnostics and Clang
will push and pop them appropriately, while GCC will ignore the pushes
and pops as unknown pragmas. It should be noted that while Clang
supports the GCC pragma, Clang and GCC do not support the exact same set
of warnings, so even when using GCC compatible #pragmas there is no
guarantee that they will have identical behaviour on both compilers.</p>
<p>In addition to controlling warnings and errors generated by the compiler, it is
possible to generate custom warning and error messages through the following
pragmas:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// The following will produce warning messages</span>
<span class="cp">#pragma message &quot;some diagnostic message&quot;</span>
<span class="cp">#pragma GCC warning &quot;TODO: replace deprecated feature&quot;</span>

<span class="c1">// The following will produce an error message</span>
<span class="cp">#pragma GCC error &quot;Not supported&quot;</span>
</pre></div>
</div>
<p>These pragmas operate similarly to the <code class="docutils literal notranslate"><span class="pre">#warning</span></code> and <code class="docutils literal notranslate"><span class="pre">#error</span></code> preprocessor
directives, except that they may also be embedded into preprocessor macros via
the C99 <code class="docutils literal notranslate"><span class="pre">_Pragma</span></code> operator, for example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define STR(X) #X</span>
<span class="cp">#define DEFER(M,...) M(__VA_ARGS__)</span>
<span class="cp">#define CUSTOM_ERROR(X) _Pragma(STR(GCC error(X &quot; at line &quot; DEFER(STR,__LINE__))))</span>

<span class="n">CUSTOM_ERROR</span><span class="p">(</span><span class="s">&quot;Feature not available&quot;</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="controlling-diagnostics-in-system-headers">
<h4><a class="toc-backref" href="#id29" role="doc-backlink">Controlling Diagnostics in System Headers</a><a class="headerlink" href="#controlling-diagnostics-in-system-headers" title="Link to this heading">¶</a></h4>
<p>Warnings are suppressed when they occur in system headers. By default,
an included file is treated as a system header if it is found in an
include path specified by <code class="docutils literal notranslate"><span class="pre">-isystem</span></code>, but this can be overridden in
several ways.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">system_header</span></code> pragma can be used to mark the current file as
being a system header. No warnings will be produced from the location of
the pragma onwards within the same file.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#if foo</span>
<span class="cp">#endif foo </span><span class="c1">// warning: extra tokens at end of #endif directive</span>

<span class="cp">#pragma clang system_header</span>

<span class="cp">#if foo</span>
<span class="cp">#endif foo </span><span class="c1">// no warning</span>
</pre></div>
</div>
<p>The <cite>–system-header-prefix=</cite> and <cite>–no-system-header-prefix=</cite>
command-line arguments can be used to override whether subsets of an include
path are treated as system headers. When the name in a <code class="docutils literal notranslate"><span class="pre">#include</span></code> directive
is found within a header search path and starts with a system prefix, the
header is treated as a system header. The last prefix on the
command-line which matches the specified header name takes precedence.
For instance:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>-Ifoo<span class="w"> </span>-isystem<span class="w"> </span>bar<span class="w"> </span>--system-header-prefix<span class="o">=</span>x/<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--no-system-header-prefix<span class="o">=</span>x/y/
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&quot;x/a.h&quot;</span></code> is treated as including a system header, even
if the header is found in <code class="docutils literal notranslate"><span class="pre">foo</span></code>, and <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&quot;x/y/b.h&quot;</span></code> is treated
as not including a system header, even if the header is found in
<code class="docutils literal notranslate"><span class="pre">bar</span></code>.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">#include</span></code> directive which finds a file relative to the current
directory is treated as including a system header if the including file
is treated as a system header.</p>
</section>
<section id="enabling-all-diagnostics">
<span id="diagnostics-enable-everything"></span><h4><a class="toc-backref" href="#id30" role="doc-backlink">Enabling All Diagnostics</a><a class="headerlink" href="#enabling-all-diagnostics" title="Link to this heading">¶</a></h4>
<p>In addition to the traditional <code class="docutils literal notranslate"><span class="pre">-W</span></code> flags, one can enable <strong>all</strong>
diagnostics by passing <a class="reference internal" href="#cmdoption-Weverything"><code class="xref std std-option docutils literal notranslate"><span class="pre">-Weverything</span></code></a>. This works as expected
with
<a class="reference internal" href="#cmdoption-Werror"><code class="xref std std-option docutils literal notranslate"><span class="pre">-Werror</span></code></a>, and also includes the warnings from <a class="reference internal" href="#cmdoption-pedantic"><code class="xref std std-option docutils literal notranslate"><span class="pre">-pedantic</span></code></a>.</p>
<p>Note that when combined with <a class="reference internal" href="#cmdoption-w"><code class="xref std std-option docutils literal notranslate"><span class="pre">-w</span></code></a> (which disables all warnings), that
flag wins.</p>
</section>
<section id="controlling-static-analyzer-diagnostics">
<h4><a class="toc-backref" href="#id31" role="doc-backlink">Controlling Static Analyzer Diagnostics</a><a class="headerlink" href="#controlling-static-analyzer-diagnostics" title="Link to this heading">¶</a></h4>
<p>While not strictly part of the compiler, the diagnostics from Clang’s
<a class="reference external" href="https://clang-analyzer.llvm.org">static analyzer</a> can also be
influenced by the user via changes to the source code. See the available
<a class="reference external" href="https://clang-analyzer.llvm.org/annotations.html">annotations</a> and the
analyzer’s <a class="reference external" href="https://clang-analyzer.llvm.org/faq.html#exclude_code">FAQ
page</a> for more
information.</p>
</section>
</section>
<section id="precompiled-headers">
<span id="usersmanual-precompiled-headers"></span><h3><a class="toc-backref" href="#id32" role="doc-backlink">Precompiled Headers</a><a class="headerlink" href="#precompiled-headers" title="Link to this heading">¶</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Precompiled_header">Precompiled headers</a>
are a general approach employed by many compilers to reduce compilation
time. The underlying motivation of the approach is that it is common for
the same (and often large) header files to be included by multiple
source files. Consequently, compile times can often be greatly improved
by caching some of the (redundant) work done by a compiler to process
headers. Precompiled header files, which represent one of many ways to
implement this optimization, are literally files that represent an
on-disk cache that contains the vital information necessary to reduce
some of the work needed to process a corresponding header file. While
details of precompiled headers vary between compilers, precompiled
headers have been shown to be highly effective at speeding up program
compilation on systems with very large system headers (e.g., macOS).</p>
<section id="generating-a-pch-file">
<h4><a class="toc-backref" href="#id33" role="doc-backlink">Generating a PCH File</a><a class="headerlink" href="#generating-a-pch-file" title="Link to this heading">¶</a></h4>
<p>To generate a PCH file using Clang, one invokes Clang with the
<cite>-x &lt;language&gt;-header</cite> option. This mirrors the interface in GCC
for generating PCH files:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>gcc<span class="w"> </span>-x<span class="w"> </span>c-header<span class="w"> </span>test.h<span class="w"> </span>-o<span class="w"> </span>test.h.gch
<span class="gp">$ </span>clang<span class="w"> </span>-x<span class="w"> </span>c-header<span class="w"> </span>test.h<span class="w"> </span>-o<span class="w"> </span>test.h.pch
</pre></div>
</div>
</section>
<section id="using-a-pch-file">
<h4><a class="toc-backref" href="#id34" role="doc-backlink">Using a PCH File</a><a class="headerlink" href="#using-a-pch-file" title="Link to this heading">¶</a></h4>
<p>A PCH file can then be used as a prefix header when a <a class="reference internal" href="CommandGuide/clang.html#cmdoption-include"><code class="xref std std-option docutils literal notranslate"><span class="pre">-include</span></code></a>
option is passed to <code class="docutils literal notranslate"><span class="pre">clang</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>-include<span class="w"> </span>test.h<span class="w"> </span>test.c<span class="w"> </span>-o<span class="w"> </span><span class="nb">test</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">clang</span></code> driver will first check if a PCH file for <code class="docutils literal notranslate"><span class="pre">test.h</span></code> is
available; if so, the contents of <code class="docutils literal notranslate"><span class="pre">test.h</span></code> (and the files it includes)
will be processed from the PCH file. Otherwise, Clang falls back to
directly processing the content of <code class="docutils literal notranslate"><span class="pre">test.h</span></code>. This mirrors the behavior
of GCC.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Clang does <em>not</em> automatically use PCH files for headers that are directly
included within a source file. For example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>-x<span class="w"> </span>c-header<span class="w"> </span>test.h<span class="w"> </span>-o<span class="w"> </span>test.h.pch
<span class="gp">$ </span>cat<span class="w"> </span>test.c
<span class="gp">#</span>include<span class="w"> </span><span class="s2">&quot;test.h&quot;</span>
<span class="gp">$ </span>clang<span class="w"> </span>test.c<span class="w"> </span>-o<span class="w"> </span><span class="nb">test</span>
</pre></div>
</div>
<p>In this example, <code class="docutils literal notranslate"><span class="pre">clang</span></code> will not automatically use the PCH file for
<code class="docutils literal notranslate"><span class="pre">test.h</span></code> since <code class="docutils literal notranslate"><span class="pre">test.h</span></code> was included directly in the source file and not
specified on the command line using <a class="reference internal" href="CommandGuide/clang.html#cmdoption-include"><code class="xref std std-option docutils literal notranslate"><span class="pre">-include</span></code></a>.</p>
</div>
</section>
<section id="relocatable-pch-files">
<h4><a class="toc-backref" href="#id35" role="doc-backlink">Relocatable PCH Files</a><a class="headerlink" href="#relocatable-pch-files" title="Link to this heading">¶</a></h4>
<p>It is sometimes necessary to build a precompiled header from headers
that are not yet in their final, installed locations. For example, one
might build a precompiled header within the build tree that is then
meant to be installed alongside the headers. Clang permits the creation
of “relocatable” precompiled headers, which are built with a given path
(into the build directory) and can later be used from an installed
location.</p>
<p>To build a relocatable precompiled header, place your headers into a
subdirectory whose structure mimics the installed location. For example,
if you want to build a precompiled header for the header <code class="docutils literal notranslate"><span class="pre">mylib.h</span></code>
that will be installed into <code class="docutils literal notranslate"><span class="pre">/usr/include</span></code>, create a subdirectory
<code class="docutils literal notranslate"><span class="pre">build/usr/include</span></code> and place the header <code class="docutils literal notranslate"><span class="pre">mylib.h</span></code> into that
subdirectory. If <code class="docutils literal notranslate"><span class="pre">mylib.h</span></code> depends on other headers, then they can be
stored within <code class="docutils literal notranslate"><span class="pre">build/usr/include</span></code> in a way that mimics the installed
location.</p>
<p>Building a relocatable precompiled header requires two additional
arguments. First, pass the <code class="docutils literal notranslate"><span class="pre">--relocatable-pch</span></code> flag to indicate that
the resulting PCH file should be relocatable. Second, pass
<code class="docutils literal notranslate"><span class="pre">-isysroot</span> <span class="pre">/path/to/build</span></code>, which makes all includes for your library
relative to the build directory. For example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>clang<span class="w"> </span>-x<span class="w"> </span>c-header<span class="w"> </span>--relocatable-pch<span class="w"> </span>-isysroot<span class="w"> </span>/path/to/build<span class="w"> </span>/path/to/build/mylib.h<span class="w"> </span>mylib.h.pch
</pre></div>
</div>
<p>When loading the relocatable PCH file, the various headers used in the
PCH file are found from the system header root. For example, <code class="docutils literal notranslate"><span class="pre">mylib.h</span></code>
can be found in <code class="docutils literal notranslate"><span class="pre">/usr/include/mylib.h</span></code>. If the headers are installed
in some other system root, the <code class="docutils literal notranslate"><span class="pre">-isysroot</span></code> option can be used provide
a different system root from which the headers will be based. For
example, <code class="docutils literal notranslate"><span class="pre">-isysroot</span> <span class="pre">/Developer/SDKs/MacOSX10.4u.sdk</span></code> will look for
<code class="docutils literal notranslate"><span class="pre">mylib.h</span></code> in <code class="docutils literal notranslate"><span class="pre">/Developer/SDKs/MacOSX10.4u.sdk/usr/include/mylib.h</span></code>.</p>
<p>Relocatable precompiled headers are intended to be used in a limited
number of cases where the compilation environment is tightly controlled
and the precompiled header cannot be generated after headers have been
installed.</p>
</section>
</section>
<section id="controlling-code-generation">
<span id="id3"></span><h3><a class="toc-backref" href="#id36" role="doc-backlink">Controlling Code Generation</a><a class="headerlink" href="#controlling-code-generation" title="Link to this heading">¶</a></h3>
<p>Clang provides a number of ways to control code generation. The options
are listed below.</p>
<dl>
<dt><strong>-f[no-]sanitize=check1,check2,…</strong></dt><dd><p>Turn on runtime checks for various forms of undefined or suspicious
behavior.</p>
<p>This option controls whether Clang adds runtime checks for various
forms of undefined or suspicious behavior, and is disabled by
default. If a check fails, a diagnostic message is produced at
runtime explaining the problem. The main checks are:</p>
<ul class="simple">
<li><p id="opt-fsanitize-address"><code class="docutils literal notranslate"><span class="pre">-fsanitize=address</span></code>:
<a class="reference internal" href="AddressSanitizer.html"><span class="doc">AddressSanitizer</span></a>, a memory error
detector.</p>
</li>
<li><p id="opt-fsanitize-thread"><code class="docutils literal notranslate"><span class="pre">-fsanitize=thread</span></code>: <a class="reference internal" href="ThreadSanitizer.html"><span class="doc">ThreadSanitizer</span></a>, a data race detector.</p>
</li>
<li><p id="opt-fsanitize-memory"><code class="docutils literal notranslate"><span class="pre">-fsanitize=memory</span></code>: <a class="reference internal" href="MemorySanitizer.html"><span class="doc">MemorySanitizer</span></a>,
a detector of uninitialized reads. Requires instrumentation of all
program code.</p>
</li>
<li><p id="opt-fsanitize-undefined"><code class="docutils literal notranslate"><span class="pre">-fsanitize=undefined</span></code>: <a class="reference internal" href="UndefinedBehaviorSanitizer.html"><span class="doc">UndefinedBehaviorSanitizer</span></a>,
a fast and compatible undefined behavior checker.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">-fsanitize=dataflow</span></code>: <a class="reference internal" href="DataFlowSanitizer.html"><span class="doc">DataFlowSanitizer</span></a>, a general data
flow analysis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-fsanitize=cfi</span></code>: <a class="reference internal" href="ControlFlowIntegrity.html"><span class="doc">control flow integrity</span></a>
checks. Requires <code class="docutils literal notranslate"><span class="pre">-flto</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-fsanitize=safe-stack</span></code>: <a class="reference internal" href="SafeStack.html"><span class="doc">safe stack</span></a>
protection against stack-based memory corruption errors.</p></li>
</ul>
<p>There are more fine-grained checks available: see
the <a class="reference internal" href="UndefinedBehaviorSanitizer.html#ubsan-checks"><span class="std std-ref">list</span></a> of specific kinds of
undefined behavior that can be detected and the <a class="reference internal" href="ControlFlowIntegrity.html#cfi-schemes"><span class="std std-ref">list</span></a>
of control flow integrity schemes.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">-fsanitize=</span></code> argument must also be provided when linking, in
order to link to the appropriate runtime library.</p>
<p>It is not possible to combine more than one of the <code class="docutils literal notranslate"><span class="pre">-fsanitize=address</span></code>,
<code class="docutils literal notranslate"><span class="pre">-fsanitize=thread</span></code>, and <code class="docutils literal notranslate"><span class="pre">-fsanitize=memory</span></code> checkers in the same
program.</p>
</dd>
</dl>
<p><strong>-f[no-]sanitize-recover=check1,check2,…</strong></p>
<p><strong>-f[no-]sanitize-recover=all</strong></p>
<blockquote>
<div><p>Controls which checks enabled by <code class="docutils literal notranslate"><span class="pre">-fsanitize=</span></code> flag are non-fatal.
If the check is fatal, program will halt after the first error
of this kind is detected and error report is printed.</p>
<p>By default, non-fatal checks are those enabled by
<a class="reference internal" href="UndefinedBehaviorSanitizer.html"><span class="doc">UndefinedBehaviorSanitizer</span></a>,
except for <code class="docutils literal notranslate"><span class="pre">-fsanitize=return</span></code> and <code class="docutils literal notranslate"><span class="pre">-fsanitize=unreachable</span></code>. Some
sanitizers may not support recovery (or not support it by default
e.g. <a class="reference internal" href="AddressSanitizer.html"><span class="doc">AddressSanitizer</span></a>), and always crash the program after the issue
is detected.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">-fsanitize-trap</span></code> flag has precedence over this flag.
This means that if a check has been configured to trap elsewhere on the
command line, or if the check traps by default, this flag will not have
any effect unless that sanitizer’s trapping behavior is disabled with
<code class="docutils literal notranslate"><span class="pre">-fno-sanitize-trap</span></code>.</p>
<p>For example, if a command line contains the flags <code class="docutils literal notranslate"><span class="pre">-fsanitize=undefined</span>
<span class="pre">-fsanitize-trap=undefined</span></code>, the flag <code class="docutils literal notranslate"><span class="pre">-fsanitize-recover=alignment</span></code>
will have no effect on its own; it will need to be accompanied by
<code class="docutils literal notranslate"><span class="pre">-fno-sanitize-trap=alignment</span></code>.</p>
</div></blockquote>
<p><strong>-f[no-]sanitize-trap=check1,check2,…</strong></p>
<blockquote>
<div><p>Controls which checks enabled by the <code class="docutils literal notranslate"><span class="pre">-fsanitize=</span></code> flag trap. This
option is intended for use in cases where the sanitizer runtime cannot
be used (for instance, when building libc or a kernel module), or where
the binary size increase caused by the sanitizer runtime is a concern.</p>
<p>This flag is only compatible with <a class="reference internal" href="ControlFlowIntegrity.html"><span class="doc">control flow integrity</span></a> schemes and <a class="reference internal" href="UndefinedBehaviorSanitizer.html"><span class="doc">UndefinedBehaviorSanitizer</span></a>
checks other than <code class="docutils literal notranslate"><span class="pre">vptr</span></code>. If this flag
is supplied together with <code class="docutils literal notranslate"><span class="pre">-fsanitize=undefined</span></code>, the <code class="docutils literal notranslate"><span class="pre">vptr</span></code> sanitizer
will be implicitly disabled.</p>
<p>This flag is enabled by default for sanitizers in the <code class="docutils literal notranslate"><span class="pre">cfi</span></code> group.</p>
</div></blockquote>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fsanitize-blacklist">
<span class="sig-name descname"><span class="pre">-fsanitize-blacklist</span></span><span class="sig-prename descclassname"><span class="pre">=/path/to/blacklist/file</span></span><a class="headerlink" href="#cmdoption-fsanitize-blacklist" title="Link to this definition">¶</a></dt>
<dd><p>Disable or modify sanitizer checks for objects (source files, functions,
variables, types) listed in the file. See
<a class="reference internal" href="SanitizerSpecialCaseList.html"><span class="doc">Sanitizer special case list</span></a> for file format description.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fno-sanitize-blacklist">
<span class="sig-name descname"><span class="pre">-fno-sanitize-blacklist</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fno-sanitize-blacklist" title="Link to this definition">¶</a></dt>
<dd><p>Don’t use blacklist file, if it was specified earlier in the command line.</p>
</dd></dl>

<p><strong>-f[no-]sanitize-coverage=[type,features,…]</strong></p>
<blockquote>
<div><p>Enable simple code coverage in addition to certain sanitizers.
See <a class="reference internal" href="SanitizerCoverage.html"><span class="doc">SanitizerCoverage</span></a> for more details.</p>
</div></blockquote>
<p><strong>-f[no-]sanitize-stats</strong></p>
<blockquote>
<div><p>Enable simple statistics gathering for the enabled sanitizers.
See <a class="reference internal" href="SanitizerStats.html"><span class="doc">SanitizerStats</span></a> for more details.</p>
</div></blockquote>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fsanitize-undefined-trap-on-error">
<span class="sig-name descname"><span class="pre">-fsanitize-undefined-trap-on-error</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fsanitize-undefined-trap-on-error" title="Link to this definition">¶</a></dt>
<dd><p>Deprecated alias for <code class="docutils literal notranslate"><span class="pre">-fsanitize-trap=undefined</span></code>.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fsanitize-cfi-cross-dso">
<span class="sig-name descname"><span class="pre">-fsanitize-cfi-cross-dso</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fsanitize-cfi-cross-dso" title="Link to this definition">¶</a></dt>
<dd><p>Enable cross-DSO control flow integrity checks. This flag modifies
the behavior of sanitizers in the <code class="docutils literal notranslate"><span class="pre">cfi</span></code> group to allow checking
of cross-DSO virtual and indirect calls.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fsanitize-cfi-icall-generalize-pointers">
<span class="sig-name descname"><span class="pre">-fsanitize-cfi-icall-generalize-pointers</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fsanitize-cfi-icall-generalize-pointers" title="Link to this definition">¶</a></dt>
<dd><p>Generalize pointers in return and argument types in function type signatures
checked by Control Flow Integrity indirect call checking. See
<a class="reference internal" href="ControlFlowIntegrity.html"><span class="doc">Control Flow Integrity</span></a> for more details.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fstrict-vtable-pointers">
<span class="sig-name descname"><span class="pre">-fstrict-vtable-pointers</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fstrict-vtable-pointers" title="Link to this definition">¶</a></dt>
<dd><p>Enable optimizations based on the strict rules for overwriting polymorphic
C++ objects, i.e. the vptr is invariant during an object’s lifetime.
This enables better devirtualization. Turned off by default, because it is
still experimental.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-ffast-math">
<span class="sig-name descname"><span class="pre">-ffast-math</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-ffast-math" title="Link to this definition">¶</a></dt>
<dd><p>Enable fast-math mode. This defines the <code class="docutils literal notranslate"><span class="pre">__FAST_MATH__</span></code> preprocessor
macro, and lets the compiler make aggressive, potentially-lossy assumptions
about floating-point math.  These include:</p>
<ul class="simple">
<li><p>Floating-point math obeys regular algebraic rules for real numbers (e.g.
<code class="docutils literal notranslate"><span class="pre">+</span></code> and <code class="docutils literal notranslate"><span class="pre">*</span></code> are associative, <code class="docutils literal notranslate"><span class="pre">x/y</span> <span class="pre">==</span> <span class="pre">x</span> <span class="pre">*</span> <span class="pre">(1/y)</span></code>, and
<code class="docutils literal notranslate"><span class="pre">(a</span> <span class="pre">+</span> <span class="pre">b)</span> <span class="pre">*</span> <span class="pre">c</span> <span class="pre">==</span> <span class="pre">a</span> <span class="pre">*</span> <span class="pre">c</span> <span class="pre">+</span> <span class="pre">b</span> <span class="pre">*</span> <span class="pre">c</span></code>),</p></li>
<li><p>operands to floating-point operations are not equal to <code class="docutils literal notranslate"><span class="pre">NaN</span></code> and
<code class="docutils literal notranslate"><span class="pre">Inf</span></code>, and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">+0</span></code> and <code class="docutils literal notranslate"><span class="pre">-0</span></code> are interchangeable.</p></li>
</ul>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fdenormal-fp-math">
<span class="sig-name descname"><span class="pre">-fdenormal-fp-math</span></span><span class="sig-prename descclassname"><span class="pre">=[values]</span></span><a class="headerlink" href="#cmdoption-fdenormal-fp-math" title="Link to this definition">¶</a></dt>
<dd><p>Select which denormal numbers the code is permitted to require.</p>
<p>Valid values are: <code class="docutils literal notranslate"><span class="pre">ieee</span></code>, <code class="docutils literal notranslate"><span class="pre">preserve-sign</span></code>, and <code class="docutils literal notranslate"><span class="pre">positive-zero</span></code>,
which correspond to IEEE 754 denormal numbers, the sign of a
flushed-to-zero number is preserved in the sign of 0, denormals are
flushed to positive zero, respectively.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-f-no-strict-float-cast-overflow">
<span class="sig-name descname"><span class="pre">-f[no-]strict-float-cast-overflow</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-f-no-strict-float-cast-overflow" title="Link to this definition">¶</a></dt>
<dd><p>When a floating-point value is not representable in a destination integer
type, the code has undefined behavior according to the language standard.
By default, Clang will not guarantee any particular result in that case.
With the ‘no-strict’ option, Clang attempts to match the overflowing behavior
of the target’s native float-to-int conversion instructions.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fwhole-program-vtables">
<span class="sig-name descname"><span class="pre">-fwhole-program-vtables</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fwhole-program-vtables" title="Link to this definition">¶</a></dt>
<dd><p>Enable whole-program vtable optimizations, such as single-implementation
devirtualization and virtual constant propagation, for classes with
<a class="reference internal" href="LTOVisibility.html"><span class="doc">hidden LTO visibility</span></a>. Requires <code class="docutils literal notranslate"><span class="pre">-flto</span></code>.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fforce-emit-vtables">
<span class="sig-name descname"><span class="pre">-fforce-emit-vtables</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fforce-emit-vtables" title="Link to this definition">¶</a></dt>
<dd><p>In order to improve devirtualization, forces emitting of vtables even in
modules where it isn’t necessary. It causes more inline virtual functions
to be emitted.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fno-assume-sane-operator-new">
<span class="sig-name descname"><span class="pre">-fno-assume-sane-operator-new</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fno-assume-sane-operator-new" title="Link to this definition">¶</a></dt>
<dd><p>Don’t assume that the C++’s new operator is sane.</p>
<p>This option tells the compiler to do not assume that C++’s global
new operator will always return a pointer that does not alias any
other pointer when the function returns.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-ftrap-function">
<span class="sig-name descname"><span class="pre">-ftrap-function</span></span><span class="sig-prename descclassname"><span class="pre">=[name]</span></span><a class="headerlink" href="#cmdoption-ftrap-function" title="Link to this definition">¶</a></dt>
<dd><p>Instruct code generator to emit a function call to the specified
function name for <code class="docutils literal notranslate"><span class="pre">__builtin_trap()</span></code>.</p>
<p>LLVM code generator translates <code class="docutils literal notranslate"><span class="pre">__builtin_trap()</span></code> to a trap
instruction if it is supported by the target ISA. Otherwise, the
builtin is translated into a call to <code class="docutils literal notranslate"><span class="pre">abort</span></code>. If this option is
set, then the code generator will always lower the builtin to a call
to the specified function regardless of whether the target ISA has a
trap instruction. This option is useful for environments (e.g.
deeply embedded) where a trap cannot be properly handled, or when
some custom behavior is desired.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-ftls-model">
<span class="sig-name descname"><span class="pre">-ftls-model</span></span><span class="sig-prename descclassname"><span class="pre">=[model]</span></span><a class="headerlink" href="#cmdoption-ftls-model" title="Link to this definition">¶</a></dt>
<dd><p>Select which TLS model to use.</p>
<p>Valid values are: <code class="docutils literal notranslate"><span class="pre">global-dynamic</span></code>, <code class="docutils literal notranslate"><span class="pre">local-dynamic</span></code>,
<code class="docutils literal notranslate"><span class="pre">initial-exec</span></code> and <code class="docutils literal notranslate"><span class="pre">local-exec</span></code>. The default value is
<code class="docutils literal notranslate"><span class="pre">global-dynamic</span></code>. The compiler may use a different model if the
selected model is not supported by the target, or if a more
efficient model can be used. The TLS model can be overridden per
variable using the <code class="docutils literal notranslate"><span class="pre">tls_model</span></code> attribute.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-femulated-tls">
<span class="sig-name descname"><span class="pre">-femulated-tls</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-femulated-tls" title="Link to this definition">¶</a></dt>
<dd><p>Select emulated TLS model, which overrides all -ftls-model choices.</p>
<p>In emulated TLS mode, all access to TLS variables are converted to
calls to __emutls_get_address in the runtime library.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-mhwdiv">
<span class="sig-name descname"><span class="pre">-mhwdiv</span></span><span class="sig-prename descclassname"><span class="pre">=[values]</span></span><a class="headerlink" href="#cmdoption-mhwdiv" title="Link to this definition">¶</a></dt>
<dd><p>Select the ARM modes (arm or thumb) that support hardware division
instructions.</p>
<p>Valid values are: <code class="docutils literal notranslate"><span class="pre">arm</span></code>, <code class="docutils literal notranslate"><span class="pre">thumb</span></code> and <code class="docutils literal notranslate"><span class="pre">arm,thumb</span></code>.
This option is used to indicate which mode (arm or thumb) supports
hardware division instructions. This only applies to the ARM
architecture.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-m-no-crc">
<span class="sig-name descname"><span class="pre">-m[no-]crc</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-m-no-crc" title="Link to this definition">¶</a></dt>
<dd><p>Enable or disable CRC instructions.</p>
<p>This option is used to indicate whether CRC instructions are to
be generated. This only applies to the ARM architecture.</p>
<p>CRC instructions are enabled by default on ARMv8.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-mgeneral-regs-only">
<span class="sig-name descname"><span class="pre">-mgeneral-regs-only</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-mgeneral-regs-only" title="Link to this definition">¶</a></dt>
<dd><p>Generate code which only uses the general purpose registers.</p>
<p>This option restricts the generated code to use general registers
only. This only applies to the AArch64 architecture.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-mcompact-branches">
<span class="sig-name descname"><span class="pre">-mcompact-branches</span></span><span class="sig-prename descclassname"><span class="pre">=[values]</span></span><a class="headerlink" href="#cmdoption-mcompact-branches" title="Link to this definition">¶</a></dt>
<dd><p>Control the usage of compact branches for MIPSR6.</p>
<p>Valid values are: <code class="docutils literal notranslate"><span class="pre">never</span></code>, <code class="docutils literal notranslate"><span class="pre">optimal</span></code> and <code class="docutils literal notranslate"><span class="pre">always</span></code>.
The default value is <code class="docutils literal notranslate"><span class="pre">optimal</span></code> which generates compact branches
when a delay slot cannot be filled. <code class="docutils literal notranslate"><span class="pre">never</span></code> disables the usage of
compact branches and <code class="docutils literal notranslate"><span class="pre">always</span></code> generates compact branches whenever
possible.</p>
</dd></dl>

<dl>
<dt><strong>-f[no-]max-type-align=[number]</strong></dt><dd><p>Instruct the code generator to not enforce a higher alignment than the given
number (of bytes) when accessing memory via an opaque pointer or reference.
This cap is ignored when directly accessing a variable or when the pointee
type has an explicit “aligned” attribute.</p>
<p>The value should usually be determined by the properties of the system allocator.
Some builtin types, especially vector types, have very high natural alignments;
when working with values of those types, Clang usually wants to use instructions
that take advantage of that alignment.  However, many system allocators do
not promise to return memory that is more than 8-byte or 16-byte-aligned.  Use
this option to limit the alignment that the compiler can assume for an arbitrary
pointer, which may point onto the heap.</p>
<p>This option does not affect the ABI alignment of types; the layout of structs and
unions and the value returned by the alignof operator remain the same.</p>
<p>This option can be overridden on a case-by-case basis by putting an explicit
“aligned” alignment on a struct, union, or typedef.  For example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span>include<span class="w"> </span>&lt;immintrin.h&gt;
<span class="go">// Make an aligned typedef of the AVX-512 16-int vector type.</span>
<span class="go">typedef __v16si __aligned_v16si __attribute__((aligned(64)));</span>

<span class="go">void initialize_vector(__aligned_v16si *v) {</span>
<span class="go">  // The compiler may assume that ‘v’ is 64-byte aligned, regardless of the</span>
<span class="go">  // value of -fmax-type-align.</span>
<span class="go">}</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-faddrsig">
<span id="cmdoption-fno-addrsig"></span><span class="sig-name descname"><span class="pre">-faddrsig</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">-fno-addrsig</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-faddrsig" title="Link to this definition">¶</a></dt>
<dd><p>Controls whether Clang emits an address-significance table into the object
file. Address-significance tables allow linkers to implement <a class="reference external" href="https://research.google.com/pubs/archive/36912.pdf">safe ICF</a> without the false
positives that can result from other implementation techniques such as
relocation scanning. Address-significance tables are enabled by default
on ELF targets when using the integrated assembler. This flag currently
only has an effect on ELF targets.</p>
</dd></dl>

</section>
<section id="profile-guided-optimization">
<h3><a class="toc-backref" href="#id37" role="doc-backlink">Profile Guided Optimization</a><a class="headerlink" href="#profile-guided-optimization" title="Link to this heading">¶</a></h3>
<p>Profile information enables better optimization. For example, knowing that a
branch is taken very frequently helps the compiler make better decisions when
ordering basic blocks. Knowing that a function <code class="docutils literal notranslate"><span class="pre">foo</span></code> is called more
frequently than another function <code class="docutils literal notranslate"><span class="pre">bar</span></code> helps the inliner. Optimization
levels <code class="docutils literal notranslate"><span class="pre">-O2</span></code> and above are recommended for use of profile guided optimization.</p>
<p>Clang supports profile guided optimization with two different kinds of
profiling. A sampling profiler can generate a profile with very low runtime
overhead, or you can build an instrumented version of the code that collects
more detailed profile information. Both kinds of profiles can provide execution
counts for instructions in the code and information on branches taken and
function invocation.</p>
<p>Regardless of which kind of profiling you use, be careful to collect profiles
by running your code with inputs that are representative of the typical
behavior. Code that is not exercised in the profile will be optimized as if it
is unimportant, and the compiler may make poor optimization choices for code
that is disproportionately used while profiling.</p>
<section id="differences-between-sampling-and-instrumentation">
<h4><a class="toc-backref" href="#id38" role="doc-backlink">Differences Between Sampling and Instrumentation</a><a class="headerlink" href="#differences-between-sampling-and-instrumentation" title="Link to this heading">¶</a></h4>
<p>Although both techniques are used for similar purposes, there are important
differences between the two:</p>
<ol class="arabic simple">
<li><p>Profile data generated with one cannot be used by the other, and there is no
conversion tool that can convert one to the other. So, a profile generated
via <code class="docutils literal notranslate"><span class="pre">-fprofile-instr-generate</span></code> must be used with <code class="docutils literal notranslate"><span class="pre">-fprofile-instr-use</span></code>.
Similarly, sampling profiles generated by external profilers must be
converted and used with <code class="docutils literal notranslate"><span class="pre">-fprofile-sample-use</span></code>.</p></li>
<li><p>Instrumentation profile data can be used for code coverage analysis and
optimization.</p></li>
<li><p>Sampling profiles can only be used for optimization. They cannot be used for
code coverage analysis. Although it would be technically possible to use
sampling profiles for code coverage, sample-based profiles are too
coarse-grained for code coverage purposes; it would yield poor results.</p></li>
<li><p>Sampling profiles must be generated by an external tool. The profile
generated by that tool must then be converted into a format that can be read
by LLVM. The section on sampling profilers describes one of the supported
sampling profile formats.</p></li>
</ol>
</section>
<section id="using-sampling-profilers">
<h4><a class="toc-backref" href="#id39" role="doc-backlink">Using Sampling Profilers</a><a class="headerlink" href="#using-sampling-profilers" title="Link to this heading">¶</a></h4>
<p>Sampling profilers are used to collect runtime information, such as
hardware counters, while your application executes. They are typically
very efficient and do not incur a large runtime overhead. The
sample data collected by the profiler can be used during compilation
to determine what the most executed areas of the code are.</p>
<p>Using the data from a sample profiler requires some changes in the way
a program is built. Before the compiler can use profiling information,
the code needs to execute under the profiler. The following is the
usual build cycle when using sample profilers for optimization:</p>
<ol class="arabic">
<li><p>Build the code with source line table information. You can use all the
usual build flags that you always build your application with. The only
requirement is that you add <code class="docutils literal notranslate"><span class="pre">-gline-tables-only</span></code> or <code class="docutils literal notranslate"><span class="pre">-g</span></code> to the
command line. This is important for the profiler to be able to map
instructions back to source line locations.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang++<span class="w"> </span>-O2<span class="w"> </span>-gline-tables-only<span class="w"> </span>code.cc<span class="w"> </span>-o<span class="w"> </span>code
</pre></div>
</div>
</li>
<li><p>Run the executable under a sampling profiler. The specific profiler
you use does not really matter, as long as its output can be converted
into the format that the LLVM optimizer understands. Currently, there
exists a conversion tool for the Linux Perf profiler
(<a class="reference external" href="https://perf.wiki.kernel.org/">https://perf.wiki.kernel.org/</a>), so these examples assume that you
are using Linux Perf to profile your code.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>perf<span class="w"> </span>record<span class="w"> </span>-b<span class="w"> </span>./code
</pre></div>
</div>
<p>Note the use of the <code class="docutils literal notranslate"><span class="pre">-b</span></code> flag. This tells Perf to use the Last Branch
Record (LBR) to record call chains. While this is not strictly required,
it provides better call information, which improves the accuracy of
the profile data.</p>
</li>
<li><p>Convert the collected profile data to LLVM’s sample profile format.
This is currently supported via the AutoFDO converter <code class="docutils literal notranslate"><span class="pre">create_llvm_prof</span></code>.
It is available at <a class="reference external" href="https://github.com/google/autofdo">https://github.com/google/autofdo</a>. Once built and
installed, you can convert the <code class="docutils literal notranslate"><span class="pre">perf.data</span></code> file to LLVM using
the command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>create_llvm_prof<span class="w"> </span>--binary<span class="o">=</span>./code<span class="w"> </span>--out<span class="o">=</span>code.prof
</pre></div>
</div>
<p>This will read <code class="docutils literal notranslate"><span class="pre">perf.data</span></code> and the binary file <code class="docutils literal notranslate"><span class="pre">./code</span></code> and emit
the profile data in <code class="docutils literal notranslate"><span class="pre">code.prof</span></code>. Note that if you ran <code class="docutils literal notranslate"><span class="pre">perf</span></code>
without the <code class="docutils literal notranslate"><span class="pre">-b</span></code> flag, you need to use <code class="docutils literal notranslate"><span class="pre">--use_lbr=false</span></code> when
calling <code class="docutils literal notranslate"><span class="pre">create_llvm_prof</span></code>.</p>
</li>
<li><p>Build the code again using the collected profile. This step feeds
the profile back to the optimizers. This should result in a binary
that executes faster than the original one. Note that you are not
required to build the code with the exact same arguments that you
used in the first step. The only requirement is that you build the code
with <code class="docutils literal notranslate"><span class="pre">-gline-tables-only</span></code> and <code class="docutils literal notranslate"><span class="pre">-fprofile-sample-use</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang++<span class="w"> </span>-O2<span class="w"> </span>-gline-tables-only<span class="w"> </span>-fprofile-sample-use<span class="o">=</span>code.prof<span class="w"> </span>code.cc<span class="w"> </span>-o<span class="w"> </span>code
</pre></div>
</div>
</li>
</ol>
<section id="sample-profile-formats">
<h5><a class="toc-backref" href="#id40" role="doc-backlink">Sample Profile Formats</a><a class="headerlink" href="#sample-profile-formats" title="Link to this heading">¶</a></h5>
<p>Since external profilers generate profile data in a variety of custom formats,
the data generated by the profiler must be converted into a format that can be
read by the backend. LLVM supports three different sample profile formats:</p>
<ol class="arabic simple">
<li><p>ASCII text. This is the easiest one to generate. The file is divided into
sections, which correspond to each of the functions with profile
information. The format is described below. It can also be generated from
the binary or gcov formats using the <code class="docutils literal notranslate"><span class="pre">llvm-profdata</span></code> tool.</p></li>
<li><p>Binary encoding. This uses a more efficient encoding that yields smaller
profile files. This is the format generated by the <code class="docutils literal notranslate"><span class="pre">create_llvm_prof</span></code> tool
in <a class="reference external" href="https://github.com/google/autofdo">https://github.com/google/autofdo</a>.</p></li>
<li><p>GCC encoding. This is based on the gcov format, which is accepted by GCC. It
is only interesting in environments where GCC and Clang co-exist. This
encoding is only generated by the <code class="docutils literal notranslate"><span class="pre">create_gcov</span></code> tool in
<a class="reference external" href="https://github.com/google/autofdo">https://github.com/google/autofdo</a>. It can be read by LLVM and
<code class="docutils literal notranslate"><span class="pre">llvm-profdata</span></code>, but it cannot be generated by either.</p></li>
</ol>
<p>If you are using Linux Perf to generate sampling profiles, you can use the
conversion tool <code class="docutils literal notranslate"><span class="pre">create_llvm_prof</span></code> described in the previous section.
Otherwise, you will need to write a conversion tool that converts your
profiler’s native format into one of these three.</p>
</section>
<section id="sample-profile-text-format">
<h5><a class="toc-backref" href="#id41" role="doc-backlink">Sample Profile Text Format</a><a class="headerlink" href="#sample-profile-text-format" title="Link to this heading">¶</a></h5>
<p>This section describes the ASCII text format for sampling profiles. It is,
arguably, the easiest one to generate. If you are interested in generating any
of the other two, consult the <code class="docutils literal notranslate"><span class="pre">ProfileData</span></code> library in LLVM’s source tree
(specifically, <code class="docutils literal notranslate"><span class="pre">include/llvm/ProfileData/SampleProfReader.h</span></code>).</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">function1:total_samples:total_head_samples</span>
<span class="go"> offset1[.discriminator]: number_of_samples [fn1:num fn2:num ... ]</span>
<span class="go"> offset2[.discriminator]: number_of_samples [fn3:num fn4:num ... ]</span>
<span class="go"> ...</span>
<span class="go"> offsetN[.discriminator]: number_of_samples [fn5:num fn6:num ... ]</span>
<span class="go"> offsetA[.discriminator]: fnA:num_of_total_samples</span>
<span class="go">  offsetA1[.discriminator]: number_of_samples [fn7:num fn8:num ... ]</span>
<span class="go">  offsetA1[.discriminator]: number_of_samples [fn9:num fn10:num ... ]</span>
<span class="go">  offsetB[.discriminator]: fnB:num_of_total_samples</span>
<span class="go">   offsetB1[.discriminator]: number_of_samples [fn11:num fn12:num ... ]</span>
</pre></div>
</div>
<p>This is a nested tree in which the indentation represents the nesting level
of the inline stack. There are no blank lines in the file. And the spacing
within a single line is fixed. Additional spaces will result in an error
while reading the file.</p>
<p>Any line starting with the ‘#’ character is completely ignored.</p>
<p>Inlined calls are represented with indentation. The Inline stack is a
stack of source locations in which the top of the stack represents the
leaf function, and the bottom of the stack represents the actual
symbol to which the instruction belongs.</p>
<p>Function names must be mangled in order for the profile loader to
match them in the current translation unit. The two numbers in the
function header specify how many total samples were accumulated in the
function (first number), and the total number of samples accumulated
in the prologue of the function (second number). This head sample
count provides an indicator of how frequently the function is invoked.</p>
<p>There are two types of lines in the function body.</p>
<ul class="simple">
<li><p>Sampled line represents the profile information of a source location.
<code class="docutils literal notranslate"><span class="pre">offsetN[.discriminator]:</span> <span class="pre">number_of_samples</span> <span class="pre">[fn5:num</span> <span class="pre">fn6:num</span> <span class="pre">...</span> <span class="pre">]</span></code></p></li>
<li><p>Callsite line represents the profile information of an inlined callsite.
<code class="docutils literal notranslate"><span class="pre">offsetA[.discriminator]:</span> <span class="pre">fnA:num_of_total_samples</span></code></p></li>
</ul>
<p>Each sampled line may contain several items. Some are optional (marked
below):</p>
<ol class="loweralpha">
<li><p>Source line offset. This number represents the line number
in the function where the sample was collected. The line number is
always relative to the line where symbol of the function is
defined. So, if the function has its header at line 280, the offset
13 is at line 293 in the file.</p>
<p>Note that this offset should never be a negative number. This could
happen in cases like macros. The debug machinery will register the
line number at the point of macro expansion. So, if the macro was
expanded in a line before the start of the function, the profile
converter should emit a 0 as the offset (this means that the optimizers
will not be able to associate a meaningful weight to the instructions
in the macro).</p>
</li>
<li><p>[OPTIONAL] Discriminator. This is used if the sampled program
was compiled with DWARF discriminator support
(<a class="reference external" href="http://wiki.dwarfstd.org/index.php?title=Path_Discriminators">http://wiki.dwarfstd.org/index.php?title=Path_Discriminators</a>).
DWARF discriminators are unsigned integer values that allow the
compiler to distinguish between multiple execution paths on the
same source line location.</p>
<p>For example, consider the line of code <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">(cond)</span> <span class="pre">foo();</span> <span class="pre">else</span> <span class="pre">bar();</span></code>.
If the predicate <code class="docutils literal notranslate"><span class="pre">cond</span></code> is true 80% of the time, then the edge
into function <code class="docutils literal notranslate"><span class="pre">foo</span></code> should be considered to be taken most of the
time. But both calls to <code class="docutils literal notranslate"><span class="pre">foo</span></code> and <code class="docutils literal notranslate"><span class="pre">bar</span></code> are at the same source
line, so a sample count at that line is not sufficient. The
compiler needs to know which part of that line is taken more
frequently.</p>
<p>This is what discriminators provide. In this case, the calls to
<code class="docutils literal notranslate"><span class="pre">foo</span></code> and <code class="docutils literal notranslate"><span class="pre">bar</span></code> will be at the same line, but will have
different discriminator values. This allows the compiler to correctly
set edge weights into <code class="docutils literal notranslate"><span class="pre">foo</span></code> and <code class="docutils literal notranslate"><span class="pre">bar</span></code>.</p>
</li>
<li><p>Number of samples. This is an integer quantity representing the
number of samples collected by the profiler at this source
location.</p></li>
<li><p>[OPTIONAL] Potential call targets and samples. If present, this
line contains a call instruction. This models both direct and
number of samples. For example,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">130: 7  foo:3  bar:2  baz:7</span>
</pre></div>
</div>
<p>The above means that at relative line offset 130 there is a call
instruction that calls one of <code class="docutils literal notranslate"><span class="pre">foo()</span></code>, <code class="docutils literal notranslate"><span class="pre">bar()</span></code> and <code class="docutils literal notranslate"><span class="pre">baz()</span></code>,
with <code class="docutils literal notranslate"><span class="pre">baz()</span></code> being the relatively more frequently called target.</p>
</li>
</ol>
<p>As an example, consider a program with the call chain <code class="docutils literal notranslate"><span class="pre">main</span> <span class="pre">-&gt;</span> <span class="pre">foo</span> <span class="pre">-&gt;</span> <span class="pre">bar</span></code>.
When built with optimizations enabled, the compiler may inline the
calls to <code class="docutils literal notranslate"><span class="pre">bar</span></code> and <code class="docutils literal notranslate"><span class="pre">foo</span></code> inside <code class="docutils literal notranslate"><span class="pre">main</span></code>. The generated profile
could then be something like this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">main:35504:0</span>
<span class="go">1: _Z3foov:35504</span>
<span class="go">  2: _Z32bari:31977</span>
<span class="go">  1.1: 31977</span>
<span class="go">2: 0</span>
</pre></div>
</div>
<p>This profile indicates that there were a total of 35,504 samples
collected in main. All of those were at line 1 (the call to <code class="docutils literal notranslate"><span class="pre">foo</span></code>).
Of those, 31,977 were spent inside the body of <code class="docutils literal notranslate"><span class="pre">bar</span></code>. The last line
of the profile (<code class="docutils literal notranslate"><span class="pre">2:</span> <span class="pre">0</span></code>) corresponds to line 2 inside <code class="docutils literal notranslate"><span class="pre">main</span></code>. No
samples were collected there.</p>
</section>
</section>
<section id="profiling-with-instrumentation">
<h4><a class="toc-backref" href="#id42" role="doc-backlink">Profiling with Instrumentation</a><a class="headerlink" href="#profiling-with-instrumentation" title="Link to this heading">¶</a></h4>
<p>Clang also supports profiling via instrumentation. This requires building a
special instrumented version of the code and has some runtime
overhead during the profiling, but it provides more detailed results than a
sampling profiler. It also provides reproducible results, at least to the
extent that the code behaves consistently across runs.</p>
<p>Here are the steps for using profile guided optimization with
instrumentation:</p>
<ol class="arabic">
<li><p>Build an instrumented version of the code by compiling and linking with the
<code class="docutils literal notranslate"><span class="pre">-fprofile-instr-generate</span></code> option.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang++<span class="w"> </span>-O2<span class="w"> </span>-fprofile-instr-generate<span class="w"> </span>code.cc<span class="w"> </span>-o<span class="w"> </span>code
</pre></div>
</div>
</li>
<li><p>Run the instrumented executable with inputs that reflect the typical usage.
By default, the profile data will be written to a <code class="docutils literal notranslate"><span class="pre">default.profraw</span></code> file
in the current directory. You can override that default by using option
<code class="docutils literal notranslate"><span class="pre">-fprofile-instr-generate=</span></code> or by setting the <code class="docutils literal notranslate"><span class="pre">LLVM_PROFILE_FILE</span></code>
environment variable to specify an alternate file. If non-default file name
is specified by both the environment variable and the command line option,
the environment variable takes precedence. The file name pattern specified
can include different modifiers: <code class="docutils literal notranslate"><span class="pre">%p</span></code>, <code class="docutils literal notranslate"><span class="pre">%h</span></code>, and <code class="docutils literal notranslate"><span class="pre">%m</span></code>.</p>
<p>Any instance of <code class="docutils literal notranslate"><span class="pre">%p</span></code> in that file name will be replaced by the process
ID, so that you can easily distinguish the profile output from multiple
runs.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">LLVM_PROFILE_FILE</span><span class="o">=</span><span class="s2">&quot;code-%p.profraw&quot;</span><span class="w"> </span>./code
</pre></div>
</div>
<p>The modifier <code class="docutils literal notranslate"><span class="pre">%h</span></code> can be used in scenarios where the same instrumented
binary is run in multiple different host machines dumping profile data
to a shared network based storage. The <code class="docutils literal notranslate"><span class="pre">%h</span></code> specifier will be substituted
with the hostname so that profiles collected from different hosts do not
clobber each other.</p>
<p>While the use of <code class="docutils literal notranslate"><span class="pre">%p</span></code> specifier can reduce the likelihood for the profiles
dumped from different processes to clobber each other, such clobbering can still
happen because of the <code class="docutils literal notranslate"><span class="pre">pid</span></code> re-use by the OS. Another side-effect of using
<code class="docutils literal notranslate"><span class="pre">%p</span></code> is that the storage requirement for raw profile data files is greatly
increased.  To avoid issues like this, the <code class="docutils literal notranslate"><span class="pre">%m</span></code> specifier can used in the profile
name.  When this specifier is used, the profiler runtime will substitute <code class="docutils literal notranslate"><span class="pre">%m</span></code>
with a unique integer identifier associated with the instrumented binary. Additionally,
multiple raw profiles dumped from different processes that share a file system (can be
on different hosts) will be automatically merged by the profiler runtime during the
dumping. If the program links in multiple instrumented shared libraries, each library
will dump the profile data into its own profile data file (with its unique integer
id embedded in the profile name). Note that the merging enabled by <code class="docutils literal notranslate"><span class="pre">%m</span></code> is for raw
profile data generated by profiler runtime. The resulting merged “raw” profile data
file still needs to be converted to a different format expected by the compiler (
see step 3 below).</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">LLVM_PROFILE_FILE</span><span class="o">=</span><span class="s2">&quot;code-%m.profraw&quot;</span><span class="w"> </span>./code
</pre></div>
</div>
</li>
<li><p>Combine profiles from multiple runs and convert the “raw” profile format to
the input expected by clang. Use the <code class="docutils literal notranslate"><span class="pre">merge</span></code> command of the
<code class="docutils literal notranslate"><span class="pre">llvm-profdata</span></code> tool to do this.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>llvm-profdata<span class="w"> </span>merge<span class="w"> </span>-output<span class="o">=</span>code.profdata<span class="w"> </span>code-*.profraw
</pre></div>
</div>
<p>Note that this step is necessary even when there is only one “raw” profile,
since the merge operation also changes the file format.</p>
</li>
<li><p>Build the code again using the <code class="docutils literal notranslate"><span class="pre">-fprofile-instr-use</span></code> option to specify the
collected profile data.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang++<span class="w"> </span>-O2<span class="w"> </span>-fprofile-instr-use<span class="o">=</span>code.profdata<span class="w"> </span>code.cc<span class="w"> </span>-o<span class="w"> </span>code
</pre></div>
</div>
<p>You can repeat step 4 as often as you like without regenerating the
profile. As you make changes to your code, clang may no longer be able to
use the profile data. It will warn you when this happens.</p>
</li>
</ol>
<p>Profile generation using an alternative instrumentation method can be
controlled by the GCC-compatible flags <code class="docutils literal notranslate"><span class="pre">-fprofile-generate</span></code> and
<code class="docutils literal notranslate"><span class="pre">-fprofile-use</span></code>. Although these flags are semantically equivalent to
their GCC counterparts, they <em>do not</em> handle GCC-compatible profiles.
They are only meant to implement GCC’s semantics with respect to
profile creation and use. Flag <code class="docutils literal notranslate"><span class="pre">-fcs-profile-generate</span></code> also instruments
programs using the same instrumentation method as <code class="docutils literal notranslate"><span class="pre">-fprofile-generate</span></code>.</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fprofile-generate">
<span class="sig-name descname"><span class="pre">-fprofile-generate</span></span><span class="sig-prename descclassname"><span class="pre">[=&lt;dirname&gt;]</span></span><a class="headerlink" href="#cmdoption-fprofile-generate" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>The <code class="docutils literal notranslate"><span class="pre">-fprofile-generate</span></code> and <code class="docutils literal notranslate"><span class="pre">-fprofile-generate=</span></code> flags will use
an alternative instrumentation method for profile generation. When
given a directory name, it generates the profile file
<code class="docutils literal notranslate"><span class="pre">default_%m.profraw</span></code> in the directory named <code class="docutils literal notranslate"><span class="pre">dirname</span></code> if specified.
If <code class="docutils literal notranslate"><span class="pre">dirname</span></code> does not exist, it will be created at runtime. <code class="docutils literal notranslate"><span class="pre">%m</span></code> specifier
will be substituted with a unique id documented in step 2 above. In other words,
with <code class="docutils literal notranslate"><span class="pre">-fprofile-generate[=&lt;dirname&gt;]</span></code> option, the “raw” profile data automatic
merging is turned on by default, so there will no longer any risk of profile
clobbering from different running processes.  For example,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang++<span class="w"> </span>-O2<span class="w"> </span>-fprofile-generate<span class="o">=</span>yyy/zzz<span class="w"> </span>code.cc<span class="w"> </span>-o<span class="w"> </span>code
</pre></div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">code</span></code> is executed, the profile will be written to the file
<code class="docutils literal notranslate"><span class="pre">yyy/zzz/default_xxxx.profraw</span></code>.</p>
<p>To generate the profile data file with the compiler readable format, the
<code class="docutils literal notranslate"><span class="pre">llvm-profdata</span></code> tool can be used with the profile directory as the input:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>llvm-profdata<span class="w"> </span>merge<span class="w"> </span>-output<span class="o">=</span>code.profdata<span class="w"> </span>yyy/zzz/
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
<p>If the user wants to turn off the auto-merging feature, or simply override the
the profile dumping path specified at command line, the environment variable
<code class="docutils literal notranslate"><span class="pre">LLVM_PROFILE_FILE</span></code> can still be used to override
the directory and filename for the profile file at runtime.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fcs-profile-generate">
<span class="sig-name descname"><span class="pre">-fcs-profile-generate</span></span><span class="sig-prename descclassname"><span class="pre">[=&lt;dirname&gt;]</span></span><a class="headerlink" href="#cmdoption-fcs-profile-generate" title="Link to this definition">¶</a></dt>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">-fcs-profile-generate</span></code> and <code class="docutils literal notranslate"><span class="pre">-fcs-profile-generate=</span></code> flags will use
the same instrumentation method, and generate the same profile as in the
<code class="docutils literal notranslate"><span class="pre">-fprofile-generate</span></code> and <code class="docutils literal notranslate"><span class="pre">-fprofile-generate=</span></code> flags. The difference is
that the instrumentation is performed after inlining so that the resulted
profile has a better context sensitive information. They cannot be used
together with <code class="docutils literal notranslate"><span class="pre">-fprofile-generate</span></code> and <code class="docutils literal notranslate"><span class="pre">-fprofile-generate=</span></code> flags.
They are typically used in conjunction with <code class="docutils literal notranslate"><span class="pre">-fprofile-use</span></code> flag.
The profile generated by <code class="docutils literal notranslate"><span class="pre">-fcs-profile-generate</span></code> and <code class="docutils literal notranslate"><span class="pre">-fprofile-generate</span></code>
can be merged by llvm-profdata. A use example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang++<span class="w"> </span>-O2<span class="w"> </span>-fprofile-generate<span class="o">=</span>yyy/zzz<span class="w"> </span>code.cc<span class="w"> </span>-o<span class="w"> </span>code
<span class="gp">$ </span>./code
<span class="gp">$ </span>llvm-profdata<span class="w"> </span>merge<span class="w"> </span>-output<span class="o">=</span>code.profdata<span class="w"> </span>yyy/zzz/
</pre></div>
</div>
<p>The first few steps are the same as that in <code class="docutils literal notranslate"><span class="pre">-fprofile-generate</span></code>
compilation. Then perform a second round of instrumentation.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang++<span class="w"> </span>-O2<span class="w"> </span>-fprofile-use<span class="o">=</span>code.profdata<span class="w"> </span>-fcs-profile-generate<span class="o">=</span>sss/ttt<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-o<span class="w"> </span>cs_code
<span class="gp">$ </span>./cs_code
<span class="gp">$ </span>llvm-profdata<span class="w"> </span>merge<span class="w"> </span>-output<span class="o">=</span>cs_code.profdata<span class="w"> </span>sss/ttt<span class="w"> </span>code.profdata
</pre></div>
</div>
<p>The resulted <code class="docutils literal notranslate"><span class="pre">cs_code.prodata</span></code> combines <code class="docutils literal notranslate"><span class="pre">code.profdata</span></code> and the profile
generated from binary <code class="docutils literal notranslate"><span class="pre">cs_code</span></code>. Profile <code class="docutils literal notranslate"><span class="pre">cs_code.profata</span></code> can be used by
<code class="docutils literal notranslate"><span class="pre">-fprofile-use</span></code> compilaton.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang++<span class="w"> </span>-O2<span class="w"> </span>-fprofile-use<span class="o">=</span>cs_code.profdata
</pre></div>
</div>
<p>The above command will read both profiles to the compiler at the identical
point of instrumenations.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fprofile-use">
<span class="sig-name descname"><span class="pre">-fprofile-use</span></span><span class="sig-prename descclassname"><span class="pre">[=&lt;pathname&gt;]</span></span><a class="headerlink" href="#cmdoption-fprofile-use" title="Link to this definition">¶</a></dt>
<dd><p>Without any other arguments, <code class="docutils literal notranslate"><span class="pre">-fprofile-use</span></code> behaves identically to
<code class="docutils literal notranslate"><span class="pre">-fprofile-instr-use</span></code>. Otherwise, if <code class="docutils literal notranslate"><span class="pre">pathname</span></code> is the full path to a
profile file, it reads from that file. If <code class="docutils literal notranslate"><span class="pre">pathname</span></code> is a directory name,
it reads from <code class="docutils literal notranslate"><span class="pre">pathname/default.profdata</span></code>.</p>
</dd></dl>

</section>
<section id="disabling-instrumentation">
<h4><a class="toc-backref" href="#id43" role="doc-backlink">Disabling Instrumentation</a><a class="headerlink" href="#disabling-instrumentation" title="Link to this heading">¶</a></h4>
<p>In certain situations, it may be useful to disable profile generation or use
for specific files in a build, without affecting the main compilation flags
used for the other files in the project.</p>
<p>In these cases, you can use the flag <code class="docutils literal notranslate"><span class="pre">-fno-profile-instr-generate</span></code> (or
<code class="docutils literal notranslate"><span class="pre">-fno-profile-generate</span></code>) to disable profile generation, and
<code class="docutils literal notranslate"><span class="pre">-fno-profile-instr-use</span></code> (or <code class="docutils literal notranslate"><span class="pre">-fno-profile-use</span></code>) to disable profile use.</p>
<p>Note that these flags should appear after the corresponding profile
flags to have an effect.</p>
</section>
<section id="profile-remapping">
<h4><a class="toc-backref" href="#id44" role="doc-backlink">Profile remapping</a><a class="headerlink" href="#profile-remapping" title="Link to this heading">¶</a></h4>
<p>When the program is compiled after a change that affects many symbol names,
pre-existing profile data may no longer match the program. For example:</p>
<blockquote>
<div><ul class="simple">
<li><p>switching from libstdc++ to libc++ will result in the mangled names of all
functions taking standard library types to change</p></li>
<li><p>renaming a widely-used type in C++ will result in the mangled names of all
functions that have parameters involving that type to change</p></li>
<li><p>moving from a 32-bit compilation to a 64-bit compilation may change the
underlying type of <code class="docutils literal notranslate"><span class="pre">size_t</span></code> and similar types, resulting in changes to
manglings</p></li>
</ul>
</div></blockquote>
<p>Clang allows use of a profile remapping file to specify that such differences
in mangled names should be ignored when matching the profile data against the
program.</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fprofile-remapping-file">
<span class="sig-name descname"><span class="pre">-fprofile-remapping-file</span></span><span class="sig-prename descclassname"><span class="pre">=&lt;file&gt;</span></span><a class="headerlink" href="#cmdoption-fprofile-remapping-file" title="Link to this definition">¶</a></dt>
<dd><p>Specifies a file containing profile remapping information, that will be
used to match mangled names in the profile data to mangled names in the
program.</p>
</dd></dl>

<p>The profile remapping file is a text file containing lines of the form</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>fragmentkind fragment1 fragment2
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">fragmentkind</span></code> is one of <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">type</span></code>, or <code class="docutils literal notranslate"><span class="pre">encoding</span></code>,
indicating whether the following mangled name fragments are
&lt;<a class="reference external" href="https://itanium-cxx-abi.github.io/cxx-abi/abi.html#mangle.name">name</a>&gt;s,
&lt;<a class="reference external" href="https://itanium-cxx-abi.github.io/cxx-abi/abi.html#mangle.type">type</a>&gt;s, or
&lt;<a class="reference external" href="https://itanium-cxx-abi.github.io/cxx-abi/abi.html#mangle.encoding">encoding</a>&gt;s,
respectively.
Blank lines and lines starting with <code class="docutils literal notranslate"><span class="pre">#</span></code> are ignored.</p>
<p>For convenience, built-in &lt;substitution&gt;s such as <code class="docutils literal notranslate"><span class="pre">St</span></code> and <code class="docutils literal notranslate"><span class="pre">Ss</span></code>
are accepted as &lt;name&gt;s (even though they technically are not &lt;name&gt;s).</p>
<p>For example, to specify that <code class="docutils literal notranslate"><span class="pre">absl::string_view</span></code> and <code class="docutils literal notranslate"><span class="pre">std::string_view</span></code>
should be treated as equivalent when matching profile data, the following
remapping file could be used:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># absl::string_view is considered equivalent to std::string_view
type N4absl11string_viewE St17basic_string_viewIcSt11char_traitsIcEE

# std:: might be std::__1:: in libc++ or std::__cxx11:: in libstdc++
name 3std St3__1
name 3std St7__cxx11
</pre></div>
</div>
<p>Matching profile data using a profile remapping file is supported on a
best-effort basis. For example, information regarding indirect call targets is
currently not remapped. For best results, you are encouraged to generate new
profile data matching the updated program, or to remap the profile data
using the <code class="docutils literal notranslate"><span class="pre">llvm-cxxmap</span></code> and <code class="docutils literal notranslate"><span class="pre">llvm-profdata</span> <span class="pre">merge</span></code> tools.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Profile data remapping support is currently only implemented for LLVM’s
new pass manager, which can be enabled with
<code class="docutils literal notranslate"><span class="pre">-fexperimental-new-pass-manager</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Profile data remapping is currently only supported for C++ mangled names
following the Itanium C++ ABI mangling scheme. This covers all C++ targets
supported by Clang other than Windows.</p>
</div>
</section>
</section>
<section id="gcov-based-profiling">
<h3><a class="toc-backref" href="#id45" role="doc-backlink">GCOV-based Profiling</a><a class="headerlink" href="#gcov-based-profiling" title="Link to this heading">¶</a></h3>
<p>GCOV is a test coverage program, it helps to know how often a line of code
is executed. When instrumenting the code with <code class="docutils literal notranslate"><span class="pre">--coverage</span></code> option, some
counters are added for each edge linking basic blocks.</p>
<p>At compile time, gcno files are generated containing information about
blocks and edges between them. At runtime the counters are incremented and at
exit the counters are dumped in gcda files.</p>
<p>The tool <code class="docutils literal notranslate"><span class="pre">llvm-cov</span> <span class="pre">gcov</span></code> will parse gcno, gcda and source files to generate
a report <code class="docutils literal notranslate"><span class="pre">.c.gcov</span></code>.</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fprofile-filter-files">
<span class="sig-name descname"><span class="pre">-fprofile-filter-files</span></span><span class="sig-prename descclassname"><span class="pre">=[regexes]</span></span><a class="headerlink" href="#cmdoption-fprofile-filter-files" title="Link to this definition">¶</a></dt>
<dd><p>Define a list of regexes separated by a semi-colon.
If a file name matches any of the regexes then the file is instrumented.</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>--coverage<span class="w"> </span>-fprofile-filter-files<span class="o">=</span><span class="s2">&quot;.*\.c</span>$<span class="s2">&quot;</span><span class="w"> </span>foo.c
</pre></div>
</div>
</div></blockquote>
<p>For example, this will only instrument files finishing with <code class="docutils literal notranslate"><span class="pre">.c</span></code>, skipping <code class="docutils literal notranslate"><span class="pre">.h</span></code> files.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fprofile-exclude-files">
<span class="sig-name descname"><span class="pre">-fprofile-exclude-files</span></span><span class="sig-prename descclassname"><span class="pre">=[regexes]</span></span><a class="headerlink" href="#cmdoption-fprofile-exclude-files" title="Link to this definition">¶</a></dt>
<dd><p>Define a list of regexes separated by a semi-colon.
If a file name doesn’t match all the regexes then the file is instrumented.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>--coverage<span class="w"> </span>-fprofile-exclude-files<span class="o">=</span><span class="s2">&quot;^/usr/include/.*</span>$<span class="s2">&quot;</span><span class="w"> </span>foo.c
</pre></div>
</div>
<p>For example, this will instrument all the files except the ones in <code class="docutils literal notranslate"><span class="pre">/usr/include</span></code>.</p>
</dd></dl>

<p>If both options are used then a file is instrumented if its name matches any
of the regexes from <code class="docutils literal notranslate"><span class="pre">-fprofile-filter-list</span></code> and doesn’t match all the regexes
from <code class="docutils literal notranslate"><span class="pre">-fprofile-exclude-list</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>--coverage<span class="w"> </span>-fprofile-exclude-files<span class="o">=</span><span class="s2">&quot;^/usr/include/.*</span>$<span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-fprofile-filter-files<span class="o">=</span><span class="s2">&quot;^/usr/.*</span>$<span class="s2">&quot;</span>
</pre></div>
</div>
<p>In that case <code class="docutils literal notranslate"><span class="pre">/usr/foo/oof.h</span></code> is instrumented since it matches the filter regex and
doesn’t match the exclude regex, but <code class="docutils literal notranslate"><span class="pre">/usr/include/foo.h</span></code> doesn’t since it matches
the exclude regex.</p>
</section>
<section id="controlling-debug-information">
<h3><a class="toc-backref" href="#id46" role="doc-backlink">Controlling Debug Information</a><a class="headerlink" href="#controlling-debug-information" title="Link to this heading">¶</a></h3>
<section id="controlling-size-of-debug-information">
<h4><a class="toc-backref" href="#id47" role="doc-backlink">Controlling Size of Debug Information</a><a class="headerlink" href="#controlling-size-of-debug-information" title="Link to this heading">¶</a></h4>
<p>Debug info kind generated by Clang can be set by one of the flags listed
below. If multiple flags are present, the last one is used.</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-g0">
<span class="sig-name descname"><span class="pre">-g0</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-g0" title="Link to this definition">¶</a></dt>
<dd><p>Don’t generate any debug info (default).</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-gline-tables-only">
<span class="sig-name descname"><span class="pre">-gline-tables-only</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-gline-tables-only" title="Link to this definition">¶</a></dt>
<dd><p>Generate line number tables only.</p>
<p>This kind of debug info allows to obtain stack traces with function names,
file names and line numbers (by such tools as <code class="docutils literal notranslate"><span class="pre">gdb</span></code> or <code class="docutils literal notranslate"><span class="pre">addr2line</span></code>).  It
doesn’t contain any other data (e.g. description of local variables or
function parameters).</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fstandalone-debug">
<span class="sig-name descname"><span class="pre">-fstandalone-debug</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fstandalone-debug" title="Link to this definition">¶</a></dt>
<dd><p>Clang supports a number of optimizations to reduce the size of debug
information in the binary. They work based on the assumption that
the debug type information can be spread out over multiple
compilation units.  For instance, Clang will not emit type
definitions for types that are not needed by a module and could be
replaced with a forward declaration.  Further, Clang will only emit
type info for a dynamic C++ class in the module that contains the
vtable for the class.</p>
<p>The <strong>-fstandalone-debug</strong> option turns off these optimizations.
This is useful when working with 3rd-party libraries that don’t come
with debug information.  Note that Clang will never emit type
information for types that are not referenced at all by the program.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fno-standalone-debug">
<span class="sig-name descname"><span class="pre">-fno-standalone-debug</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fno-standalone-debug" title="Link to this definition">¶</a></dt>
<dd><p>On Darwin <strong>-fstandalone-debug</strong> is enabled by default. The
<strong>-fno-standalone-debug</strong> option can be used to get to turn on the
vtable-based optimization described above.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-g">
<span class="sig-name descname"><span class="pre">-g</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-g" title="Link to this definition">¶</a></dt>
<dd><p>Generate complete debug info.</p>
</dd></dl>

</section>
<section id="controlling-macro-debug-info-generation">
<h4><a class="toc-backref" href="#id48" role="doc-backlink">Controlling Macro Debug Info Generation</a><a class="headerlink" href="#controlling-macro-debug-info-generation" title="Link to this heading">¶</a></h4>
<p>Debug info for C preprocessor macros increases the size of debug information in
the binary. Macro debug info generated by Clang can be controlled by the flags
listed below.</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fdebug-macro">
<span class="sig-name descname"><span class="pre">-fdebug-macro</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fdebug-macro" title="Link to this definition">¶</a></dt>
<dd><p>Generate debug info for preprocessor macros. This flag is discarded when
<strong>-g0</strong> is enabled.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fno-debug-macro">
<span class="sig-name descname"><span class="pre">-fno-debug-macro</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fno-debug-macro" title="Link to this definition">¶</a></dt>
<dd><p>Do not generate debug info for preprocessor macros (default).</p>
</dd></dl>

</section>
<section id="controlling-debugger-tuning">
<h4><a class="toc-backref" href="#id49" role="doc-backlink">Controlling Debugger “Tuning”</a><a class="headerlink" href="#controlling-debugger-tuning" title="Link to this heading">¶</a></h4>
<p>While Clang generally emits standard DWARF debug info (<a class="reference external" href="http://dwarfstd.org">http://dwarfstd.org</a>),
different debuggers may know how to take advantage of different specific DWARF
features. You can “tune” the debug info for one of several different debuggers.</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-ggdb">
<span id="cmdoption-glldb"></span><span id="cmdoption-gsce"></span><span class="sig-name descname"><span class="pre">-ggdb</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">-glldb</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">-gsce</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-ggdb" title="Link to this definition">¶</a></dt>
<dd><p>Tune the debug info for the <code class="docutils literal notranslate"><span class="pre">gdb</span></code>, <code class="docutils literal notranslate"><span class="pre">lldb</span></code>, or Sony PlayStation®
debugger, respectively. Each of these options implies <strong>-g</strong>. (Therefore, if
you want both <strong>-gline-tables-only</strong> and debugger tuning, the tuning option
must come first.)</p>
</dd></dl>

</section>
</section>
<section id="controlling-llvm-ir-output">
<h3><a class="toc-backref" href="#id50" role="doc-backlink">Controlling LLVM IR Output</a><a class="headerlink" href="#controlling-llvm-ir-output" title="Link to this heading">¶</a></h3>
<section id="controlling-value-names-in-llvm-ir">
<h4><a class="toc-backref" href="#id51" role="doc-backlink">Controlling Value Names in LLVM IR</a><a class="headerlink" href="#controlling-value-names-in-llvm-ir" title="Link to this heading">¶</a></h4>
<p>Emitting value names in LLVM IR increases the size and verbosity of the IR.
By default, value names are only emitted in assertion-enabled builds of Clang.
However, when reading IR it can be useful to re-enable the emission of value
names to improve readability.</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fdiscard-value-names">
<span class="sig-name descname"><span class="pre">-fdiscard-value-names</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fdiscard-value-names" title="Link to this definition">¶</a></dt>
<dd><p>Discard value names when generating LLVM IR.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fno-discard-value-names">
<span class="sig-name descname"><span class="pre">-fno-discard-value-names</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fno-discard-value-names" title="Link to this definition">¶</a></dt>
<dd><p>Do not discard value names when generating LLVM IR. This option can be used
to re-enable names for release builds of Clang.</p>
</dd></dl>

</section>
</section>
<section id="comment-parsing-options">
<h3><a class="toc-backref" href="#id52" role="doc-backlink">Comment Parsing Options</a><a class="headerlink" href="#comment-parsing-options" title="Link to this heading">¶</a></h3>
<p>Clang parses Doxygen and non-Doxygen style documentation comments and attaches
them to the appropriate declaration nodes.  By default, it only parses
Doxygen-style comments and ignores ordinary comments starting with <code class="docutils literal notranslate"><span class="pre">//</span></code> and
<code class="docutils literal notranslate"><span class="pre">/*</span></code>.</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-Wdocumentation">
<span class="sig-name descname"><span class="pre">-Wdocumentation</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-Wdocumentation" title="Link to this definition">¶</a></dt>
<dd><p>Emit warnings about use of documentation comments.  This warning group is off
by default.</p>
<p>This includes checking that <code class="docutils literal notranslate"><span class="pre">\param</span></code> commands name parameters that actually
present in the function signature, checking that <code class="docutils literal notranslate"><span class="pre">\returns</span></code> is used only on
functions that actually return a value etc.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-Wno-documentation-unknown-command">
<span class="sig-name descname"><span class="pre">-Wno-documentation-unknown-command</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-Wno-documentation-unknown-command" title="Link to this definition">¶</a></dt>
<dd><p>Don’t warn when encountering an unknown Doxygen command.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fparse-all-comments">
<span class="sig-name descname"><span class="pre">-fparse-all-comments</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fparse-all-comments" title="Link to this definition">¶</a></dt>
<dd><p>Parse all comments as documentation comments (including ordinary comments
starting with <code class="docutils literal notranslate"><span class="pre">//</span></code> and <code class="docutils literal notranslate"><span class="pre">/*</span></code>).</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fcomment-block-commands">
<span class="sig-name descname"><span class="pre">-fcomment-block-commands</span></span><span class="sig-prename descclassname"><span class="pre">=[commands]</span></span><a class="headerlink" href="#cmdoption-fcomment-block-commands" title="Link to this definition">¶</a></dt>
<dd><p>Define custom documentation commands as block commands.  This allows Clang to
construct the correct AST for these custom commands, and silences warnings
about unknown commands.  Several commands must be separated by a comma
<em>without trailing space</em>; e.g. <code class="docutils literal notranslate"><span class="pre">-fcomment-block-commands=foo,bar</span></code> defines
custom commands <code class="docutils literal notranslate"><span class="pre">\foo</span></code> and <code class="docutils literal notranslate"><span class="pre">\bar</span></code>.</p>
<p>It is also possible to use <code class="docutils literal notranslate"><span class="pre">-fcomment-block-commands</span></code> several times; e.g.
<code class="docutils literal notranslate"><span class="pre">-fcomment-block-commands=foo</span> <span class="pre">-fcomment-block-commands=bar</span></code> does the same
as above.</p>
</dd></dl>

</section>
</section>
<section id="c-language-features">
<span id="c"></span><h2><a class="toc-backref" href="#id53" role="doc-backlink">C Language Features</a><a class="headerlink" href="#c-language-features" title="Link to this heading">¶</a></h2>
<p>The support for standard C in clang is feature-complete except for the
C99 floating-point pragmas.</p>
<section id="extensions-supported-by-clang">
<h3><a class="toc-backref" href="#id54" role="doc-backlink">Extensions supported by clang</a><a class="headerlink" href="#extensions-supported-by-clang" title="Link to this heading">¶</a></h3>
<p>See <a class="reference internal" href="LanguageExtensions.html"><span class="doc">Clang Language Extensions</span></a>.</p>
</section>
<section id="differences-between-various-standard-modes">
<h3><a class="toc-backref" href="#id55" role="doc-backlink">Differences between various standard modes</a><a class="headerlink" href="#differences-between-various-standard-modes" title="Link to this heading">¶</a></h3>
<p>clang supports the -std option, which changes what language mode clang
uses. The supported modes for C are c89, gnu89, c99, gnu99, c11, gnu11,
c17, gnu17, and various aliases for those modes. If no -std option is
specified, clang defaults to gnu11 mode. Many C99 and C11 features are
supported in earlier modes as a conforming extension, with a warning. Use
<code class="docutils literal notranslate"><span class="pre">-pedantic-errors</span></code> to request an error if a feature from a later standard
revision is used in an earlier mode.</p>
<p>Differences between all <code class="docutils literal notranslate"><span class="pre">c*</span></code> and <code class="docutils literal notranslate"><span class="pre">gnu*</span></code> modes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">c*</span></code> modes define “<code class="docutils literal notranslate"><span class="pre">__STRICT_ANSI__</span></code>”.</p></li>
<li><p>Target-specific defines not prefixed by underscores, like “linux”,
are defined in <code class="docutils literal notranslate"><span class="pre">gnu*</span></code> modes.</p></li>
<li><p>Trigraphs default to being off in <code class="docutils literal notranslate"><span class="pre">gnu*</span></code> modes; they can be enabled by
the -trigraphs option.</p></li>
<li><p>The parser recognizes “asm” and “typeof” as keywords in <code class="docutils literal notranslate"><span class="pre">gnu*</span></code> modes;
the variants “<code class="docutils literal notranslate"><span class="pre">__asm__</span></code>” and “<code class="docutils literal notranslate"><span class="pre">__typeof__</span></code>” are recognized in all
modes.</p></li>
<li><p>The Apple “blocks” extension is recognized by default in <code class="docutils literal notranslate"><span class="pre">gnu*</span></code> modes
on some platforms; it can be enabled in any mode with the “-fblocks”
option.</p></li>
<li><p>Arrays that are VLA’s according to the standard, but which can be
constant folded by the frontend are treated as fixed size arrays.
This occurs for things like “int X[(1, 2)];”, which is technically a
VLA. <code class="docutils literal notranslate"><span class="pre">c*</span></code> modes are strictly compliant and treat these as VLAs.</p></li>
</ul>
<p>Differences between <code class="docutils literal notranslate"><span class="pre">*89</span></code> and <code class="docutils literal notranslate"><span class="pre">*99</span></code> modes:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">*99</span></code> modes default to implementing “inline” as specified in C99,
while the <code class="docutils literal notranslate"><span class="pre">*89</span></code> modes implement the GNU version. This can be
overridden for individual functions with the <code class="docutils literal notranslate"><span class="pre">__gnu_inline__</span></code>
attribute.</p></li>
<li><p>Digraphs are not recognized in c89 mode.</p></li>
<li><p>The scope of names defined inside a “for”, “if”, “switch”, “while”,
or “do” statement is different. (example: “<code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">((struct</span> <span class="pre">x</span> <span class="pre">{int</span>
<span class="pre">x;}*)0)</span> <span class="pre">{}</span></code>”.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__STDC_VERSION__</span></code> is not defined in <code class="docutils literal notranslate"><span class="pre">*89</span></code> modes.</p></li>
<li><p>“inline” is not recognized as a keyword in c89 mode.</p></li>
<li><p>“restrict” is not recognized as a keyword in <code class="docutils literal notranslate"><span class="pre">*89</span></code> modes.</p></li>
<li><p>Commas are allowed in integer constant expressions in <code class="docutils literal notranslate"><span class="pre">*99</span></code> modes.</p></li>
<li><p>Arrays which are not lvalues are not implicitly promoted to pointers
in <code class="docutils literal notranslate"><span class="pre">*89</span></code> modes.</p></li>
<li><p>Some warnings are different.</p></li>
</ul>
<p>Differences between <code class="docutils literal notranslate"><span class="pre">*99</span></code> and <code class="docutils literal notranslate"><span class="pre">*11</span></code> modes:</p>
<ul class="simple">
<li><p>Warnings for use of C11 features are disabled.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__STDC_VERSION__</span></code> is defined to <code class="docutils literal notranslate"><span class="pre">201112L</span></code> rather than <code class="docutils literal notranslate"><span class="pre">199901L</span></code>.</p></li>
</ul>
<p>Differences between <code class="docutils literal notranslate"><span class="pre">*11</span></code> and <code class="docutils literal notranslate"><span class="pre">*17</span></code> modes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__STDC_VERSION__</span></code> is defined to <code class="docutils literal notranslate"><span class="pre">201710L</span></code> rather than <code class="docutils literal notranslate"><span class="pre">201112L</span></code>.</p></li>
</ul>
</section>
<section id="gcc-extensions-not-implemented-yet">
<h3><a class="toc-backref" href="#id56" role="doc-backlink">GCC extensions not implemented yet</a><a class="headerlink" href="#gcc-extensions-not-implemented-yet" title="Link to this heading">¶</a></h3>
<p>clang tries to be compatible with gcc as much as possible, but some gcc
extensions are not implemented yet:</p>
<ul>
<li><p>clang does not support decimal floating point types (<code class="docutils literal notranslate"><span class="pre">_Decimal32</span></code> and
friends) or fixed-point types (<code class="docutils literal notranslate"><span class="pre">_Fract</span></code> and friends); nobody has
expressed interest in these features yet, so it’s hard to say when
they will be implemented.</p></li>
<li><p>clang does not support nested functions; this is a complex feature
which is infrequently used, so it is unlikely to be implemented
anytime soon. In C++11 it can be emulated by assigning lambda
functions to local variables, e.g:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">local_function</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="kt">int</span><span class="w"> </span><span class="n">parameter</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Do something</span>
<span class="p">};</span>
<span class="p">...</span>
<span class="n">local_function</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>clang only supports global register variables when the register specified
is non-allocatable (e.g. the stack pointer). Support for general global
register variables is unlikely to be implemented soon because it requires
additional LLVM backend support.</p></li>
<li><p>clang does not support static initialization of flexible array
members. This appears to be a rarely used extension, but could be
implemented pending user demand.</p></li>
<li><p>clang does not support
<code class="docutils literal notranslate"><span class="pre">__builtin_va_arg_pack</span></code>/<code class="docutils literal notranslate"><span class="pre">__builtin_va_arg_pack_len</span></code>. This is
used rarely, but in some potentially interesting places, like the
glibc headers, so it may be implemented pending user demand. Note
that because clang pretends to be like GCC 4.2, and this extension
was introduced in 4.3, the glibc headers will not try to use this
extension with clang at the moment.</p></li>
<li><p>clang does not support the gcc extension for forward-declaring
function parameters; this has not shown up in any real-world code
yet, though, so it might never be implemented.</p></li>
</ul>
<p>This is not a complete list; if you find an unsupported extension
missing from this list, please send an e-mail to cfe-dev. This list
currently excludes C++; see <a class="reference internal" href="#cxx"><span class="std std-ref">C++ Language Features</span></a>. Also, this
list does not include bugs in mostly-implemented features; please see
the <a class="reference external" href="https://bugs.llvm.org/buglist.cgi?quicksearch=product%3Aclang+component%3A-New%2BBugs%2CAST%2CBasic%2CDriver%2CHeaders%2CLLVM%2BCodeGen%2Cparser%2Cpreprocessor%2CSemantic%2BAnalyzer">bug
tracker</a>
for known existing bugs (FIXME: Is there a section for bug-reporting
guidelines somewhere?).</p>
</section>
<section id="intentionally-unsupported-gcc-extensions">
<h3><a class="toc-backref" href="#id57" role="doc-backlink">Intentionally unsupported GCC extensions</a><a class="headerlink" href="#intentionally-unsupported-gcc-extensions" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>clang does not support the gcc extension that allows variable-length
arrays in structures. This is for a few reasons: one, it is tricky to
implement, two, the extension is completely undocumented, and three,
the extension appears to be rarely used. Note that clang <em>does</em>
support flexible array members (arrays with a zero or unspecified
size at the end of a structure).</p></li>
<li><p>clang does not have an equivalent to gcc’s “fold”; this means that
clang doesn’t accept some constructs gcc might accept in contexts
where a constant expression is required, like “x-x” where x is a
variable.</p></li>
<li><p>clang does not support <code class="docutils literal notranslate"><span class="pre">__builtin_apply</span></code> and friends; this extension
is extremely obscure and difficult to implement reliably.</p></li>
</ul>
</section>
<section id="microsoft-extensions">
<span id="c-ms"></span><h3><a class="toc-backref" href="#id58" role="doc-backlink">Microsoft extensions</a><a class="headerlink" href="#microsoft-extensions" title="Link to this heading">¶</a></h3>
<p>clang has support for many extensions from Microsoft Visual C++. To enable these
extensions, use the <code class="docutils literal notranslate"><span class="pre">-fms-extensions</span></code> command-line option. This is the default
for Windows targets. Clang does not implement every pragma or declspec provided
by MSVC, but the popular ones, such as <code class="docutils literal notranslate"><span class="pre">__declspec(dllexport)</span></code> and <code class="docutils literal notranslate"><span class="pre">#pragma</span>
<span class="pre">comment(lib)</span></code> are well supported.</p>
<p>clang has a <code class="docutils literal notranslate"><span class="pre">-fms-compatibility</span></code> flag that makes clang accept enough
invalid C++ to be able to parse most Microsoft headers. For example, it
allows <a class="reference external" href="https://clang.llvm.org/compatibility.html#dep_lookup_bases">unqualified lookup of dependent base class members</a>, which is
a common compatibility issue with clang. This flag is enabled by default
for Windows targets.</p>
<p><code class="docutils literal notranslate"><span class="pre">-fdelayed-template-parsing</span></code> lets clang delay parsing of function template
definitions until the end of a translation unit. This flag is enabled by
default for Windows targets.</p>
<p>For compatibility with existing code that compiles with MSVC, clang defines the
<code class="docutils literal notranslate"><span class="pre">_MSC_VER</span></code> and <code class="docutils literal notranslate"><span class="pre">_MSC_FULL_VER</span></code> macros. These default to the values of 1800
and 180000000 respectively, making clang look like an early release of Visual
C++ 2013. The <code class="docutils literal notranslate"><span class="pre">-fms-compatibility-version=</span></code> flag overrides these values.  It
accepts a dotted version tuple, such as 19.00.23506. Changing the MSVC
compatibility version makes clang behave more like that version of MSVC. For
example, <code class="docutils literal notranslate"><span class="pre">-fms-compatibility-version=19</span></code> will enable C++14 features and define
<code class="docutils literal notranslate"><span class="pre">char16_t</span></code> and <code class="docutils literal notranslate"><span class="pre">char32_t</span></code> as builtin types.</p>
</section>
</section>
<section id="cxx">
<span id="id4"></span><h2><a class="toc-backref" href="#id59" role="doc-backlink">C++ Language Features</a><a class="headerlink" href="#cxx" title="Link to this heading">¶</a></h2>
<p>clang fully implements all of standard C++98 except for exported
templates (which were removed in C++11), and all of standard C++11
and the current draft standard for C++1y.</p>
<section id="controlling-implementation-limits">
<h3><a class="toc-backref" href="#id60" role="doc-backlink">Controlling implementation limits</a><a class="headerlink" href="#controlling-implementation-limits" title="Link to this heading">¶</a></h3>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fbracket-depth">
<span class="sig-name descname"><span class="pre">-fbracket-depth</span></span><span class="sig-prename descclassname"><span class="pre">=N</span></span><a class="headerlink" href="#cmdoption-fbracket-depth" title="Link to this definition">¶</a></dt>
<dd><p>Sets the limit for nested parentheses, brackets, and braces to N.  The
default is 256.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fconstexpr-depth">
<span class="sig-name descname"><span class="pre">-fconstexpr-depth</span></span><span class="sig-prename descclassname"><span class="pre">=N</span></span><a class="headerlink" href="#cmdoption-fconstexpr-depth" title="Link to this definition">¶</a></dt>
<dd><p>Sets the limit for recursive constexpr function invocations to N.  The
default is 512.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fconstexpr-steps">
<span class="sig-name descname"><span class="pre">-fconstexpr-steps</span></span><span class="sig-prename descclassname"><span class="pre">=N</span></span><a class="headerlink" href="#cmdoption-fconstexpr-steps" title="Link to this definition">¶</a></dt>
<dd><p>Sets the limit for the number of full-expressions evaluated in a single
constant expression evaluation.  The default is 1048576.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-ftemplate-depth">
<span class="sig-name descname"><span class="pre">-ftemplate-depth</span></span><span class="sig-prename descclassname"><span class="pre">=N</span></span><a class="headerlink" href="#cmdoption-ftemplate-depth" title="Link to this definition">¶</a></dt>
<dd><p>Sets the limit for recursively nested template instantiations to N.  The
default is 1024.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-foperator-arrow-depth">
<span class="sig-name descname"><span class="pre">-foperator-arrow-depth</span></span><span class="sig-prename descclassname"><span class="pre">=N</span></span><a class="headerlink" href="#cmdoption-foperator-arrow-depth" title="Link to this definition">¶</a></dt>
<dd><p>Sets the limit for iterative calls to ‘operator-&gt;’ functions to N.  The
default is 256.</p>
</dd></dl>

</section>
</section>
<section id="objective-c-language-features">
<span id="objc"></span><h2><a class="toc-backref" href="#id61" role="doc-backlink">Objective-C Language Features</a><a class="headerlink" href="#objective-c-language-features" title="Link to this heading">¶</a></h2>
</section>
<section id="objcxx">
<span id="id5"></span><h2><a class="toc-backref" href="#id62" role="doc-backlink">Objective-C++ Language Features</a><a class="headerlink" href="#objcxx" title="Link to this heading">¶</a></h2>
</section>
<section id="openmp-features">
<span id="openmp"></span><h2><a class="toc-backref" href="#id63" role="doc-backlink">OpenMP Features</a><a class="headerlink" href="#openmp-features" title="Link to this heading">¶</a></h2>
<p>Clang supports all OpenMP 4.5 directives and clauses. See <a class="reference internal" href="OpenMPSupport.html"><span class="doc">OpenMP Support</span></a>
for additional details.</p>
<p>Use <cite>-fopenmp</cite> to enable OpenMP. Support for OpenMP can be disabled with
<cite>-fno-openmp</cite>.</p>
<p>Use <cite>-fopenmp-simd</cite> to enable OpenMP simd features only, without linking
the runtime library; for combined constructs
(e.g. <code class="docutils literal notranslate"><span class="pre">#pragma</span> <span class="pre">omp</span> <span class="pre">parallel</span> <span class="pre">for</span> <span class="pre">simd</span></code>) the non-simd directives and clauses
will be ignored. This can be disabled with <cite>-fno-openmp-simd</cite>.</p>
<section id="id6">
<h3><a class="toc-backref" href="#id64" role="doc-backlink">Controlling implementation limits</a><a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-fopenmp-use-tls">
<span class="sig-name descname"><span class="pre">-fopenmp-use-tls</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-fopenmp-use-tls" title="Link to this definition">¶</a></dt>
<dd><p>Controls code generation for OpenMP threadprivate variables. In presence of
this option all threadprivate variables are generated the same way as thread
local variables, using TLS support. If <cite>-fno-openmp-use-tls</cite>
is provided or target does not support TLS, code generation for threadprivate
variables relies on OpenMP runtime library.</p>
</dd></dl>

</section>
</section>
<section id="opencl-features">
<span id="opencl"></span><h2><a class="toc-backref" href="#id65" role="doc-backlink">OpenCL Features</a><a class="headerlink" href="#opencl-features" title="Link to this heading">¶</a></h2>
<p>Clang can be used to compile OpenCL kernels for execution on a device
(e.g. GPU). It is possible to compile the kernel into a binary (e.g. for AMD or
Nvidia targets) that can be uploaded to run directly on a device (e.g. using
<a class="reference external" href="https://www.khronos.org/registry/OpenCL/specs/opencl-1.1.pdf#111">clCreateProgramWithBinary</a>) or
into generic bitcode files loadable into other toolchains.</p>
<p>Compiling to a binary using the default target from the installation can be done
as follows:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;kernel void k(){}&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>test.cl
<span class="gp">$ </span>clang<span class="w"> </span>test.cl
</pre></div>
</div>
</div></blockquote>
<p>Compiling for a specific target can be done by specifying the triple corresponding
to the target, for example:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>-target<span class="w"> </span>nvptx64-unknown-unknown<span class="w"> </span>test.cl
<span class="gp">$ </span>clang<span class="w"> </span>-target<span class="w"> </span>amdgcn-amd-amdhsa<span class="w"> </span>-mcpu<span class="o">=</span>gfx900<span class="w"> </span>test.cl
</pre></div>
</div>
</div></blockquote>
<p>Compiling to bitcode can be done as follows:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>-c<span class="w"> </span>-emit-llvm<span class="w"> </span>test.cl
</pre></div>
</div>
</div></blockquote>
<p>This will produce a generic test.bc file that can be used in vendor toolchains
to perform machine code generation.</p>
<p>Clang currently supports OpenCL C language standards up to v2.0. Starting from
clang 9 a C++ mode is available for OpenCL (see <a class="reference internal" href="#opencl-cpp"><span class="std std-ref">C++ for OpenCL</span></a>).</p>
<section id="opencl-specific-options">
<h3><a class="toc-backref" href="#id66" role="doc-backlink">OpenCL Specific Options</a><a class="headerlink" href="#opencl-specific-options" title="Link to this heading">¶</a></h3>
<p>Most of the OpenCL build options from <a class="reference external" href="https://www.khronos.org/registry/cl/specs/opencl-2.0.pdf#200">the specification v2.0 section 5.8.4</a> are available.</p>
<p>Examples:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>-cl-std<span class="o">=</span>CL2.0<span class="w"> </span>-cl-single-precision-constant<span class="w"> </span>test.cl
</pre></div>
</div>
</div></blockquote>
<p>Some extra options are available to support special OpenCL features.</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-finclude-default-header">
<span class="sig-name descname"><span class="pre">-finclude-default-header</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-finclude-default-header" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>Loads standard includes during compilations. By default OpenCL headers are not
loaded and therefore standard library includes are not available. To load them
automatically a flag has been added to the frontend (see also <a class="reference internal" href="#opencl-header"><span class="std std-ref">the section
on the OpenCL Header</span></a>):</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>-Xclang<span class="w"> </span>-finclude-default-header<span class="w"> </span>test.cl
</pre></div>
</div>
</div></blockquote>
<p>Alternatively <code class="docutils literal notranslate"><span class="pre">-include</span></code> or <code class="docutils literal notranslate"><span class="pre">-I</span></code> followed by the path to the header location
can be given manually.</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>-I&lt;path<span class="w"> </span>to<span class="w"> </span>clang&gt;/lib/Headers/opencl-c.h<span class="w"> </span>test.cl
</pre></div>
</div>
</div></blockquote>
<p>In this case the kernel code should contain <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;opencl-c.h&gt;</span></code> just as a
regular C include.</p>
<dl class="std option" id="opencl-cl-ext">
<dt class="sig sig-object std" id="cmdoption-cl-ext">
<span class="sig-name descname"><span class="pre">-cl-ext</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-cl-ext" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>Disables support of OpenCL extensions. All OpenCL targets provide a list
of extensions that they support. Clang allows to amend this using the <code class="docutils literal notranslate"><span class="pre">-cl-ext</span></code>
flag with a comma-separated list of extensions prefixed with <code class="docutils literal notranslate"><span class="pre">'+'</span></code> or <code class="docutils literal notranslate"><span class="pre">'-'</span></code>.
The syntax: <code class="docutils literal notranslate"><span class="pre">-cl-ext=&lt;(['-'|'+']&lt;extension&gt;[,])+&gt;</span></code>,  where extensions
can be either one of <a class="reference external" href="https://www.khronos.org/registry/cl/sdk/2.0/docs/man/xhtml/EXTENSION.html">the OpenCL specification extensions</a>
or any known vendor extension. Alternatively, <code class="docutils literal notranslate"><span class="pre">'all'</span></code> can be used to enable
or disable all known extensions.
Example disabling double support for the 64-bit SPIR target:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>-cc1<span class="w"> </span>-triple<span class="w"> </span>spir64-unknown-unknown<span class="w"> </span>-cl-ext<span class="o">=</span>-cl_khr_fp64<span class="w"> </span>test.cl
</pre></div>
</div>
</div></blockquote>
<p>Enabling all extensions except double support in R600 AMD GPU can be done using:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>-cc1<span class="w"> </span>-triple<span class="w"> </span>r600-unknown-unknown<span class="w"> </span>-cl-ext<span class="o">=</span>-all,+cl_khr_fp16<span class="w"> </span>test.cl
</pre></div>
</div>
</div></blockquote>
<dl class="std option" id="opencl-fake-address-space-map">
<dt class="sig sig-object std" id="cmdoption-ffake-address-space-map">
<span class="sig-name descname"><span class="pre">-ffake-address-space-map</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-ffake-address-space-map" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>Overrides the target address space map with a fake map.
This allows adding explicit address space IDs to the bitcode for non-segmented
memory architectures that don’t have separate IDs for each of the OpenCL
logical address spaces by default. Passing <code class="docutils literal notranslate"><span class="pre">-ffake-address-space-map</span></code> will
add/override address spaces of the target compiled for with the following values:
<code class="docutils literal notranslate"><span class="pre">1-global</span></code>, <code class="docutils literal notranslate"><span class="pre">2-constant</span></code>, <code class="docutils literal notranslate"><span class="pre">3-local</span></code>, <code class="docutils literal notranslate"><span class="pre">4-generic</span></code>. The private address
space is represented by the absence of an address space attribute in the IR (see
also <a class="reference internal" href="#opencl-addrsp"><span class="std std-ref">the section on the address space attribute</span></a>).</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>-ffake-address-space-map<span class="w"> </span>test.cl
</pre></div>
</div>
</div></blockquote>
<p>Some other flags used for the compilation for C can also be passed while
compiling for OpenCL, examples: <code class="docutils literal notranslate"><span class="pre">-c</span></code>, <code class="docutils literal notranslate"><span class="pre">-O&lt;1-4|s&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">-o</span></code>, <code class="docutils literal notranslate"><span class="pre">-emit-llvm</span></code>, etc.</p>
</section>
<section id="opencl-targets">
<h3><a class="toc-backref" href="#id67" role="doc-backlink">OpenCL Targets</a><a class="headerlink" href="#opencl-targets" title="Link to this heading">¶</a></h3>
<p>OpenCL targets are derived from the regular Clang target classes. The OpenCL
specific parts of the target representation provide address space mapping as
well as a set of supported extensions.</p>
<section id="specific-targets">
<h4><a class="toc-backref" href="#id68" role="doc-backlink">Specific Targets</a><a class="headerlink" href="#specific-targets" title="Link to this heading">¶</a></h4>
<p>There is a set of concrete HW architectures that OpenCL can be compiled for.</p>
<ul>
<li><p>For AMD target:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>-target<span class="w"> </span>amdgcn-amd-amdhsa<span class="w"> </span>-mcpu<span class="o">=</span>gfx900<span class="w"> </span>test.cl
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>For Nvidia architectures:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>-target<span class="w"> </span>nvptx64-unknown-unknown<span class="w"> </span>test.cl
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="generic-targets">
<h4><a class="toc-backref" href="#id69" role="doc-backlink">Generic Targets</a><a class="headerlink" href="#generic-targets" title="Link to this heading">¶</a></h4>
<ul>
<li><p>SPIR is available as a generic target to allow portable bitcode to be produced
that can be used across GPU toolchains. The implementation follows <a class="reference external" href="https://www.khronos.org/spir">the SPIR
specification</a>. There are two flavors
available for 32 and 64 bits.</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>-target<span class="w"> </span>spir-unknown-unknown<span class="w"> </span>test.cl
<span class="gp">$ </span>clang<span class="w"> </span>-target<span class="w"> </span>spir64-unknown-unknown<span class="w"> </span>test.cl
</pre></div>
</div>
</div></blockquote>
<p>All known OpenCL extensions are supported in the SPIR targets. Clang will
generate SPIR v1.2 compatible IR for OpenCL versions up to 2.0 and SPIR v2.0
for OpenCL v2.0.</p>
</li>
<li><p>x86 is used by some implementations that are x86 compatible and currently
remains for backwards compatibility (with older implementations prior to
SPIR target support). For “non-SPMD” targets which cannot spawn multiple
work-items on the fly using hardware, which covers practically all non-GPU
devices such as CPUs and DSPs, additional processing is needed for the kernels
to support multiple work-item execution. For this, a 3rd party toolchain,
such as for example <a class="reference external" href="http://portablecl.org/">POCL</a>, can be used.</p>
<p>This target does not support multiple memory segments and, therefore, the fake
address space map can be added using the <a class="reference internal" href="#opencl-fake-address-space-map"><span class="std std-ref">-ffake-address-space-map</span></a> flag.</p>
</li>
</ul>
</section>
</section>
<section id="opencl-header">
<span id="id7"></span><h3><a class="toc-backref" href="#id70" role="doc-backlink">OpenCL Header</a><a class="headerlink" href="#opencl-header" title="Link to this heading">¶</a></h3>
<p>By default Clang will not include standard headers and therefore OpenCL builtin
functions and some types (i.e. vectors) are unknown. The default CL header is,
however, provided in the Clang installation and can be enabled by passing the
<code class="docutils literal notranslate"><span class="pre">-finclude-default-header</span></code> flag to the Clang frontend.</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;bool is_wg_uniform(int i){return get_enqueued_local_size(i)==get_local_size(i);}&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>test.cl
<span class="gp">$ </span>clang<span class="w"> </span>-Xclang<span class="w"> </span>-finclude-default-header<span class="w"> </span>-cl-std<span class="o">=</span>CL2.0<span class="w"> </span>test.cl
</pre></div>
</div>
</div></blockquote>
<p>Because the header is very large and long to parse, PCH (<a class="reference internal" href="PCHInternals.html"><span class="doc">Precompiled Header and Modules Internals</span></a>)
and modules (<a class="reference internal" href="Modules.html"><span class="doc">Modules</span></a>) are used internally to improve the compilation
speed.</p>
<p>To enable modules for OpenCL:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clang<span class="w"> </span>-target<span class="w"> </span>spir-unknown-unknown<span class="w"> </span>-c<span class="w"> </span>-emit-llvm<span class="w"> </span>-Xclang<span class="w"> </span>-finclude-default-header<span class="w"> </span>-fmodules<span class="w"> </span>-fimplicit-module-maps<span class="w"> </span>-fmodules-cache-path<span class="o">=</span>&lt;path<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>generated<span class="w"> </span>module&gt;<span class="w"> </span>test.cl
</pre></div>
</div>
</div></blockquote>
</section>
<section id="opencl-extensions">
<h3><a class="toc-backref" href="#id71" role="doc-backlink">OpenCL Extensions</a><a class="headerlink" href="#opencl-extensions" title="Link to this heading">¶</a></h3>
<p>All of the <code class="docutils literal notranslate"><span class="pre">cl_khr_*</span></code> extensions from <a class="reference external" href="https://www.khronos.org/registry/OpenCL/sdk/2.0/docs/man/xhtml/EXTENSION.html">the official OpenCL specification</a>
up to and including version 2.0 are available and set per target depending on the
support available in the specific architecture.</p>
<p>It is possible to alter the default extensions setting per target using
<code class="docutils literal notranslate"><span class="pre">-cl-ext</span></code> flag. (See <a class="reference internal" href="#opencl-cl-ext"><span class="std std-ref">flags description</span></a> for more details).</p>
<p>Vendor extensions can be added flexibly by declaring the list of types and
functions associated with each extensions enclosed within the following
compiler pragma directives:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#pragma OPENCL EXTENSION the_new_extension_name : begin</span>
<span class="c1">// declare types and functions associated with the extension here</span>
<span class="cp">#pragma OPENCL EXTENSION the_new_extension_name : end</span>
</pre></div>
</div>
</div></blockquote>
<p>For example, parsing the following code adds <code class="docutils literal notranslate"><span class="pre">my_t</span></code> type and <code class="docutils literal notranslate"><span class="pre">my_func</span></code>
function to the custom <code class="docutils literal notranslate"><span class="pre">my_ext</span></code> extension.</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#pragma OPENCL EXTENSION my_ext : begin</span>
<span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="p">}</span><span class="n">my_t</span><span class="p">;</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">my_func</span><span class="p">(</span><span class="n">my_t</span><span class="p">);</span>
<span class="cp">#pragma OPENCL EXTENSION my_ext : end</span>
</pre></div>
</div>
</div></blockquote>
<p>Declaring the same types in different vendor extensions is disallowed.</p>
</section>
<section id="opencl-metadata">
<h3><a class="toc-backref" href="#id72" role="doc-backlink">OpenCL Metadata</a><a class="headerlink" href="#opencl-metadata" title="Link to this heading">¶</a></h3>
<p>Clang uses metadata to provide additional OpenCL semantics in IR needed for
backends and OpenCL runtime.</p>
<p>Each kernel will have function metadata attached to it, specifying the arguments.
Kernel argument metadata is used to provide source level information for querying
at runtime, for example using the <a class="reference external" href="https://www.khronos.org/registry/OpenCL/specs/opencl-1.2.pdf#167">clGetKernelArgInfo</a>
call.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">-cl-kernel-arg-info</span></code> enables more information about the original CL
code to be added e.g. kernel parameter names will appear in the OpenCL metadata
along with other information.</p>
<p>The IDs used to encode the OpenCL’s logical address spaces in the argument info
metadata follows the SPIR address space mapping as defined in the SPIR
specification <a class="reference external" href="https://www.khronos.org/registry/spir/specs/spir_spec-2.0.pdf#18">section 2.2</a></p>
</section>
<section id="opencl-specific-attributes">
<h3><a class="toc-backref" href="#id73" role="doc-backlink">OpenCL-Specific Attributes</a><a class="headerlink" href="#opencl-specific-attributes" title="Link to this heading">¶</a></h3>
<p>OpenCL support in Clang contains a set of attribute taken directly from the
specification as well as additional attributes.</p>
<p>See also <a class="reference internal" href="AttributeReference.html"><span class="doc">Attributes in Clang</span></a>.</p>
<section id="nosvm">
<h4><a class="toc-backref" href="#id74" role="doc-backlink">nosvm</a><a class="headerlink" href="#nosvm" title="Link to this heading">¶</a></h4>
<p>Clang supports this attribute to comply to OpenCL v2.0 conformance, but it
does not have any effect on the IR. For more details reffer to the specification
<a class="reference external" href="https://www.khronos.org/registry/cl/specs/opencl-2.0-openclc.pdf#49">section 6.7.2</a></p>
</section>
<section id="opencl-unroll-hint">
<h4><a class="toc-backref" href="#id75" role="doc-backlink">opencl_unroll_hint</a><a class="headerlink" href="#opencl-unroll-hint" title="Link to this heading">¶</a></h4>
<p>The implementation of this feature mirrors the unroll hint for C.
More details on the syntax can be found in the specification
<a class="reference external" href="https://www.khronos.org/registry/cl/specs/opencl-2.0-openclc.pdf#61">section 6.11.5</a></p>
</section>
<section id="convergent">
<h4><a class="toc-backref" href="#id76" role="doc-backlink">convergent</a><a class="headerlink" href="#convergent" title="Link to this heading">¶</a></h4>
<p>To make sure no invalid optimizations occur for single program multiple data
(SPMD) / single instruction multiple thread (SIMT) Clang provides attributes that
can be used for special functions that have cross work item semantics.
An example is the subgroup operations such as <a class="reference external" href="https://www.khronos.org/registry/cl/extensions/intel/cl_intel_subgroups.txt">intel_sub_group_shuffle</a></p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define custom my_sub_group_shuffle(data, c)</span>
<span class="c1">// that makes use of intel_sub_group_shuffle</span>
<span class="n">r1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">r0</span><span class="p">)</span><span class="w"> </span><span class="n">r1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">computeA</span><span class="p">();</span>
<span class="c1">// Shuffle data from r1 into r3</span>
<span class="c1">// of threads id r2.</span>
<span class="n">r3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">my_sub_group_shuffle</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span><span class="w"> </span><span class="n">r2</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">r0</span><span class="p">)</span><span class="w"> </span><span class="n">r3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">computeB</span><span class="p">();</span>
</pre></div>
</div>
</div></blockquote>
<p>with non-SPMD semantics this is optimized to the following equivalent code:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">r1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">r0</span><span class="p">)</span>
<span class="w">  </span><span class="c1">// Incorrect functionality! The data in r1</span>
<span class="w">  </span><span class="c1">// have not been computed by all threads yet.</span>
<span class="w">  </span><span class="n">r3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">my_sub_group_shuffle</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span><span class="w"> </span><span class="n">r2</span><span class="p">);</span>
<span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">r1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">computeA</span><span class="p">();</span>
<span class="w">  </span><span class="n">r3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">my_sub_group_shuffle</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span><span class="w"> </span><span class="n">r2</span><span class="p">);</span>
<span class="w">  </span><span class="n">r3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">computeB</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Declaring the function <code class="docutils literal notranslate"><span class="pre">my_sub_group_shuffle</span></code> with the convergent attribute
would prevent this:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">my_sub_group_shuffle</span><span class="p">()</span><span class="w"> </span><span class="n">__attribute__</span><span class="p">((</span><span class="n">convergent</span><span class="p">));</span>
</pre></div>
</div>
</div></blockquote>
<p>Using <code class="docutils literal notranslate"><span class="pre">convergent</span></code> guarantees correct execution by keeping CFG equivalence
wrt operations marked as <code class="docutils literal notranslate"><span class="pre">convergent</span></code>. CFG <code class="docutils literal notranslate"><span class="pre">G´</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">G</span></code> wrt
node <code class="docutils literal notranslate"><span class="pre">Ni</span></code> : <code class="docutils literal notranslate"><span class="pre">iff</span> <span class="pre">∀</span> <span class="pre">Nj</span> <span class="pre">(i≠j)</span></code> domination and post-domination relations with
respect to <code class="docutils literal notranslate"><span class="pre">Ni</span></code> remain the same in both <code class="docutils literal notranslate"><span class="pre">G</span></code> and <code class="docutils literal notranslate"><span class="pre">G´</span></code>.</p>
</section>
<section id="noduplicate">
<h4><a class="toc-backref" href="#id77" role="doc-backlink">noduplicate</a><a class="headerlink" href="#noduplicate" title="Link to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">noduplicate</span></code> is more restrictive with respect to optimizations than
<code class="docutils literal notranslate"><span class="pre">convergent</span></code> because a convergent function only preserves CFG equivalence.
This allows some optimizations to happen as long as the control flow remains
unmodified.</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">  </span><span class="n">my_sub_group_shuffle</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p>can be modified to:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">my_sub_group_shuffle</span><span class="p">();</span>
<span class="n">my_sub_group_shuffle</span><span class="p">();</span>
<span class="n">my_sub_group_shuffle</span><span class="p">();</span>
<span class="n">my_sub_group_shuffle</span><span class="p">();</span>
</pre></div>
</div>
</div></blockquote>
<p>while using <code class="docutils literal notranslate"><span class="pre">noduplicate</span></code> would disallow this. Also <code class="docutils literal notranslate"><span class="pre">noduplicate</span></code> doesn’t
have the same safe semantics of CFG as <code class="docutils literal notranslate"><span class="pre">convergent</span></code> and can cause changes in
CFG that modify semantics of the original program.</p>
<p><code class="docutils literal notranslate"><span class="pre">noduplicate</span></code> is kept for backwards compatibility only and it considered to be
deprecated for future uses.</p>
</section>
<section id="address-space">
<span id="opencl-addrsp"></span><h4><a class="toc-backref" href="#id78" role="doc-backlink">address_space</a><a class="headerlink" href="#address-space" title="Link to this heading">¶</a></h4>
<p>Clang has arbitrary address space support using the <code class="docutils literal notranslate"><span class="pre">address_space(N)</span></code>
attribute, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is an integer number in the range <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">16777215</span></code>
(<code class="docutils literal notranslate"><span class="pre">0xffffffu</span></code>).</p>
<p>An OpenCL implementation provides a list of standard address spaces using
keywords: <code class="docutils literal notranslate"><span class="pre">private</span></code>, <code class="docutils literal notranslate"><span class="pre">local</span></code>, <code class="docutils literal notranslate"><span class="pre">global</span></code>, and <code class="docutils literal notranslate"><span class="pre">generic</span></code>. In the AST and
in the IR local, global, or generic will be represented by the address space
attribute with the corresponding unique number. Note that private does not have
any corresponding attribute added and, therefore, is represented by the absence
of an address space number. The specific IDs for an address space do not have to
match between the AST and the IR. Typically in the AST address space numbers
represent logical segments while in the IR they represent physical segments.
Therefore, machines with flat memory segments can map all AST address space
numbers to the same physical segment ID or skip address space attribute
completely while generating the IR. However, if the address space information
is needed by the IR passes e.g. to improve alias analysis, it is recommended
to keep it and only lower to reflect physical memory segments in the late
machine passes.</p>
</section>
</section>
<section id="opencl-builtins">
<h3><a class="toc-backref" href="#id79" role="doc-backlink">OpenCL builtins</a><a class="headerlink" href="#opencl-builtins" title="Link to this heading">¶</a></h3>
<p>There are some standard OpenCL functions that are implemented as Clang builtins:</p>
<ul class="simple">
<li><p>All pipe functions from <a class="reference external" href="https://www.khronos.org/registry/cl/specs/opencl-2.0-openclc.pdf#160">section 6.13.16.2/6.13.16.3</a> of
the OpenCL v2.0 kernel language specification. `</p></li>
<li><p>Address space qualifier conversion functions <code class="docutils literal notranslate"><span class="pre">to_global</span></code>/<code class="docutils literal notranslate"><span class="pre">to_local</span></code>/<code class="docutils literal notranslate"><span class="pre">to_private</span></code>
from <a class="reference external" href="https://www.khronos.org/registry/cl/specs/opencl-2.0-openclc.pdf#101">section 6.13.9</a>.</p></li>
<li><p>All the <code class="docutils literal notranslate"><span class="pre">enqueue_kernel</span></code> functions from <a class="reference external" href="https://www.khronos.org/registry/cl/specs/opencl-2.0-openclc.pdf#164">section 6.13.17.1</a> and
enqueue query functions from <a class="reference external" href="https://www.khronos.org/registry/cl/specs/opencl-2.0-openclc.pdf#171">section 6.13.17.5</a>.</p></li>
</ul>
</section>
<section id="c-for-opencl">
<span id="opencl-cpp"></span><h3><a class="toc-backref" href="#id80" role="doc-backlink">C++ for OpenCL</a><a class="headerlink" href="#c-for-opencl" title="Link to this heading">¶</a></h3>
<p>Starting from clang 9 kernel code can contain C++17 features: classes, templates,
function overloading, type deduction, etc. Please note that this is not an
implementation of <a class="reference external" href="https://www.khronos.org/registry/OpenCL/specs/2.2/pdf/OpenCL_Cxx.pdf">OpenCL C++</a> and
there is no plan to support it in clang in any new releases in the near future.</p>
<p>For detailed information about restrictions to allowed C++ features please
refer to <a class="reference internal" href="LanguageExtensions.html"><span class="doc">Clang Language Extensions</span></a>.</p>
<p>Since C++ features are to be used on top of OpenCL C functionality, all existing
restrictions from OpenCL C v2.0 will inherently apply. All OpenCL C builtin types
and function libraries are supported and can be used in this mode.</p>
<p>To enable the C++ for OpenCL mode, pass one of following command line options when
compiling <code class="docutils literal notranslate"><span class="pre">.cl</span></code> file <code class="docutils literal notranslate"><span class="pre">-cl-std=clc++</span></code>, <code class="docutils literal notranslate"><span class="pre">-cl-std=CLC++</span></code>, <code class="docutils literal notranslate"><span class="pre">-std=clc++</span></code> or
<code class="docutils literal notranslate"><span class="pre">-std=CLC++</span></code>.</p>
<blockquote>
<div><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">add</span><span class="p">(</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">__kernel</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">test</span><span class="p">(</span><span class="w"> </span><span class="n">__global</span><span class="w"> </span><span class="kt">float</span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">__global</span><span class="w"> </span><span class="kt">float</span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_global_id</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="n">a</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">add</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">index</span><span class="p">],</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">clang -cl-std=clc++ test.cl</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
<section id="target-specific-features-and-limitations">
<span id="target-features"></span><h2><a class="toc-backref" href="#id81" role="doc-backlink">Target-Specific Features and Limitations</a><a class="headerlink" href="#target-specific-features-and-limitations" title="Link to this heading">¶</a></h2>
<section id="cpu-architectures-features-and-limitations">
<h3><a class="toc-backref" href="#id82" role="doc-backlink">CPU Architectures Features and Limitations</a><a class="headerlink" href="#cpu-architectures-features-and-limitations" title="Link to this heading">¶</a></h3>
<section id="x86">
<h4><a class="toc-backref" href="#id83" role="doc-backlink">X86</a><a class="headerlink" href="#x86" title="Link to this heading">¶</a></h4>
<p>The support for X86 (both 32-bit and 64-bit) is considered stable on
Darwin (macOS), Linux, FreeBSD, and Dragonfly BSD: it has been tested
to correctly compile many large C, C++, Objective-C, and Objective-C++
codebases.</p>
<p>On <code class="docutils literal notranslate"><span class="pre">x86_64-mingw32</span></code>, passing i128(by value) is incompatible with the
Microsoft x64 calling convention. You might need to tweak
<code class="docutils literal notranslate"><span class="pre">WinX86_64ABIInfo::classify()</span></code> in lib/CodeGen/TargetInfo.cpp.</p>
<p>For the X86 target, clang supports the <cite>-m16</cite> command line
argument which enables 16-bit code output. This is broadly similar to
using <code class="docutils literal notranslate"><span class="pre">asm(&quot;.code16gcc&quot;)</span></code> with the GNU toolchain. The generated code
and the ABI remains 32-bit but the assembler emits instructions
appropriate for a CPU running in 16-bit mode, with address-size and
operand-size prefixes to enable 32-bit addressing and operations.</p>
</section>
<section id="arm">
<h4><a class="toc-backref" href="#id84" role="doc-backlink">ARM</a><a class="headerlink" href="#arm" title="Link to this heading">¶</a></h4>
<p>The support for ARM (specifically ARMv6 and ARMv7) is considered stable
on Darwin (iOS): it has been tested to correctly compile many large C,
C++, Objective-C, and Objective-C++ codebases. Clang only supports a
limited number of ARM architectures. It does not yet fully support
ARMv5, for example.</p>
</section>
<section id="powerpc">
<h4><a class="toc-backref" href="#id85" role="doc-backlink">PowerPC</a><a class="headerlink" href="#powerpc" title="Link to this heading">¶</a></h4>
<p>The support for PowerPC (especially PowerPC64) is considered stable
on Linux and FreeBSD: it has been tested to correctly compile many
large C and C++ codebases. PowerPC (32bit) is still missing certain
features (e.g. PIC code on ELF platforms).</p>
</section>
<section id="other-platforms">
<h4><a class="toc-backref" href="#id86" role="doc-backlink">Other platforms</a><a class="headerlink" href="#other-platforms" title="Link to this heading">¶</a></h4>
<p>clang currently contains some support for other architectures (e.g. Sparc);
however, significant pieces of code generation are still missing, and they
haven’t undergone significant testing.</p>
<p>clang contains limited support for the MSP430 embedded processor, but
both the clang support and the LLVM backend support are highly
experimental.</p>
<p>Other platforms are completely unsupported at the moment. Adding the
minimal support needed for parsing and semantic analysis on a new
platform is quite easy; see <code class="docutils literal notranslate"><span class="pre">lib/Basic/Targets.cpp</span></code> in the clang source
tree. This level of support is also sufficient for conversion to LLVM IR
for simple programs. Proper support for conversion to LLVM IR requires
adding code to <code class="docutils literal notranslate"><span class="pre">lib/CodeGen/CGCall.cpp</span></code> at the moment; this is likely to
change soon, though. Generating assembly requires a suitable LLVM
backend.</p>
</section>
</section>
<section id="operating-system-features-and-limitations">
<h3><a class="toc-backref" href="#id87" role="doc-backlink">Operating System Features and Limitations</a><a class="headerlink" href="#operating-system-features-and-limitations" title="Link to this heading">¶</a></h3>
<section id="darwin-macos">
<h4><a class="toc-backref" href="#id88" role="doc-backlink">Darwin (macOS)</a><a class="headerlink" href="#darwin-macos" title="Link to this heading">¶</a></h4>
<p>Thread Sanitizer is not supported.</p>
</section>
<section id="windows">
<h4><a class="toc-backref" href="#id89" role="doc-backlink">Windows</a><a class="headerlink" href="#windows" title="Link to this heading">¶</a></h4>
<p>Clang has experimental support for targeting “Cygming” (Cygwin / MinGW)
platforms.</p>
<p>See also <a class="reference internal" href="#c-ms"><span class="std std-ref">Microsoft Extensions</span></a>.</p>
<section id="cygwin">
<h5><a class="toc-backref" href="#id90" role="doc-backlink">Cygwin</a><a class="headerlink" href="#cygwin" title="Link to this heading">¶</a></h5>
<p>Clang works on Cygwin-1.7.</p>
</section>
<section id="mingw32">
<h5><a class="toc-backref" href="#id91" role="doc-backlink">MinGW32</a><a class="headerlink" href="#mingw32" title="Link to this heading">¶</a></h5>
<p>Clang works on some mingw32 distributions. Clang assumes directories as
below;</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">C:/mingw/include</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">C:/mingw/lib</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">C:/mingw/lib/gcc/mingw32/4.[3-5].0/include/c++</span></code></p></li>
</ul>
<p>On MSYS, a few tests might fail.</p>
</section>
<section id="mingw-w64">
<h5><a class="toc-backref" href="#id92" role="doc-backlink">MinGW-w64</a><a class="headerlink" href="#mingw-w64" title="Link to this heading">¶</a></h5>
<p>For 32-bit (i686-w64-mingw32), and 64-bit (x86_64-w64-mingw32), Clang
assumes as below;</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GCC</span> <span class="pre">versions</span> <span class="pre">4.5.0</span> <span class="pre">to</span> <span class="pre">4.5.3,</span> <span class="pre">4.6.0</span> <span class="pre">to</span> <span class="pre">4.6.2,</span> <span class="pre">or</span> <span class="pre">4.7.0</span> <span class="pre">(for</span> <span class="pre">the</span> <span class="pre">C++</span> <span class="pre">header</span> <span class="pre">search</span> <span class="pre">path)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">some_directory/bin/gcc.exe</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">some_directory/bin/clang.exe</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">some_directory/bin/clang++.exe</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">some_directory/bin/../include/c++/GCC_version</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">some_directory/bin/../include/c++/GCC_version/x86_64-w64-mingw32</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">some_directory/bin/../include/c++/GCC_version/i686-w64-mingw32</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">some_directory/bin/../include/c++/GCC_version/backward</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">some_directory/bin/../x86_64-w64-mingw32/include</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">some_directory/bin/../i686-w64-mingw32/include</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">some_directory/bin/../include</span></code></p></li>
</ul>
<p>This directory layout is standard for any toolchain you will find on the
official <a class="reference external" href="http://mingw-w64.sourceforge.net">MinGW-w64 website</a>.</p>
<p>Clang expects the GCC executable “gcc.exe” compiled for
<code class="docutils literal notranslate"><span class="pre">i686-w64-mingw32</span></code> (or <code class="docutils literal notranslate"><span class="pre">x86_64-w64-mingw32</span></code>) to be present on PATH.</p>
<p><a class="reference external" href="https://bugs.llvm.org/show_bug.cgi?id=9072">Some tests might fail</a> on
<code class="docutils literal notranslate"><span class="pre">x86_64-w64-mingw32</span></code>.</p>
</section>
</section>
</section>
</section>
<section id="clang-cl">
<span id="id8"></span><h2><a class="toc-backref" href="#id93" role="doc-backlink">clang-cl</a><a class="headerlink" href="#clang-cl" title="Link to this heading">¶</a></h2>
<p>clang-cl is an alternative command-line interface to Clang, designed for
compatibility with the Visual C++ compiler, cl.exe.</p>
<p>To enable clang-cl to find system headers, libraries, and the linker when run
from the command-line, it should be executed inside a Visual Studio Native Tools
Command Prompt or a regular Command Prompt where the environment has been set
up using e.g. <a class="reference external" href="https://msdn.microsoft.com/en-us/library/f2ccy3wt.aspx">vcvarsall.bat</a>.</p>
<p>clang-cl can also be used from inside Visual Studio by selecting the LLVM
Platform Toolset. The toolset is not part of the installer, but may be installed
separately from the
<a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=LLVMExtensions.llvm-toolchain">Visual Studio Marketplace</a>.
To use the toolset, select a project in Solution Explorer, open its Property
Page (Alt+F7), and in the “General” section of “Configuration Properties”
change “Platform Toolset” to LLVM.  Doing so enables an additional Property
Page for selecting the clang-cl executable to use for builds.</p>
<p>To use the toolset with MSBuild directly, invoke it with e.g.
<code class="docutils literal notranslate"><span class="pre">/p:PlatformToolset=LLVM</span></code>. This allows trying out the clang-cl toolchain
without modifying your project files.</p>
<p>It’s also possible to point MSBuild at clang-cl without changing toolset by
passing <code class="docutils literal notranslate"><span class="pre">/p:CLToolPath=c:\llvm\bin</span> <span class="pre">/p:CLToolExe=clang-cl.exe</span></code>.</p>
<p>When using CMake and the Visual Studio generators, the toolset can be set with the <code class="docutils literal notranslate"><span class="pre">-T</span></code> flag:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span> <span class="o">-</span><span class="n">G</span><span class="s2">&quot;Visual Studio 15 2017&quot;</span> <span class="o">-</span><span class="n">T</span> <span class="n">LLVM</span> <span class="o">..</span>
</pre></div>
</div>
</div></blockquote>
<p>When using CMake with the Ninja generator, set the <code class="docutils literal notranslate"><span class="pre">CMAKE_C_COMPILER</span></code> and
<code class="docutils literal notranslate"><span class="pre">CMAKE_CXX_COMPILER</span></code> variables to clang-cl:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span> <span class="o">-</span><span class="n">GNinja</span> <span class="o">-</span><span class="n">DCMAKE_C_COMPILER</span><span class="o">=</span><span class="s2">&quot;c:/Program Files (x86)/LLVM/bin/clang-cl.exe&quot;</span>
    <span class="o">-</span><span class="n">DCMAKE_CXX_COMPILER</span><span class="o">=</span><span class="s2">&quot;c:/Program Files (x86)/LLVM/bin/clang-cl.exe&quot;</span> <span class="o">..</span>
</pre></div>
</div>
</div></blockquote>
<section id="id9">
<h3><a class="toc-backref" href="#id94" role="doc-backlink">Command-Line Options</a><a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<p>To be compatible with cl.exe, clang-cl supports most of the same command-line
options. Those options can start with either <code class="docutils literal notranslate"><span class="pre">/</span></code> or <code class="docutils literal notranslate"><span class="pre">-</span></code>. It also supports
some of Clang’s core options, such as the <code class="docutils literal notranslate"><span class="pre">-W</span></code> options.</p>
<p>Options that are known to clang-cl, but not currently supported, are ignored
with a warning. For example:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clang</span><span class="o">-</span><span class="n">cl</span><span class="o">.</span><span class="n">exe</span><span class="p">:</span> <span class="n">warning</span><span class="p">:</span> <span class="n">argument</span> <span class="n">unused</span> <span class="n">during</span> <span class="n">compilation</span><span class="p">:</span> <span class="s1">&#39;/AI&#39;</span>
</pre></div>
</div>
</div></blockquote>
<p>To suppress warnings about unused arguments, use the <code class="docutils literal notranslate"><span class="pre">-Qunused-arguments</span></code> option.</p>
<p>Options that are not known to clang-cl will be ignored by default. Use the
<code class="docutils literal notranslate"><span class="pre">-Werror=unknown-argument</span></code> option in order to treat them as errors. If these
options are spelled with a leading <code class="docutils literal notranslate"><span class="pre">/</span></code>, they will be mistaken for a filename:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clang</span><span class="o">-</span><span class="n">cl</span><span class="o">.</span><span class="n">exe</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">no</span> <span class="n">such</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">directory</span><span class="p">:</span> <span class="s1">&#39;/foobar&#39;</span>
</pre></div>
</div>
</div></blockquote>
<p>Please <a class="reference external" href="https://bugs.llvm.org/enter_bug.cgi?product=clang&amp;component=Driver">file a bug</a>
for any valid cl.exe flags that clang-cl does not understand.</p>
<p>Execute <code class="docutils literal notranslate"><span class="pre">clang-cl</span> <span class="pre">/?</span></code> to see a list of supported options:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>CL.EXE COMPATIBILITY OPTIONS:
  /?                      Display available options
  /arch:&lt;value&gt;           Set architecture for code generation
  /Brepro-                Write current time into COFF output (default)
  /Brepro                 Do not write current time into COFF output (breaks link.exe /incremental)
  /clang:&lt;arg&gt;            Pass &lt;arg&gt; to the clang driver
  /C                      Do not discard comments when preprocessing
  /c                      Compile only
  /d1PP                   Retain macro definitions in /E mode
  /d1reportAllClassLayout Dump record layout information
  /diagnostics:caret      Enable caret and column diagnostics (default)
  /diagnostics:classic    Disable column and caret diagnostics
  /diagnostics:column     Disable caret diagnostics but keep column info
  /D &lt;macro[=value]&gt;      Define macro
  /EH&lt;value&gt;              Set exception handling model
  /EP                     Disable linemarker output and preprocess to stdout
  /execution-charset:&lt;value&gt;
                          Set runtime encoding, supports only UTF-8
  /E                      Preprocess to stdout
  /fallback               Fall back to cl.exe if clang-cl fails to compile
  /FA                     Output assembly code file during compilation
  /Fa&lt;file or dir/&gt;       Set assembly output file name (with /FA)
  /Fe&lt;file or dir/&gt;       Set output executable file name
  /FI &lt;value&gt;             Include file before parsing
  /Fi&lt;file&gt;               Set preprocess output file name (with /P)
  /Fo&lt;file or dir/&gt;       Set output object file (with /c)
  /fp:except-
  /fp:except
  /fp:fast
  /fp:precise
  /fp:strict
  /Fp&lt;file&gt;               Set pch file name (with /Yc and /Yu)
  /GA                     Assume thread-local variables are defined in the executable
  /Gd                     Set __cdecl as a default calling convention
  /GF-                    Disable string pooling
  /GF                     Enable string pooling (default)
  /GR-                    Do not emit RTTI data
  /Gregcall               Set __regcall as a default calling convention
  /GR                     Emit RTTI data (default)
  /Gr                     Set __fastcall as a default calling convention
  /GS-                    Disable buffer security check
  /GS                     Enable buffer security check (default)
  /Gs                     Use stack probes (default)
  /Gs&lt;value&gt;              Set stack probe size (default 4096)
  /guard:&lt;value&gt;          Enable Control Flow Guard with /guard:cf,
                          or only the table with /guard:cf,nochecks
  /Gv                     Set __vectorcall as a default calling convention
  /Gw-                    Do not put each data item in its own section (default)
  /Gw                     Put each data item in its own section
  /GX-                    Deprecated (like not passing /EH)
  /GX                     Deprecated; use /EHsc
  /Gy-                    Do not put each function in its own section (default)
  /Gy                     Put each function in its own section
  /Gz                     Set __stdcall as a default calling convention
  /help                   Display available options
  /imsvc &lt;dir&gt;            Add &lt;dir&gt; to system include search path, as if in %INCLUDE%
  /I &lt;dir&gt;                Add directory to include search path
  /J                      Make char type unsigned
  /LDd                    Create debug DLL
  /LD                     Create DLL
  /link &lt;options&gt;         Forward options to the linker
  /MDd                    Use DLL debug run-time
  /MD                     Use DLL run-time
  /MTd                    Use static debug run-time
  /MT                     Use static run-time
  /O1                     Optimize for size  (like /Og     /Os /Oy /Ob2 /GF /Gy)
  /O2                     Optimize for speed (like /Og /Oi /Ot /Oy /Ob2 /GF /Gy)
  /Ob0                    Disable function inlining
  /Ob1                    Only inline functions explicitly or implicitly marked inline
  /Ob2                    Inline functions as deemed beneficial by the compiler
  /Od                     Disable optimization
  /Og                     No effect
  /Oi-                    Disable use of builtin functions
  /Oi                     Enable use of builtin functions
  /Os                     Optimize for size
  /Ot                     Optimize for speed
  /Ox                     Deprecated (like /Og /Oi /Ot /Oy /Ob2); use /O2
  /Oy-                    Disable frame pointer omission (x86 only, default)
  /Oy                     Enable frame pointer omission (x86 only)
  /O&lt;flags&gt;               Set multiple /O flags at once; e.g. &#39;/O2y-&#39; for &#39;/O2 /Oy-&#39;
  /o &lt;file or dir/&gt;       Deprecated (set output file name); use /Fe or /Fe
  /P                      Preprocess to file
  /Qvec-                  Disable the loop vectorization passes
  /Qvec                   Enable the loop vectorization passes
  /showFilenames-         Do not print the name of each compiled file (default)
  /showFilenames          Print the name of each compiled file
  /showIncludes           Print info about included files to stderr
  /source-charset:&lt;value&gt; Set source encoding, supports only UTF-8
  /std:&lt;value&gt;            Set C++ version (c++14,c++17,c++latest)
  /TC                     Treat all source files as C
  /Tc &lt;file&gt;              Treat &lt;file&gt; as C source file
  /TP                     Treat all source files as C++
  /Tp &lt;file&gt;              Treat &lt;file&gt; as C++ source file
  /utf-8                  Set source and runtime encoding to UTF-8 (default)
  /U &lt;macro&gt;              Undefine macro
  /vd&lt;value&gt;              Control vtordisp placement
  /vmb                    Use a best-case representation method for member pointers
  /vmg                    Use a most-general representation for member pointers
  /vmm                    Set the default most-general representation to multiple inheritance
  /vms                    Set the default most-general representation to single inheritance
  /vmv                    Set the default most-general representation to virtual inheritance
  /volatile:iso           Volatile loads and stores have standard semantics
  /volatile:ms            Volatile loads and stores have acquire and release semantics
  /W0                     Disable all warnings
  /W1                     Enable -Wall
  /W2                     Enable -Wall
  /W3                     Enable -Wall
  /W4                     Enable -Wall and -Wextra
  /Wall                   Enable -Weverything
  /WX-                    Do not treat warnings as errors (default)
  /WX                     Treat warnings as errors
  /w                      Disable all warnings
  /X                      Do not add %INCLUDE% to include search path
  /Y-                     Disable precompiled headers, overrides /Yc and /Yu
  /Yc&lt;filename&gt;           Generate a pch file for all code up to and including &lt;filename&gt;
  /Yu&lt;filename&gt;           Load a pch file and use it instead of all code up to and including &lt;filename&gt;
  /Z7                     Enable CodeView debug information in object files
  /Zc:alignedNew-         Disable C++17 aligned allocation functions
  /Zc:alignedNew          Enable C++17 aligned allocation functions
  /Zc:char8_t-            Disable char8_t from c++2a
  /Zc:char8_t             Enable char8_t from C++2a
  /Zc:dllexportInlines-   Do not dllexport/dllimport inline member functions of dllexport/import classes
  /Zc:dllexportInlines    dllexport/dllimport inline member functions of dllexport/import classes (default)
  /Zc:sizedDealloc-       Disable C++14 sized global deallocation functions
  /Zc:sizedDealloc        Enable C++14 sized global deallocation functions
  /Zc:strictStrings       Treat string literals as const
  /Zc:threadSafeInit-     Disable thread-safe initialization of static variables
  /Zc:threadSafeInit      Enable thread-safe initialization of static variables
  /Zc:trigraphs-          Disable trigraphs (default)
  /Zc:trigraphs           Enable trigraphs
  /Zc:twoPhase-           Disable two-phase name lookup in templates (default)
  /Zc:twoPhase            Enable two-phase name lookup in templates
  /Zd                     Emit debug line number tables only
  /Zi                     Like /Z7
  /Zl                     Do not let object file auto-link default libraries
  /Zp                     Set default maximum struct packing alignment to 1
  /Zp&lt;value&gt;              Set default maximum struct packing alignment
  /Zs                     Syntax-check only

OPTIONS:
  -###                    Print (but do not run) the commands to run for this compilation
  --analyze               Run the static analyzer
  -faddrsig               Emit an address-significance table
  -fansi-escape-codes     Use ANSI escape codes for diagnostics
  -fblocks                Enable the &#39;blocks&#39; language feature
  -fcf-protection=&lt;value&gt; Instrument control-flow architecture protection. Options: return, branch, full, none.
  -fcf-protection         Enable cf-protection in &#39;full&#39; mode
  -fcolor-diagnostics     Use colors in diagnostics
  -fcomplete-member-pointers
                          Require member pointer base types to be complete if they would be significant under the Microsoft ABI
  -fcoverage-mapping      Generate coverage mapping to enable code coverage analysis
  -fcs-profile-generate=&lt;directory&gt;
                          Generate instrumented code to collect context sensitive
                          execution counts into &lt;directory&gt;/default.profraw
                          (overridden by LLVM_PROFILE_FILE env var)
  -fcs-profile-generate   Generate instrumented code to collect context sensitive
                          execution counts into default.profraw
                          (overridden by LLVM_PROFILE_FILE env var)
  -fdebug-compilation-dir &lt;value&gt;
                          The compilation directory to embed in the debug info.
  -fdebug-macro           Emit macro debug information
  -fdelayed-template-parsing
                          Parse templated function definitions at the end of the translation unit
  -fdiagnostics-absolute-paths
                          Print absolute paths in diagnostics
  -fdiagnostics-parseable-fixits
                          Print fix-its in machine parseable form
  -flto=&lt;value&gt;           Set LTO mode to either &#39;full&#39; or &#39;thin&#39;
  -flto                   Enable LTO in &#39;full&#39; mode
  -fmerge-all-constants   Allow merging of constants
  -fms-compatibility-version=&lt;value&gt;
                          Dot-separated value representing the Microsoft compiler version
                          number to report in _MSC_VER (0 = don&#39;t define it (default))
  -fms-compatibility      Enable full Microsoft Visual C++ compatibility
  -fms-extensions         Accept some non-standard constructs supported by the Microsoft compiler
  -fmsc-version=&lt;value&gt;   Microsoft compiler version number to report in _MSC_VER
                          (0 = don&#39;t define it (default))
  -fno-addrsig            Don&#39;t emit an address-significance table
  -fno-builtin-&lt;value&gt;    Disable implicit builtin knowledge of a specific function
  -fno-builtin            Disable implicit builtin knowledge of functions
  -fno-complete-member-pointers
                          Do not require member pointer base types to be complete if they would be significant under the Microsoft ABI
  -fno-coverage-mapping   Disable code coverage analysis
  -fno-crash-diagnostics  Disable auto-generation of preprocessed source files and a script for reproduction during a clang crash
  -fno-debug-macro        Do not emit macro debug information
  -fno-delayed-template-parsing
                          Disable delayed template parsing
  -fno-profile-generate   Disable generation of profile instrumentation.
  -fno-profile-instr-generate
                          Disable generation of profile instrumentation.
  -fno-profile-instr-use  Disable using instrumentation data for profile-guided optimization
  -fno-sanitize-address-poison-custom-array-cookie
                          Disable poisoning array cookies when using custom operator new[] in AddressSanitizer
  -fno-sanitize-address-use-after-scope
                          Disable use-after-scope detection in AddressSanitizer
  -fno-sanitize-address-use-odr-indicator
                          Disable ODR indicator globals
  -fno-sanitize-blacklist Don&#39;t use blacklist file for sanitizers
  -fno-sanitize-cfi-cross-dso
                          Disable control flow integrity (CFI) checks for cross-DSO calls.
  -fno-sanitize-coverage=&lt;value&gt;
                          Disable specified features of coverage instrumentation for Sanitizers
  -fno-sanitize-memory-track-origins
                          Disable origins tracking in MemorySanitizer
  -fno-sanitize-memory-use-after-dtor
                          Disable use-after-destroy detection in MemorySanitizer
  -fno-sanitize-recover=&lt;value&gt;
                          Disable recovery for specified sanitizers
  -fno-sanitize-stats     Disable sanitizer statistics gathering.
  -fno-sanitize-thread-atomics
                          Disable atomic operations instrumentation in ThreadSanitizer
  -fno-sanitize-thread-func-entry-exit
                          Disable function entry/exit instrumentation in ThreadSanitizer
  -fno-sanitize-thread-memory-access
                          Disable memory access instrumentation in ThreadSanitizer
  -fno-sanitize-trap=&lt;value&gt;
                          Disable trapping for specified sanitizers
  -fno-standalone-debug   Limit debug information produced to reduce size of debug binary
  -fobjc-runtime=&lt;value&gt;  Specify the target Objective-C runtime kind and version
  -forder-file-instrumentation
                          Generate instrumented code to collect order file into default.profraw
                          file (overridden by &#39;=&#39; form of option or LLVM_PROFILE_FILE env var)
  -fprofile-exclude-files=&lt;value&gt;
                          Instrument only functions from files where names don&#39;t match all the regexes separated by a semi-colon
  -fprofile-filter-files=&lt;value&gt;
                          Instrument only functions from files where names match any regex separated by a semi-colon
  -fprofile-generate=&lt;directory&gt;
                          Generate instrumented code to collect execution counts into
                          &lt;directory&gt;/default.profraw (overridden by LLVM_PROFILE_FILE env var)
  -fprofile-generate      Generate instrumented code to collect execution counts into
                          default.profraw (overridden by LLVM_PROFILE_FILE env var)
  -fprofile-instr-generate=&lt;file&gt;
                          Generate instrumented code to collect execution counts into &lt;file&gt;
                          (overridden by LLVM_PROFILE_FILE env var)
  -fprofile-instr-generate
                          Generate instrumented code to collect execution counts into default.profraw file
                          (overridden by &#39;=&#39; form of option or LLVM_PROFILE_FILE env var)
  -fprofile-instr-use=&lt;value&gt;
                          Use instrumentation data for profile-guided optimization
  -fprofile-remapping-file=&lt;file&gt;
                          Use the remappings described in &lt;file&gt; to match the profile data against names in the program
  -fsanitize-address-field-padding=&lt;value&gt;
                          Level of field padding for AddressSanitizer
  -fsanitize-address-globals-dead-stripping
                          Enable linker dead stripping of globals in AddressSanitizer
  -fsanitize-address-poison-custom-array-cookie
                          Enable poisoning array cookies when using custom operator new[] in AddressSanitizer
  -fsanitize-address-use-after-scope
                          Enable use-after-scope detection in AddressSanitizer
  -fsanitize-address-use-odr-indicator
                          Enable ODR indicator globals to avoid false ODR violation reports in partially sanitized programs at the cost of an increase in binary size
  -fsanitize-blacklist=&lt;value&gt;
                          Path to blacklist file for sanitizers
  -fsanitize-cfi-cross-dso
                          Enable control flow integrity (CFI) checks for cross-DSO calls.
  -fsanitize-cfi-icall-generalize-pointers
                          Generalize pointers in CFI indirect call type signature checks
  -fsanitize-coverage=&lt;value&gt;
                          Specify the type of coverage instrumentation for Sanitizers
  -fsanitize-hwaddress-abi=&lt;value&gt;
                          Select the HWAddressSanitizer ABI to target (interceptor or platform, default interceptor)
  -fsanitize-memory-track-origins=&lt;value&gt;
                          Enable origins tracking in MemorySanitizer
  -fsanitize-memory-track-origins
                          Enable origins tracking in MemorySanitizer
  -fsanitize-memory-use-after-dtor
                          Enable use-after-destroy detection in MemorySanitizer
  -fsanitize-recover=&lt;value&gt;
                          Enable recovery for specified sanitizers
  -fsanitize-stats        Enable sanitizer statistics gathering.
  -fsanitize-thread-atomics
                          Enable atomic operations instrumentation in ThreadSanitizer (default)
  -fsanitize-thread-func-entry-exit
                          Enable function entry/exit instrumentation in ThreadSanitizer (default)
  -fsanitize-thread-memory-access
                          Enable memory access instrumentation in ThreadSanitizer (default)
  -fsanitize-trap=&lt;value&gt; Enable trapping for specified sanitizers
  -fsanitize-undefined-strip-path-components=&lt;number&gt;
                          Strip (or keep only, if negative) a given number of path components when emitting check metadata.
  -fsanitize=&lt;check&gt;      Turn on runtime checks for various forms of undefined or suspicious behavior. See user manual for available checks
  -fsplit-lto-unit        Enables splitting of the LTO unit.
  -fstandalone-debug      Emit full debug info for all types used by the program
  -fthinlto-index=&lt;value&gt; Perform ThinLTO importing using provided function summary index
  -fwhole-program-vtables Enables whole-program vtable optimization. Requires -flto
  -gcodeview-ghash        Emit type record hashes in a .debug$H section
  -gcodeview              Generate CodeView debug information
  -gline-directives-only  Emit debug line info directives only
  -gline-tables-only      Emit debug line number tables only
  -miamcu                 Use Intel MCU ABI
  -mllvm &lt;value&gt;          Additional arguments to forward to LLVM&#39;s option processing
  -nobuiltininc           Disable builtin #include directories
  -print-supported-cpus   Print supported cpu models for the given target (if target is not specified, it will print the supported cpus for the default target)
  -Qunused-arguments      Don&#39;t emit warning for unused driver arguments
  -R&lt;remark&gt;              Enable the specified remark
  --target=&lt;value&gt;        Generate code for the given target
  --version               Print version information
  -v                      Show commands to run and use verbose output
  -W&lt;warning&gt;             Enable the specified warning
  -Xclang &lt;arg&gt;           Pass &lt;arg&gt; to the clang compiler
</pre></div>
</div>
</div></blockquote>
<section id="the-clang-option">
<h4><a class="toc-backref" href="#id95" role="doc-backlink">The /clang: Option</a><a class="headerlink" href="#the-clang-option" title="Link to this heading">¶</a></h4>
<p>When clang-cl is run with a set of <code class="docutils literal notranslate"><span class="pre">/clang:&lt;arg&gt;</span></code> options, it will gather all
of the <code class="docutils literal notranslate"><span class="pre">&lt;arg&gt;</span></code> arguments and process them as if they were passed to the clang
driver. This mechanism allows you to pass flags that are not exposed in the
clang-cl options or flags that have a different meaning when passed to the clang
driver. Regardless of where they appear in the command line, the <code class="docutils literal notranslate"><span class="pre">/clang:</span></code>
arguments are treated as if they were passed at the end of the clang-cl command
line.</p>
</section>
<section id="the-zc-dllexportinlines-option">
<h4><a class="toc-backref" href="#id96" role="doc-backlink">The /Zc:dllexportInlines- Option</a><a class="headerlink" href="#the-zc-dllexportinlines-option" title="Link to this heading">¶</a></h4>
<p>This causes the class-level <cite>dllexport</cite> and <cite>dllimport</cite> attributes to not apply
to inline member functions, as they otherwise would. For example, in the code
below <cite>S::foo()</cite> would normally be defined and exported by the DLL, but when
using the <code class="docutils literal notranslate"><span class="pre">/Zc:dllexportInlines-</span></code> flag it is not:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">__declspec</span><span class="p">(</span><span class="n">dllexport</span><span class="p">)</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This has the benefit that the compiler doesn’t need to emit a definition of
<cite>S::foo()</cite> in every translation unit where the declaration is included, as it
would otherwise do to ensure there’s a definition in the DLL even if it’s not
used there. If the declaration occurs in a header file that’s widely used, this
can save significant compilation time and output size. It also reduces the
number of functions exported by the DLL similarly to what
<code class="docutils literal notranslate"><span class="pre">-fvisibility-inlines-hidden</span></code> does for shared objects on ELF and Mach-O.
Since the function declaration comes with an inline definition, users of the
library can use that definition directly instead of importing it from the DLL.</p>
<p>Note that the Microsoft Visual C++ compiler does not support this option, and
if code in a DLL is compiled with <code class="docutils literal notranslate"><span class="pre">/Zc:dllexportInlines-</span></code>, the code using the
DLL must be compiled in the same way so that it doesn’t attempt to dllimport
the inline member functions. The reverse scenario should generally work though:
a DLL compiled without this flag (such as a system library compiled with Visual
C++) can be referenced from code compiled using the flag, meaning that the
referencing code will use the inline definitions instead of importing them from
the DLL.</p>
<p>Also note that like when using <code class="docutils literal notranslate"><span class="pre">-fvisibility-inlines-hidden</span></code>, the address of
<cite>S::foo()</cite> will be different inside and outside the DLL, breaking the C/C++
standard requirement that functions have a unique address.</p>
<p>The flag does not apply to explicit class template instantiation definitions or
declarations, as those are typically used to explicitly provide a single
definition in a DLL, (dllexported instantiation definition) or to signal that
the definition is available elsewhere (dllimport instantiation declaration). It
also doesn’t apply to inline members with static local variables, to ensure
that the same instance of the variable is used inside and outside the DLL.</p>
<p>Using this flag can cause problems when inline functions that would otherwise
be dllexported refer to internal symbols of a DLL. For example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">internal</span><span class="p">();</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">__declspec</span><span class="p">(</span><span class="n">dllimport</span><span class="p">)</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">internal</span><span class="p">();</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Normally, references to <cite>S::foo()</cite> would use the definition in the DLL from
which it was exported, and which presumably also has the definition of
<cite>internal()</cite>. However, when using <code class="docutils literal notranslate"><span class="pre">/Zc:dllexportInlines-</span></code>, the inline
definition of <cite>S::foo()</cite> is used directly, resulting in a link error since
<cite>internal()</cite> is not available. Even worse, if there is an inline definition of
<cite>internal()</cite> containing a static local variable, we will now refer to a
different instance of that variable than in the DLL:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kr">inline</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">internal</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="o">++</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">__declspec</span><span class="p">(</span><span class="n">dllimport</span><span class="p">)</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">internal</span><span class="p">();</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This could lead to very subtle bugs. Using <code class="docutils literal notranslate"><span class="pre">-fvisibility-inlines-hidden</span></code> can
lead to the same issue. To avoid it in this case, make <cite>S::foo()</cite> or
<cite>internal()</cite> non-inline, or mark them <cite>dllimport/dllexport</cite> explicitly.</p>
</section>
<section id="the-fallback-option">
<h4><a class="toc-backref" href="#id97" role="doc-backlink">The /fallback Option</a><a class="headerlink" href="#the-fallback-option" title="Link to this heading">¶</a></h4>
<p>When clang-cl is run with the <code class="docutils literal notranslate"><span class="pre">/fallback</span></code> option, it will first try to
compile files itself. For any file that it fails to compile, it will fall back
and try to compile the file by invoking cl.exe.</p>
<p>This option is intended to be used as a temporary means to build projects where
clang-cl cannot successfully compile all the files. clang-cl may fail to compile
a file either because it cannot generate code for some C++ feature, or because
it cannot parse some Microsoft language extension.</p>
</section>
</section>
</section>
</section>


      </div>
      <div class="bottomnav" role="navigation" aria-label="Bottom">
      
        <p>
        «&#160;&#160;<a href="ReleaseNotes.html">Clang 9.0.0 Release Notes</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="Toolchain.html">Assembling a Complete Toolchain</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2007-2025, The Clang Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>